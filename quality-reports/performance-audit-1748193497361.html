
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rapport d'Audit Performance - Mathildanesth</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
        .container { max-width: 1200px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        h1, h2, h3 { color: #333; }
        .summary { background: #e8f4fd; padding: 15px; border-radius: 5px; margin-bottom: 20px; }
        .metric { display: inline-block; margin: 10px; padding: 10px; background: #f8f9fa; border-radius: 5px; min-width: 150px; text-align: center; }
        .good { border-left: 4px solid #28a745; }
        .warning { border-left: 4px solid #ffc107; }
        .poor { border-left: 4px solid #dc3545; }
        .error { border-left: 4px solid #dc3545; background: #f8d7da; }
        table { width: 100%; border-collapse: collapse; margin: 10px 0; }
        th, td { padding: 8px; text-align: left; border-bottom: 1px solid #ddd; }
        th { background-color: #f2f2f2; }
        .recommendations { background: #fff3cd; padding: 15px; border-radius: 5px; margin: 10px 0; }
        .timestamp { color: #666; font-size: 0.9em; }
    </style>
</head>
<body>
    <div class="container">
        <h1>🚀 Rapport d'Audit Performance</h1>
        <p class="timestamp">Généré le : 25/05/2025 19:17:28</p>
        
        <div class="summary">
            <h2>📊 Résumé</h2>
            <div class="metric">
                <strong>Taille Bundle</strong><br>
                3.75 GB
            </div>
            <div class="metric">
                <strong>Gros Fichiers</strong><br>
                9
            </div>
            <div class="metric">
                <strong>Problèmes Perf</strong><br>
                3
            </div>
        </div>

        <h2>📦 Analyse des Bundles</h2>
        
            <p><strong>Taille totale :</strong> 3.75 GB</p>
            
                <h3>Fichiers volumineux :</h3>
                <table>
                    <tr><th>Fichier</th><th>Taille</th></tr>
                    
                        <tr><td>static/chunks/common-4ebc264d0fabf809.js</td><td>3.45 MB</td></tr>
                    
                        <tr><td>static/chunks/vendors-81b845e8ed625280.js</td><td>7.26 MB</td></tr>
                    
                        <tr><td>server/chunks/1600.js</td><td>1.52 MB</td></tr>
                    
                        <tr><td>server/chunks/9328.js</td><td>825.62 KB</td></tr>
                    
                        <tr><td>server/app/leaves/quotas/page.js</td><td>591.94 KB</td></tr>
                    
                        <tr><td>server/app/api/simulations/run/route.js</td><td>535.05 KB</td></tr>
                    
                        <tr><td>server/app/api/leaves/quotas/transfers/export/route.js</td><td>1.32 MB</td></tr>
                    
                        <tr><td>server/app/api/calendar/export/route.js</td><td>737.75 KB</td></tr>
                    
                        <tr><td>server/app/admin/simulations/[scenarioId]/results/[resultId]/page.js</td><td>764.67 KB</td></tr>
                    
                </table>
            
        

        <h2>⚡ Tests de Performance</h2>
        
            <div class="metric error">
                <strong>Build Time</strong><br>
                28.25s<br>
                <small>error</small>
                <br><small style="color: red;">Command failed: npm run build
 ⚠ Invalid next.config.js options detected: 
 ⚠     Unrecognized key(s) in object: 'serverComponentsExternalPackages' at "experimental"
 ⚠ See more info here: https://nextjs.org/docs/messages/invalid-next-config
 ⚠ `experimental.serverComponentsExternalPackages` has been moved to `serverExternalPackages`. Please update your next.config.js file accordingly.
 ⚠ Compiled with warnings in 18.0s

./node_modules/@mapbox/node-pre-gyp/lib/util/compile.js
Module not found: Can't resolve 'node-gyp' in '/Users/vincentperreard/Mathildanesth/node_modules/@mapbox/node-pre-gyp/lib/util'

Import trace for requested module:
./node_modules/@mapbox/node-pre-gyp/lib/util/compile.js
./node_modules/@mapbox/node-pre-gyp/lib/ sync ^\.\/.*$
./node_modules/@mapbox/node-pre-gyp/lib/node-pre-gyp.js
./node_modules/bcrypt/bcrypt.js
./src/lib/auth.ts
./src/lib/middleware/withAuth.ts

./node_modules/@mapbox/node-pre-gyp/lib/util/compile.js
Module not found: Can't resolve 'npm' in '/Users/vincentperreard/Mathildanesth/node_modules/@mapbox/node-pre-gyp/lib/util'

Import trace for requested module:
./node_modules/@mapbox/node-pre-gyp/lib/util/compile.js
./node_modules/@mapbox/node-pre-gyp/lib/ sync ^\.\/.*$
./node_modules/@mapbox/node-pre-gyp/lib/node-pre-gyp.js
./node_modules/bcrypt/bcrypt.js
./src/lib/auth.ts
./src/lib/middleware/withAuth.ts

./node_modules/bcrypt/bcrypt.js
Critical dependency: the request of a dependency is an expression

Import trace for requested module:
./node_modules/bcrypt/bcrypt.js
./src/lib/auth.ts
./src/lib/middleware/withAuth.ts

./src/app/admin/bloc-operatoire/components/ReglesSupervisionAdmin.tsx
Attempted import error: 'TableCaption' is not exported from '@/components/ui/table' (imported as 'TableCaption').

Import trace for requested module:
./src/app/admin/bloc-operatoire/components/ReglesSupervisionAdmin.tsx
./src/app/bloc-operatoire/regles-supervision/page.tsx

./src/app/admin/bloc-operatoire/components/ReglesSupervisionAdmin.tsx
Attempted import error: 'Input' is not exported from '@/components/ui/input' (imported as 'Input').

Import trace for requested module:
./src/app/admin/bloc-operatoire/components/ReglesSupervisionAdmin.tsx
./src/app/bloc-operatoire/regles-supervision/page.tsx

./src/app/admin/bloc-operatoire/components/ReglesSupervisionAdmin.tsx
Attempted import error: 'Input' is not exported from '@/components/ui/input' (imported as 'Input').

Import trace for requested module:
./src/app/admin/bloc-operatoire/components/ReglesSupervisionAdmin.tsx
./src/app/bloc-operatoire/regles-supervision/page.tsx

./src/app/admin/bloc-operatoire/components/ReglesSupervisionAdmin.tsx
Attempted import error: 'Input' is not exported from '@/components/ui/input' (imported as 'Input').

Import trace for requested module:
./src/app/admin/bloc-operatoire/components/ReglesSupervisionAdmin.tsx
./src/app/bloc-operatoire/regles-supervision/page.tsx

./src/app/admin/bloc-operatoire/components/ReglesSupervisionAdmin.tsx
Attempted import error: 'Textarea' is not exported from '@/components/ui/textarea' (imported as 'Textarea').

Import trace for requested module:
./src/app/admin/bloc-operatoire/components/ReglesSupervisionAdmin.tsx
./src/app/bloc-operatoire/regles-supervision/page.tsx

./src/app/admin/bloc-operatoire/components/ReglesSupervisionAdmin.tsx
Attempted import error: 'Input' is not exported from '@/components/ui/input' (imported as 'Input').

Import trace for requested module:
./src/app/admin/bloc-operatoire/components/ReglesSupervisionAdmin.tsx
./src/app/bloc-operatoire/regles-supervision/page.tsx

./src/app/admin/bloc-operatoire/components/ReglesSupervisionAdmin.tsx
Attempted import error: 'Input' is not exported from '@/components/ui/input' (imported as 'Input').

Import trace for requested module:
./src/app/admin/bloc-operatoire/components/ReglesSupervisionAdmin.tsx
./src/app/bloc-operatoire/regles-supervision/page.tsx

./src/app/admin/bloc-operatoire/components/ReglesSupervisionAdmin.tsx
Attempted import error: 'Input' is not exported from '@/components/ui/input' (imported as 'Input').

Import trace for requested module:
./src/app/admin/bloc-operatoire/components/ReglesSupervisionAdmin.tsx
./src/app/bloc-operatoire/regles-supervision/page.tsx

./src/app/admin/holidays/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/holidays/page.tsx

./src/app/admin/holidays/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/holidays/page.tsx

./src/app/admin/holidays/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/holidays/page.tsx

./src/app/admin/holidays/page.tsx
Attempted import error: 'Input' is not exported from '@/components/ui/input' (imported as 'Input').

Import trace for requested module:
./src/app/admin/holidays/page.tsx

./src/app/admin/holidays/page.tsx
Attempted import error: 'Input' is not exported from '@/components/ui/input' (imported as 'Input').

Import trace for requested module:
./src/app/admin/holidays/page.tsx

./src/app/admin/holidays/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/holidays/page.tsx

./src/app/admin/holidays/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/holidays/page.tsx

./src/app/admin/holidays/page.tsx
Attempted import error: 'DatePicker' is not exported from '@/components/ui/date-picker' (imported as 'DatePicker').

Import trace for requested module:
./src/app/admin/holidays/page.tsx

./src/app/admin/holidays/page.tsx
Attempted import error: 'Input' is not exported from '@/components/ui/input' (imported as 'Input').

Import trace for requested module:
./src/app/admin/holidays/page.tsx

./src/app/admin/holidays/page.tsx
Attempted import error: 'Input' is not exported from '@/components/ui/input' (imported as 'Input').

Import trace for requested module:
./src/app/admin/holidays/page.tsx

./src/app/admin/holidays/page.tsx
Attempted import error: 'Input' is not exported from '@/components/ui/input' (imported as 'Input').

Import trace for requested module:
./src/app/admin/holidays/page.tsx

./src/app/admin/holidays/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/holidays/page.tsx

./src/app/admin/holidays/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/holidays/page.tsx

./src/app/admin/schedule-rules/edit/[id]/page.tsx
Attempted import error: 'RuleForm' is not exported from '@/modules/dynamicRules/components/RuleForm' (imported as 'RuleForm').

Import trace for requested module:
./src/app/admin/schedule-rules/edit/[id]/page.tsx

./src/app/admin/schedule-rules/new/page.tsx
Attempted import error: 'RuleForm' is not exported from '@/modules/dynamicRules/components/RuleForm' (imported as 'RuleForm').

Import trace for requested module:
./src/app/admin/schedule-rules/new/page.tsx

./src/app/admin/schedule-rules/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/schedule-rules/page.tsx

./src/app/admin/schedule-rules/page.tsx
Attempted import error: 'RulesList' is not exported from '@/modules/dynamicRules/components/RulesList' (imported as 'RulesList').

Import trace for requested module:
./src/app/admin/schedule-rules/page.tsx

./src/app/admin/schedule-rules/page.tsx
Attempted import error: 'RulesList' is not exported from '@/modules/dynamicRules/components/RulesList' (imported as 'RulesList').

Import trace for requested module:
./src/app/admin/schedule-rules/page.tsx

./src/app/admin/schedule-rules/page.tsx
Attempted import error: 'RulesList' is not exported from '@/modules/dynamicRules/components/RulesList' (imported as 'RulesList').

Import trace for requested module:
./src/app/admin/schedule-rules/page.tsx

./src/app/admin/simulations/[scenarioId]/filters/AdvancedFilters.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/[scenarioId]/filters/AdvancedFilters.tsx
./src/app/admin/simulations/[scenarioId]/page.tsx

./src/app/admin/simulations/[scenarioId]/filters/AdvancedFilters.tsx
Attempted import error: 'Input' is not exported from '@/components/ui/input' (imported as 'Input').

Import trace for requested module:
./src/app/admin/simulations/[scenarioId]/filters/AdvancedFilters.tsx
./src/app/admin/simulations/[scenarioId]/page.tsx

./src/app/admin/simulations/[scenarioId]/filters/AdvancedFilters.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/[scenarioId]/filters/AdvancedFilters.tsx
./src/app/admin/simulations/[scenarioId]/page.tsx

./src/app/admin/simulations/[scenarioId]/filters/AdvancedFilters.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/[scenarioId]/filters/AdvancedFilters.tsx
./src/app/admin/simulations/[scenarioId]/page.tsx

./src/app/admin/simulations/[scenarioId]/filters/AdvancedFilters.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/[scenarioId]/filters/AdvancedFilters.tsx
./src/app/admin/simulations/[scenarioId]/page.tsx

./src/app/admin/simulations/[scenarioId]/filters/AdvancedFilters.tsx
Attempted import error: 'Input' is not exported from '@/components/ui/input' (imported as 'Input').

Import trace for requested module:
./src/app/admin/simulations/[scenarioId]/filters/AdvancedFilters.tsx
./src/app/admin/simulations/[scenarioId]/page.tsx

./src/app/admin/simulations/[scenarioId]/filters/AdvancedFilters.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/[scenarioId]/filters/AdvancedFilters.tsx
./src/app/admin/simulations/[scenarioId]/page.tsx

./src/app/admin/simulations/[scenarioId]/filters/AdvancedFilters.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/[scenarioId]/filters/AdvancedFilters.tsx
./src/app/admin/simulations/[scenarioId]/page.tsx

./src/app/admin/simulations/[scenarioId]/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/[scenarioId]/page.tsx

./src/app/admin/simulations/[scenarioId]/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/[scenarioId]/page.tsx

./src/app/admin/simulations/[scenarioId]/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/[scenarioId]/page.tsx

./src/app/admin/simulations/[scenarioId]/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/[scenarioId]/page.tsx

./src/app/admin/simulations/[scenarioId]/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/[scenarioId]/page.tsx

./src/app/admin/simulations/[scenarioId]/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/[scenarioId]/page.tsx

./src/app/admin/simulations/[scenarioId]/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/[scenarioId]/page.tsx

./src/app/admin/simulations/[scenarioId]/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/[scenarioId]/page.tsx

./src/app/admin/simulations/[scenarioId]/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/[scenarioId]/page.tsx

./src/app/admin/simulations/[scenarioId]/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/[scenarioId]/page.tsx

./src/app/admin/simulations/[scenarioId]/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/[scenarioId]/page.tsx

./src/app/admin/simulations/new/page.tsx
Attempted import error: 'Input' is not exported from '@/components/ui/input' (imported as 'Input').

Import trace for requested module:
./src/app/admin/simulations/new/page.tsx

./src/app/admin/simulations/new/page.tsx
Attempted import error: 'Textarea' is not exported from '@/components/ui/textarea' (imported as 'Textarea').

Import trace for requested module:
./src/app/admin/simulations/new/page.tsx

./src/app/admin/simulations/new/page.tsx
Attempted import error: 'DatePicker' is not exported from '@/components/ui/date-picker' (imported as 'DatePicker').

Import trace for requested module:
./src/app/admin/simulations/new/page.tsx

./src/app/admin/simulations/new/page.tsx
Attempted import error: 'DatePicker' is not exported from '@/components/ui/date-picker' (imported as 'DatePicker').

Import trace for requested module:
./src/app/admin/simulations/new/page.tsx

./src/app/admin/simulations/new/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/new/page.tsx

./src/app/admin/simulations/new/page.tsx
Attempted import error: 'Input' is not exported from '@/components/ui/input' (imported as 'Input').

Import trace for requested module:
./src/app/admin/simulations/new/page.tsx

./src/app/admin/simulations/new/page.tsx
Attempted import error: 'Input' is not exported from '@/components/ui/input' (imported as 'Input').

Import trace for requested module:
./src/app/admin/simulations/new/page.tsx

./src/app/admin/simulations/new/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/new/page.tsx

./src/app/admin/simulations/new/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/new/page.tsx

./src/app/admin/simulations/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/page.tsx

./src/app/admin/simulations/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/page.tsx

./src/app/admin/simulations/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/page.tsx

./src/app/admin/simulations/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/page.tsx

./src/app/admin/simulations/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/page.tsx

./src/app/admin/simulations/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/page.tsx

./src/app/admin/simulations/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/page.tsx

./src/app/admin/simulations/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/page.tsx

./src/app/admin/simulations/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/page.tsx

./src/app/admin/simulations/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/page.tsx

./src/app/admin/simulations/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/page.tsx

./src/app/admin/simulations/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/page.tsx

./src/app/admin/simulations/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/page.tsx

./src/app/admin/simulations/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/page.tsx

./src/app/admin/simulations/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/page.tsx

./src/app/admin/simulations/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/page.tsx

./src/app/admin/simulations/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/page.tsx

./src/app/admin/simulations/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/page.tsx

./src/app/admin/simulations/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/page.tsx

./src/app/admin/simulations/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/page.tsx

./src/app/admin/simulations/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/page.tsx

./src/app/admin/simulations/page.tsx
Attempted import error: 'Input' is not exported from '@/components/ui/input' (imported as 'Input').

Import trace for requested module:
./src/app/admin/simulations/page.tsx

./src/app/admin/simulations/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/page.tsx

./src/app/admin/simulations/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/page.tsx

./src/app/admin/simulations/performance-demo.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/performance-demo.tsx

./src/app/admin/simulations/performance-demo.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/performance-demo.tsx

./src/app/admin/simulations/performance-demo.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/performance-demo.tsx

./src/app/admin/simulations/visualizations/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/visualizations/page.tsx

./src/app/admin/skills/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/skills/page.tsx

./src/app/admin/skills/page.tsx
Attempted import error: 'Input' is not exported from '@/components/ui/input' (imported as 'Input').

Import trace for requested module:
./src/app/admin/skills/page.tsx

./src/app/admin/skills/page.tsx
Attempted import error: 'Textarea' is not exported from '@/components/ui/textarea' (imported as 'Textarea').

Import trace for requested module:
./src/app/admin/skills/page.tsx

./src/app/admin/skills/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/skills/page.tsx

./src/app/admin/skills/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/skills/page.tsx

./src/app/admin/skills/page.tsx
Attempted import error: 'Input' is not exported from '@/components/ui/input' (imported as 'Input').

Import trace for requested module:
./src/app/admin/skills/page.tsx

./src/app/admin/skills/page.tsx
Attempted import error: 'Textarea' is not exported from '@/components/ui/textarea' (imported as 'Textarea').

Import trace for requested module:
./src/app/admin/skills/page.tsx

./src/app/admin/skills/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/skills/page.tsx

./src/app/admin/skills/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/skills/page.tsx

./src/app/admin/skills/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/skills/page.tsx

./src/app/admin/skills/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/skills/page.tsx

./src/app/admin/skills/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/skills/page.tsx

./src/app/admin/skills/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/skills/page.tsx

./src/app/admin/team-configurations/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/team-configurations/page.tsx

./src/app/bloc-operatoire/components/BlocPlanning.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/bloc-operatoire/components/BlocPlanning.tsx
./src/app/bloc-operatoire/page.tsx

./src/app/bloc-operatoire/components/BlocPlanning.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/bloc-operatoire/components/BlocPlanning.tsx
./src/app/bloc-operatoire/page.tsx

./src/app/bloc-operatoire/components/BlocPlanning.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/bloc-operatoire/components/BlocPlanning.tsx
./src/app/bloc-operatoire/page.tsx

./src/app/bloc-operatoire/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/bloc-operatoire/page.tsx

./src/app/bloc-operatoire/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/bloc-operatoire/page.tsx

./src/app/bloc-operatoire/planning/page.tsx
Attempted import error: 'DatePicker' is not exported from '@/components/ui/date-picker' (imported as 'DatePicker').

Import trace for requested module:
./src/app/bloc-operatoire/planning/page.tsx

./src/app/leaves/quotas/advanced/page.tsx
Attempted import error: 'QuotaAdvancedManagement' is not exported from '@/modules/leaves/components/QuotaAdvancedManagement' (imported as 'QuotaAdvancedManagement').

Import trace for requested module:
./src/app/leaves/quotas/advanced/page.tsx

./src/app/parametres/chirurgiens/page.tsx
Attempted import error: 'Role' is not exported from '@/types/user' (imported as 'Role').

Import trace for requested module:
./src/app/parametres/chirurgiens/page.tsx

./src/app/parametres/chirurgiens/page.tsx
Attempted import error: 'Role' is not exported from '@/types/user' (imported as 'Role').

Import trace for requested module:
./src/app/parametres/chirurgiens/page.tsx

./src/app/parametres/hopitaux/page.tsx
Attempted import error: '@/components/ui/switch' does not contain a default export (imported as 'Switch').

Import trace for requested module:
./src/app/parametres/hopitaux/page.tsx

./src/components/dashboard/widgets/PredictiveInsightsWidget.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/components/dashboard/widgets/PredictiveInsightsWidget.tsx
./src/app/statistiques/previsions/page.tsx

./src/components/simulations/ApplySimulationModal.tsx
Attempted import error: 'Textarea' is not exported from '@/components/ui/textarea' (imported as 'Textarea').

Import trace for requested module:
./src/components/simulations/ApplySimulationModal.tsx
./src/app/admin/simulations/[scenarioId]/results/[resultId]/page.tsx

./src/components/simulations/ApplySimulationModal.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/components/simulations/ApplySimulationModal.tsx
./src/app/admin/simulations/[scenarioId]/results/[resultId]/page.tsx

./src/components/simulations/ApplySimulationModal.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/components/simulations/ApplySimulationModal.tsx
./src/app/admin/simulations/[scenarioId]/results/[resultId]/page.tsx

./src/components/ui/data-table.tsx
Attempted import error: 'Input' is not exported from '@/components/ui/input' (imported as 'Input').

Import trace for requested module:
./src/components/ui/data-table.tsx
./src/app/admin/holidays/page.tsx

./src/components/ui/data-table.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/components/ui/data-table.tsx
./src/app/admin/holidays/page.tsx

./src/components/ui/data-table.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/components/ui/data-table.tsx
./src/app/admin/holidays/page.tsx

./src/modules/dynamicRules/components/RulesList.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/modules/dynamicRules/components/RulesList.tsx
./src/app/admin/schedule-rules/page.tsx

./src/modules/dynamicRules/components/RulesList.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/modules/dynamicRules/components/RulesList.tsx
./src/app/admin/schedule-rules/page.tsx

./src/modules/dynamicRules/components/RulesList.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/modules/dynamicRules/components/RulesList.tsx
./src/app/admin/schedule-rules/page.tsx

./src/modules/dynamicRules/components/RulesList.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/modules/dynamicRules/components/RulesList.tsx
./src/app/admin/schedule-rules/page.tsx

./src/modules/leaves/components/reports/QuotaTransferReportPanel.tsx
Attempted import error: 'TableCaption' is not exported from '@/components/ui/table' (imported as 'TableCaption').

Import trace for requested module:
./src/modules/leaves/components/reports/QuotaTransferReportPanel.tsx
./src/modules/leaves/components/QuotaAdvancedManagement.tsx
./src/app/leaves/quotas/advanced/page.tsx

./src/modules/planning/bloc-operatoire/components/AddRoomModal.tsx
Attempted import error: '@/components/ui/switch' does not contain a default export (imported as 'Switch').

Import trace for requested module:
./src/modules/planning/bloc-operatoire/components/AddRoomModal.tsx
./src/modules/planning/bloc-operatoire/components/RoomsList.tsx

./src/modules/planning/bloc-operatoire/components/OperatingRoomList.tsx
Attempted import error: '@/components/ui/switch' does not contain a default export (imported as 'Switch').

Import trace for requested module:
./src/modules/planning/bloc-operatoire/components/OperatingRoomList.tsx
./src/app/admin/bloc-operatoire/salles/page.tsx

./src/modules/planning/bloc-operatoire/components/OperatingSectorList.tsx
Attempted import error: '@/components/ui/switch' does not contain a default export (imported as 'Switch').

Import trace for requested module:
./src/modules/planning/bloc-operatoire/components/OperatingSectorList.tsx
./src/app/admin/bloc-operatoire/secteurs/page.tsx

./src/modules/planning/bloc-operatoire/components/SupervisionRulesList.tsx
Attempted import error: '@/components/ui/switch' does not contain a default export (imported as 'Switch').

Import trace for requested module:
./src/modules/planning/bloc-operatoire/components/SupervisionRulesList.tsx

./src/modules/planning/bloc-operatoire/components/SupervisionRulesList.tsx
Attempted import error: '@/components/ui/switch' does not contain a default export (imported as 'Switch').

Import trace for requested module:
./src/modules/planning/bloc-operatoire/components/SupervisionRulesList.tsx

./src/modules/planning/bloc-operatoire/components/SupervisionRulesList.tsx
Attempted import error: '@/components/ui/switch' does not contain a default export (imported as 'Switch').

Import trace for requested module:
./src/modules/planning/bloc-operatoire/components/SupervisionRulesList.tsx

./src/modules/planning/bloc-operatoire/hooks/useOperatingResourceQueries.ts
Attempted import error: 'operatingSectorService' is not exported from '../services/OperatingSectorService' (imported as 'operatingSectorService').

Import trace for requested module:
./src/modules/planning/bloc-operatoire/hooks/useOperatingResourceQueries.ts
./src/modules/planning/bloc-operatoire/components/SupervisionRulesList.tsx

./src/modules/planning/bloc-operatoire/hooks/useOperatingResourceQueries.ts
Attempted import error: 'operatingSectorService' is not exported from '../services/OperatingSectorService' (imported as 'operatingSectorService').

Import trace for requested module:
./src/modules/planning/bloc-operatoire/hooks/useOperatingResourceQueries.ts
./src/modules/planning/bloc-operatoire/components/SupervisionRulesList.tsx

./src/modules/planning/bloc-operatoire/hooks/useOperatingResourceQueries.ts
Attempted import error: 'operatingSectorService' is not exported from '../services/OperatingSectorService' (imported as 'operatingSectorService').

Import trace for requested module:
./src/modules/planning/bloc-operatoire/hooks/useOperatingResourceQueries.ts
./src/modules/planning/bloc-operatoire/components/SupervisionRulesList.tsx

./src/modules/planning/bloc-operatoire/hooks/useOperatingResourceQueries.ts
Attempted import error: 'operatingSectorService' is not exported from '../services/OperatingSectorService' (imported as 'operatingSectorService').

Import trace for requested module:
./src/modules/planning/bloc-operatoire/hooks/useOperatingResourceQueries.ts
./src/modules/planning/bloc-operatoire/components/SupervisionRulesList.tsx

./src/modules/planning/bloc-operatoire/hooks/useOperatingResourceQueries.ts
Attempted import error: 'operatingRoomService' is not exported from '../services/OperatingRoomService' (imported as 'operatingRoomService').

Import trace for requested module:
./src/modules/planning/bloc-operatoire/hooks/useOperatingResourceQueries.ts
./src/modules/planning/bloc-operatoire/components/SupervisionRulesList.tsx

./src/modules/planning/bloc-operatoire/hooks/useOperatingResourceQueries.ts
Attempted import error: 'operatingRoomService' is not exported from '../services/OperatingRoomService' (imported as 'operatingRoomService').

Import trace for requested module:
./src/modules/planning/bloc-operatoire/hooks/useOperatingResourceQueries.ts
./src/modules/planning/bloc-operatoire/components/SupervisionRulesList.tsx

./src/modules/planning/bloc-operatoire/hooks/useOperatingResourceQueries.ts
Attempted import error: 'operatingRoomService' is not exported from '../services/OperatingRoomService' (imported as 'operatingRoomService').

Import trace for requested module:
./src/modules/planning/bloc-operatoire/hooks/useOperatingResourceQueries.ts
./src/modules/planning/bloc-operatoire/components/SupervisionRulesList.tsx

./src/modules/planning/bloc-operatoire/hooks/useOperatingResourceQueries.ts
Attempted import error: 'operatingRoomService' is not exported from '../services/OperatingRoomService' (imported as 'operatingRoomService').

Import trace for requested module:
./src/modules/planning/bloc-operatoire/hooks/useOperatingResourceQueries.ts
./src/modules/planning/bloc-operatoire/components/SupervisionRulesList.tsx

./src/modules/planning/bloc-operatoire/services/SupervisionRulesService.ts
Attempted import error: 'operatingRoomService' is not exported from './OperatingRoomService' (imported as 'operatingRoomService').

Import trace for requested module:
./src/modules/planning/bloc-operatoire/services/SupervisionRulesService.ts
./src/modules/planning/bloc-operatoire/hooks/useOperatingResourceQueries.ts
./src/modules/planning/bloc-operatoire/components/SupervisionRulesList.tsx

./src/modules/planning/bloc-operatoire/services/SupervisionRulesService.ts
Attempted import error: 'operatingRoomService' is not exported from './OperatingRoomService' (imported as 'operatingRoomService').

Import trace for requested module:
./src/modules/planning/bloc-operatoire/services/SupervisionRulesService.ts
./src/modules/planning/bloc-operatoire/hooks/useOperatingResourceQueries.ts
./src/modules/planning/bloc-operatoire/components/SupervisionRulesList.tsx

./src/modules/planning/bloc-operatoire/services/SupervisionRulesService.ts
Attempted import error: 'operatingRoomService' is not exported from './OperatingRoomService' (imported as 'operatingRoomService').

Import trace for requested module:
./src/modules/planning/bloc-operatoire/services/SupervisionRulesService.ts
./src/modules/planning/bloc-operatoire/hooks/useOperatingResourceQueries.ts
./src/modules/planning/bloc-operatoire/components/SupervisionRulesList.tsx

./src/modules/planning/bloc-operatoire/services/SupervisionRulesService.ts
Attempted import error: 'operatingRoomService' is not exported from './OperatingRoomService' (imported as 'operatingRoomService').

Import trace for requested module:
./src/modules/planning/bloc-operatoire/services/SupervisionRulesService.ts
./src/modules/planning/bloc-operatoire/hooks/useOperatingResourceQueries.ts
./src/modules/planning/bloc-operatoire/components/SupervisionRulesList.tsx

./src/modules/planning/bloc-operatoire/services/SupervisionRulesService.ts
Attempted import error: 'operatingRoomService' is not exported from './OperatingRoomService' (imported as 'operatingRoomService').

Import trace for requested module:
./src/modules/planning/bloc-operatoire/services/SupervisionRulesService.ts
./src/modules/planning/bloc-operatoire/hooks/useOperatingResourceQueries.ts
./src/modules/planning/bloc-operatoire/components/SupervisionRulesList.tsx

./src/components/PlanningSimulator.tsx
Attempted import error: './ui/switch' does not contain a default export (imported as 'Switch').

Import trace for requested module:
./src/components/PlanningSimulator.tsx

./node_modules/sequelize/lib/dialects/abstract/connection-manager.js
Critical dependency: the request of a dependency is an expression

Import trace for requested module:
./node_modules/sequelize/lib/dialects/abstract/connection-manager.js
./node_modules/sequelize/lib/dialects/mariadb/connection-manager.js
./node_modules/sequelize/lib/dialects/mariadb/index.js
./node_modules/sequelize/lib/sequelize.js
./node_modules/sequelize/lib/index.js
./node_modules/sequelize/lib/index.mjs
./src/models/TrameAffectation.ts
./src/services/trameAffectationService.ts
./src/app/admin/trames/page.tsx

./src/app/admin/bloc-operatoire/components/ReglesSupervisionAdmin.tsx
Attempted import error: 'TableCaption' is not exported from '@/components/ui/table' (imported as 'TableCaption').

Import trace for requested module:
./src/app/admin/bloc-operatoire/components/ReglesSupervisionAdmin.tsx
./src/app/bloc-operatoire/regles-supervision/page.tsx

./src/app/admin/bloc-operatoire/components/ReglesSupervisionAdmin.tsx
Attempted import error: 'Input' is not exported from '@/components/ui/input' (imported as 'Input').

Import trace for requested module:
./src/app/admin/bloc-operatoire/components/ReglesSupervisionAdmin.tsx
./src/app/bloc-operatoire/regles-supervision/page.tsx

./src/app/admin/bloc-operatoire/components/ReglesSupervisionAdmin.tsx
Attempted import error: 'Input' is not exported from '@/components/ui/input' (imported as 'Input').

Import trace for requested module:
./src/app/admin/bloc-operatoire/components/ReglesSupervisionAdmin.tsx
./src/app/bloc-operatoire/regles-supervision/page.tsx

./src/app/admin/bloc-operatoire/components/ReglesSupervisionAdmin.tsx
Attempted import error: 'Input' is not exported from '@/components/ui/input' (imported as 'Input').

Import trace for requested module:
./src/app/admin/bloc-operatoire/components/ReglesSupervisionAdmin.tsx
./src/app/bloc-operatoire/regles-supervision/page.tsx

./src/app/admin/bloc-operatoire/components/ReglesSupervisionAdmin.tsx
Attempted import error: 'Textarea' is not exported from '@/components/ui/textarea' (imported as 'Textarea').

Import trace for requested module:
./src/app/admin/bloc-operatoire/components/ReglesSupervisionAdmin.tsx
./src/app/bloc-operatoire/regles-supervision/page.tsx

./src/app/admin/bloc-operatoire/components/ReglesSupervisionAdmin.tsx
Attempted import error: 'Input' is not exported from '@/components/ui/input' (imported as 'Input').

Import trace for requested module:
./src/app/admin/bloc-operatoire/components/ReglesSupervisionAdmin.tsx
./src/app/bloc-operatoire/regles-supervision/page.tsx

./src/app/admin/bloc-operatoire/components/ReglesSupervisionAdmin.tsx
Attempted import error: 'Input' is not exported from '@/components/ui/input' (imported as 'Input').

Import trace for requested module:
./src/app/admin/bloc-operatoire/components/ReglesSupervisionAdmin.tsx
./src/app/bloc-operatoire/regles-supervision/page.tsx

./src/app/admin/bloc-operatoire/components/ReglesSupervisionAdmin.tsx
Attempted import error: 'Input' is not exported from '@/components/ui/input' (imported as 'Input').

Import trace for requested module:
./src/app/admin/bloc-operatoire/components/ReglesSupervisionAdmin.tsx
./src/app/bloc-operatoire/regles-supervision/page.tsx

./src/app/admin/holidays/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/holidays/page.tsx

./src/app/admin/holidays/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/holidays/page.tsx

./src/app/admin/holidays/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/holidays/page.tsx

./src/app/admin/holidays/page.tsx
Attempted import error: 'Input' is not exported from '@/components/ui/input' (imported as 'Input').

Import trace for requested module:
./src/app/admin/holidays/page.tsx

./src/app/admin/holidays/page.tsx
Attempted import error: 'Input' is not exported from '@/components/ui/input' (imported as 'Input').

Import trace for requested module:
./src/app/admin/holidays/page.tsx

./src/app/admin/holidays/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/holidays/page.tsx

./src/app/admin/holidays/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/holidays/page.tsx

./src/app/admin/holidays/page.tsx
Attempted import error: 'DatePicker' is not exported from '@/components/ui/date-picker' (imported as 'DatePicker').

Import trace for requested module:
./src/app/admin/holidays/page.tsx

./src/app/admin/holidays/page.tsx
Attempted import error: 'Input' is not exported from '@/components/ui/input' (imported as 'Input').

Import trace for requested module:
./src/app/admin/holidays/page.tsx

./src/app/admin/holidays/page.tsx
Attempted import error: 'Input' is not exported from '@/components/ui/input' (imported as 'Input').

Import trace for requested module:
./src/app/admin/holidays/page.tsx

./src/app/admin/holidays/page.tsx
Attempted import error: 'Input' is not exported from '@/components/ui/input' (imported as 'Input').

Import trace for requested module:
./src/app/admin/holidays/page.tsx

./src/app/admin/holidays/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/holidays/page.tsx

./src/app/admin/holidays/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/holidays/page.tsx

./src/app/admin/schedule-rules/edit/[id]/page.tsx
Attempted import error: 'RuleForm' is not exported from '@/modules/dynamicRules/components/RuleForm' (imported as 'RuleForm').

Import trace for requested module:
./src/app/admin/schedule-rules/edit/[id]/page.tsx

./src/app/admin/schedule-rules/new/page.tsx
Attempted import error: 'RuleForm' is not exported from '@/modules/dynamicRules/components/RuleForm' (imported as 'RuleForm').

Import trace for requested module:
./src/app/admin/schedule-rules/new/page.tsx

./src/app/admin/schedule-rules/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/schedule-rules/page.tsx

./src/app/admin/schedule-rules/page.tsx
Attempted import error: 'RulesList' is not exported from '@/modules/dynamicRules/components/RulesList' (imported as 'RulesList').

Import trace for requested module:
./src/app/admin/schedule-rules/page.tsx

./src/app/admin/schedule-rules/page.tsx
Attempted import error: 'RulesList' is not exported from '@/modules/dynamicRules/components/RulesList' (imported as 'RulesList').

Import trace for requested module:
./src/app/admin/schedule-rules/page.tsx

./src/app/admin/schedule-rules/page.tsx
Attempted import error: 'RulesList' is not exported from '@/modules/dynamicRules/components/RulesList' (imported as 'RulesList').

Import trace for requested module:
./src/app/admin/schedule-rules/page.tsx

./src/app/admin/simulations/[scenarioId]/filters/AdvancedFilters.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/[scenarioId]/filters/AdvancedFilters.tsx
./src/app/admin/simulations/[scenarioId]/page.tsx

./src/app/admin/simulations/[scenarioId]/filters/AdvancedFilters.tsx
Attempted import error: 'Input' is not exported from '@/components/ui/input' (imported as 'Input').

Import trace for requested module:
./src/app/admin/simulations/[scenarioId]/filters/AdvancedFilters.tsx
./src/app/admin/simulations/[scenarioId]/page.tsx

./src/app/admin/simulations/[scenarioId]/filters/AdvancedFilters.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/[scenarioId]/filters/AdvancedFilters.tsx
./src/app/admin/simulations/[scenarioId]/page.tsx

./src/app/admin/simulations/[scenarioId]/filters/AdvancedFilters.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/[scenarioId]/filters/AdvancedFilters.tsx
./src/app/admin/simulations/[scenarioId]/page.tsx

./src/app/admin/simulations/[scenarioId]/filters/AdvancedFilters.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/[scenarioId]/filters/AdvancedFilters.tsx
./src/app/admin/simulations/[scenarioId]/page.tsx

./src/app/admin/simulations/[scenarioId]/filters/AdvancedFilters.tsx
Attempted import error: 'Input' is not exported from '@/components/ui/input' (imported as 'Input').

Import trace for requested module:
./src/app/admin/simulations/[scenarioId]/filters/AdvancedFilters.tsx
./src/app/admin/simulations/[scenarioId]/page.tsx

./src/app/admin/simulations/[scenarioId]/filters/AdvancedFilters.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/[scenarioId]/filters/AdvancedFilters.tsx
./src/app/admin/simulations/[scenarioId]/page.tsx

./src/app/admin/simulations/[scenarioId]/filters/AdvancedFilters.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/[scenarioId]/filters/AdvancedFilters.tsx
./src/app/admin/simulations/[scenarioId]/page.tsx

./src/app/admin/simulations/[scenarioId]/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/[scenarioId]/page.tsx

./src/app/admin/simulations/[scenarioId]/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/[scenarioId]/page.tsx

./src/app/admin/simulations/[scenarioId]/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/[scenarioId]/page.tsx

./src/app/admin/simulations/[scenarioId]/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/[scenarioId]/page.tsx

./src/app/admin/simulations/[scenarioId]/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/[scenarioId]/page.tsx

./src/app/admin/simulations/[scenarioId]/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/[scenarioId]/page.tsx

./src/app/admin/simulations/[scenarioId]/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/[scenarioId]/page.tsx

./src/app/admin/simulations/[scenarioId]/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/[scenarioId]/page.tsx

./src/app/admin/simulations/[scenarioId]/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/[scenarioId]/page.tsx

./src/app/admin/simulations/[scenarioId]/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/[scenarioId]/page.tsx

./src/app/admin/simulations/[scenarioId]/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/[scenarioId]/page.tsx

./src/app/admin/simulations/new/page.tsx
Attempted import error: 'Input' is not exported from '@/components/ui/input' (imported as 'Input').

Import trace for requested module:
./src/app/admin/simulations/new/page.tsx

./src/app/admin/simulations/new/page.tsx
Attempted import error: 'Textarea' is not exported from '@/components/ui/textarea' (imported as 'Textarea').

Import trace for requested module:
./src/app/admin/simulations/new/page.tsx

./src/app/admin/simulations/new/page.tsx
Attempted import error: 'DatePicker' is not exported from '@/components/ui/date-picker' (imported as 'DatePicker').

Import trace for requested module:
./src/app/admin/simulations/new/page.tsx

./src/app/admin/simulations/new/page.tsx
Attempted import error: 'DatePicker' is not exported from '@/components/ui/date-picker' (imported as 'DatePicker').

Import trace for requested module:
./src/app/admin/simulations/new/page.tsx

./src/app/admin/simulations/new/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/new/page.tsx

./src/app/admin/simulations/new/page.tsx
Attempted import error: 'Input' is not exported from '@/components/ui/input' (imported as 'Input').

Import trace for requested module:
./src/app/admin/simulations/new/page.tsx

./src/app/admin/simulations/new/page.tsx
Attempted import error: 'Input' is not exported from '@/components/ui/input' (imported as 'Input').

Import trace for requested module:
./src/app/admin/simulations/new/page.tsx

./src/app/admin/simulations/new/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/new/page.tsx

./src/app/admin/simulations/new/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/new/page.tsx

./src/app/admin/simulations/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/page.tsx

./src/app/admin/simulations/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/page.tsx

./src/app/admin/simulations/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/page.tsx

./src/app/admin/simulations/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/page.tsx

./src/app/admin/simulations/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/page.tsx

./src/app/admin/simulations/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/page.tsx

./src/app/admin/simulations/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/page.tsx

./src/app/admin/simulations/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/page.tsx

./src/app/admin/simulations/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/page.tsx

./src/app/admin/simulations/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/page.tsx

./src/app/admin/simulations/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/page.tsx

./src/app/admin/simulations/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/page.tsx

./src/app/admin/simulations/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/page.tsx

./src/app/admin/simulations/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/page.tsx

./src/app/admin/simulations/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/page.tsx

./src/app/admin/simulations/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/page.tsx

./src/app/admin/simulations/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/page.tsx

./src/app/admin/simulations/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/page.tsx

./src/app/admin/simulations/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/page.tsx

./src/app/admin/simulations/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/page.tsx

./src/app/admin/simulations/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/page.tsx

./src/app/admin/simulations/page.tsx
Attempted import error: 'Input' is not exported from '@/components/ui/input' (imported as 'Input').

Import trace for requested module:
./src/app/admin/simulations/page.tsx

./src/app/admin/simulations/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/page.tsx

./src/app/admin/simulations/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/page.tsx

./src/app/admin/simulations/performance-demo.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/performance-demo.tsx

./src/app/admin/simulations/performance-demo.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/performance-demo.tsx

./src/app/admin/simulations/performance-demo.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/performance-demo.tsx

./src/app/admin/simulations/visualizations/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/simulations/visualizations/page.tsx

./src/app/admin/skills/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/skills/page.tsx

./src/app/admin/skills/page.tsx
Attempted import error: 'Input' is not exported from '@/components/ui/input' (imported as 'Input').

Import trace for requested module:
./src/app/admin/skills/page.tsx

./src/app/admin/skills/page.tsx
Attempted import error: 'Textarea' is not exported from '@/components/ui/textarea' (imported as 'Textarea').

Import trace for requested module:
./src/app/admin/skills/page.tsx

./src/app/admin/skills/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/skills/page.tsx

./src/app/admin/skills/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/skills/page.tsx

./src/app/admin/skills/page.tsx
Attempted import error: 'Input' is not exported from '@/components/ui/input' (imported as 'Input').

Import trace for requested module:
./src/app/admin/skills/page.tsx

./src/app/admin/skills/page.tsx
Attempted import error: 'Textarea' is not exported from '@/components/ui/textarea' (imported as 'Textarea').

Import trace for requested module:
./src/app/admin/skills/page.tsx

./src/app/admin/skills/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/skills/page.tsx

./src/app/admin/skills/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/skills/page.tsx

./src/app/admin/skills/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/skills/page.tsx

./src/app/admin/skills/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/skills/page.tsx

./src/app/admin/skills/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/skills/page.tsx

./src/app/admin/skills/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/skills/page.tsx

./src/app/admin/team-configurations/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/admin/team-configurations/page.tsx

./src/app/bloc-operatoire/components/BlocPlanning.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/bloc-operatoire/components/BlocPlanning.tsx
./src/app/bloc-operatoire/page.tsx

./src/app/bloc-operatoire/components/BlocPlanning.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/bloc-operatoire/components/BlocPlanning.tsx
./src/app/bloc-operatoire/page.tsx

./src/app/bloc-operatoire/components/BlocPlanning.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/bloc-operatoire/components/BlocPlanning.tsx
./src/app/bloc-operatoire/page.tsx

./src/app/bloc-operatoire/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/bloc-operatoire/page.tsx

./src/app/bloc-operatoire/page.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/app/bloc-operatoire/page.tsx

./src/app/bloc-operatoire/planning/page.tsx
Attempted import error: 'DatePicker' is not exported from '@/components/ui/date-picker' (imported as 'DatePicker').

Import trace for requested module:
./src/app/bloc-operatoire/planning/page.tsx

./src/app/leaves/quotas/advanced/page.tsx
Attempted import error: 'QuotaAdvancedManagement' is not exported from '@/modules/leaves/components/QuotaAdvancedManagement' (imported as 'QuotaAdvancedManagement').

Import trace for requested module:
./src/app/leaves/quotas/advanced/page.tsx

./src/app/parametres/chirurgiens/page.tsx
Attempted import error: 'Role' is not exported from '@/types/user' (imported as 'Role').

Import trace for requested module:
./src/app/parametres/chirurgiens/page.tsx

./src/app/parametres/chirurgiens/page.tsx
Attempted import error: 'Role' is not exported from '@/types/user' (imported as 'Role').

Import trace for requested module:
./src/app/parametres/chirurgiens/page.tsx

./src/app/parametres/hopitaux/page.tsx
Attempted import error: '@/components/ui/switch' does not contain a default export (imported as 'Switch').

Import trace for requested module:
./src/app/parametres/hopitaux/page.tsx

./src/components/dashboard/widgets/PredictiveInsightsWidget.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/components/dashboard/widgets/PredictiveInsightsWidget.tsx
./src/app/statistiques/previsions/page.tsx

./src/components/simulations/ApplySimulationModal.tsx
Attempted import error: 'Textarea' is not exported from '@/components/ui/textarea' (imported as 'Textarea').

Import trace for requested module:
./src/components/simulations/ApplySimulationModal.tsx
./src/app/admin/simulations/[scenarioId]/results/[resultId]/page.tsx

./src/components/simulations/ApplySimulationModal.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/components/simulations/ApplySimulationModal.tsx
./src/app/admin/simulations/[scenarioId]/results/[resultId]/page.tsx

./src/components/simulations/ApplySimulationModal.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/components/simulations/ApplySimulationModal.tsx
./src/app/admin/simulations/[scenarioId]/results/[resultId]/page.tsx

./src/components/ui/data-table.tsx
Attempted import error: 'Input' is not exported from '@/components/ui/input' (imported as 'Input').

Import trace for requested module:
./src/components/ui/data-table.tsx
./src/app/admin/holidays/page.tsx

./src/components/ui/data-table.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/components/ui/data-table.tsx
./src/app/admin/holidays/page.tsx

./src/components/ui/data-table.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/components/ui/data-table.tsx
./src/app/admin/holidays/page.tsx

./src/modules/dynamicRules/components/RulesList.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/modules/dynamicRules/components/RulesList.tsx
./src/app/admin/schedule-rules/page.tsx

./src/modules/dynamicRules/components/RulesList.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/modules/dynamicRules/components/RulesList.tsx
./src/app/admin/schedule-rules/page.tsx

./src/modules/dynamicRules/components/RulesList.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/modules/dynamicRules/components/RulesList.tsx
./src/app/admin/schedule-rules/page.tsx

./src/modules/dynamicRules/components/RulesList.tsx
Attempted import error: 'Button' is not exported from '@/components/ui/button' (imported as 'Button').

Import trace for requested module:
./src/modules/dynamicRules/components/RulesList.tsx
./src/app/admin/schedule-rules/page.tsx

./src/modules/leaves/components/reports/QuotaTransferReportPanel.tsx
Attempted import error: 'TableCaption' is not exported from '@/components/ui/table' (imported as 'TableCaption').

Import trace for requested module:
./src/modules/leaves/components/reports/QuotaTransferReportPanel.tsx
./src/modules/leaves/components/QuotaAdvancedManagement.tsx
./src/app/leaves/quotas/advanced/page.tsx

./src/modules/planning/bloc-operatoire/components/AddRoomModal.tsx
Attempted import error: '@/components/ui/switch' does not contain a default export (imported as 'Switch').

Import trace for requested module:
./src/modules/planning/bloc-operatoire/components/AddRoomModal.tsx
./src/modules/planning/bloc-operatoire/components/RoomsList.tsx

./src/modules/planning/bloc-operatoire/components/OperatingRoomList.tsx
Attempted import error: '@/components/ui/switch' does not contain a default export (imported as 'Switch').

Import trace for requested module:
./src/modules/planning/bloc-operatoire/components/OperatingRoomList.tsx
./src/app/admin/bloc-operatoire/salles/page.tsx

./src/modules/planning/bloc-operatoire/components/OperatingSectorList.tsx
Attempted import error: '@/components/ui/switch' does not contain a default export (imported as 'Switch').

Import trace for requested module:
./src/modules/planning/bloc-operatoire/components/OperatingSectorList.tsx
./src/app/admin/bloc-operatoire/secteurs/page.tsx

./src/modules/planning/bloc-operatoire/components/SupervisionRulesList.tsx
Attempted import error: '@/components/ui/switch' does not contain a default export (imported as 'Switch').

Import trace for requested module:
./src/modules/planning/bloc-operatoire/components/SupervisionRulesList.tsx
./src/app/admin/bloc-operatoire/regles-supervision/page.tsx

./src/modules/planning/bloc-operatoire/components/SupervisionRulesList.tsx
Attempted import error: '@/components/ui/switch' does not contain a default export (imported as 'Switch').

Import trace for requested module:
./src/modules/planning/bloc-operatoire/components/SupervisionRulesList.tsx
./src/app/admin/bloc-operatoire/regles-supervision/page.tsx

./src/modules/planning/bloc-operatoire/components/SupervisionRulesList.tsx
Attempted import error: '@/components/ui/switch' does not contain a default export (imported as 'Switch').

Import trace for requested module:
./src/modules/planning/bloc-operatoire/components/SupervisionRulesList.tsx
./src/app/admin/bloc-operatoire/regles-supervision/page.tsx

./src/modules/planning/bloc-operatoire/hooks/useOperatingResourceQueries.ts
Attempted import error: 'operatingSectorService' is not exported from '../services/OperatingSectorService' (imported as 'operatingSectorService').

Import trace for requested module:
./src/modules/planning/bloc-operatoire/hooks/useOperatingResourceQueries.ts
./src/modules/planning/bloc-operatoire/components/SupervisionRulesList.tsx
./src/app/admin/bloc-operatoire/regles-supervision/page.tsx

./src/modules/planning/bloc-operatoire/hooks/useOperatingResourceQueries.ts
Attempted import error: 'operatingSectorService' is not exported from '../services/OperatingSectorService' (imported as 'operatingSectorService').

Import trace for requested module:
./src/modules/planning/bloc-operatoire/hooks/useOperatingResourceQueries.ts
./src/modules/planning/bloc-operatoire/components/SupervisionRulesList.tsx
./src/app/admin/bloc-operatoire/regles-supervision/page.tsx

./src/modules/planning/bloc-operatoire/hooks/useOperatingResourceQueries.ts
Attempted import error: 'operatingSectorService' is not exported from '../services/OperatingSectorService' (imported as 'operatingSectorService').

Import trace for requested module:
./src/modules/planning/bloc-operatoire/hooks/useOperatingResourceQueries.ts
./src/modules/planning/bloc-operatoire/components/SupervisionRulesList.tsx
./src/app/admin/bloc-operatoire/regles-supervision/page.tsx

./src/modules/planning/bloc-operatoire/hooks/useOperatingResourceQueries.ts
Attempted import error: 'operatingSectorService' is not exported from '../services/OperatingSectorService' (imported as 'operatingSectorService').

Import trace for requested module:
./src/modules/planning/bloc-operatoire/hooks/useOperatingResourceQueries.ts
./src/modules/planning/bloc-operatoire/components/SupervisionRulesList.tsx
./src/app/admin/bloc-operatoire/regles-supervision/page.tsx

./src/modules/planning/bloc-operatoire/hooks/useOperatingResourceQueries.ts
Attempted import error: 'operatingRoomService' is not exported from '../services/OperatingRoomService' (imported as 'operatingRoomService').

Import trace for requested module:
./src/modules/planning/bloc-operatoire/hooks/useOperatingResourceQueries.ts
./src/modules/planning/bloc-operatoire/components/SupervisionRulesList.tsx
./src/app/admin/bloc-operatoire/regles-supervision/page.tsx

./src/modules/planning/bloc-operatoire/hooks/useOperatingResourceQueries.ts
Attempted import error: 'operatingRoomService' is not exported from '../services/OperatingRoomService' (imported as 'operatingRoomService').

Import trace for requested module:
./src/modules/planning/bloc-operatoire/hooks/useOperatingResourceQueries.ts
./src/modules/planning/bloc-operatoire/components/SupervisionRulesList.tsx
./src/app/admin/bloc-operatoire/regles-supervision/page.tsx

./src/modules/planning/bloc-operatoire/hooks/useOperatingResourceQueries.ts
Attempted import error: 'operatingRoomService' is not exported from '../services/OperatingRoomService' (imported as 'operatingRoomService').

Import trace for requested module:
./src/modules/planning/bloc-operatoire/hooks/useOperatingResourceQueries.ts
./src/modules/planning/bloc-operatoire/components/SupervisionRulesList.tsx
./src/app/admin/bloc-operatoire/regles-supervision/page.tsx

./src/modules/planning/bloc-operatoire/hooks/useOperatingResourceQueries.ts
Attempted import error: 'operatingRoomService' is not exported from '../services/OperatingRoomService' (imported as 'operatingRoomService').

Import trace for requested module:
./src/modules/planning/bloc-operatoire/hooks/useOperatingResourceQueries.ts
./src/modules/planning/bloc-operatoire/components/SupervisionRulesList.tsx
./src/app/admin/bloc-operatoire/regles-supervision/page.tsx

./src/modules/planning/bloc-operatoire/services/SupervisionRulesService.ts
Attempted import error: 'operatingRoomService' is not exported from './OperatingRoomService' (imported as 'operatingRoomService').

Import trace for requested module:
./src/modules/planning/bloc-operatoire/services/SupervisionRulesService.ts
./src/modules/planning/bloc-operatoire/hooks/useOperatingResourceQueries.ts
./src/modules/planning/bloc-operatoire/components/SupervisionRulesList.tsx
./src/app/admin/bloc-operatoire/regles-supervision/page.tsx

./src/modules/planning/bloc-operatoire/services/SupervisionRulesService.ts
Attempted import error: 'operatingRoomService' is not exported from './OperatingRoomService' (imported as 'operatingRoomService').

Import trace for requested module:
./src/modules/planning/bloc-operatoire/services/SupervisionRulesService.ts
./src/modules/planning/bloc-operatoire/hooks/useOperatingResourceQueries.ts
./src/modules/planning/bloc-operatoire/components/SupervisionRulesList.tsx
./src/app/admin/bloc-operatoire/regles-supervision/page.tsx

./src/modules/planning/bloc-operatoire/services/SupervisionRulesService.ts
Attempted import error: 'operatingRoomService' is not exported from './OperatingRoomService' (imported as 'operatingRoomService').

Import trace for requested module:
./src/modules/planning/bloc-operatoire/services/SupervisionRulesService.ts
./src/modules/planning/bloc-operatoire/hooks/useOperatingResourceQueries.ts
./src/modules/planning/bloc-operatoire/components/SupervisionRulesList.tsx
./src/app/admin/bloc-operatoire/regles-supervision/page.tsx

./src/modules/planning/bloc-operatoire/services/SupervisionRulesService.ts
Attempted import error: 'operatingRoomService' is not exported from './OperatingRoomService' (imported as 'operatingRoomService').

Import trace for requested module:
./src/modules/planning/bloc-operatoire/services/SupervisionRulesService.ts
./src/modules/planning/bloc-operatoire/hooks/useOperatingResourceQueries.ts
./src/modules/planning/bloc-operatoire/components/SupervisionRulesList.tsx
./src/app/admin/bloc-operatoire/regles-supervision/page.tsx

./src/modules/planning/bloc-operatoire/services/SupervisionRulesService.ts
Attempted import error: 'operatingRoomService' is not exported from './OperatingRoomService' (imported as 'operatingRoomService').

Import trace for requested module:
./src/modules/planning/bloc-operatoire/services/SupervisionRulesService.ts
./src/modules/planning/bloc-operatoire/hooks/useOperatingResourceQueries.ts
./src/modules/planning/bloc-operatoire/components/SupervisionRulesList.tsx
./src/app/admin/bloc-operatoire/regles-supervision/page.tsx

./src/app/admin/leaves/analytics/page.tsx
Attempted import error: 'CardBody' is not exported from '@/components/ui/Card' (imported as 'CardBody').

Import trace for requested module:
./src/app/admin/leaves/analytics/page.tsx

./src/app/admin/leaves/analytics/page.tsx
Attempted import error: 'LeaveConflictDashboard' is not exported from '@/modules/leaves/components/LeaveConflictDashboard' (imported as 'LeaveConflictDashboard').

Import trace for requested module:
./src/app/admin/leaves/analytics/page.tsx

./src/app/api/planning-rules/bloc/route.ts
Attempted import error: 'getAllSupervisorRules' is not exported from '@/modules/planning/bloc-operatoire/services/blocPlanningService' (imported as 'getAllSupervisorRules').

Import trace for requested module:
./src/app/api/planning-rules/bloc/route.ts

./src/app/api/planning-rules/bloc/route.ts
Attempted import error: 'createSupervisorRule' is not exported from '@/modules/planning/bloc-operatoire/services/blocPlanningService' (imported as 'createSupervisorRule').

Import trace for requested module:
./src/app/api/planning-rules/bloc/route.ts

./src/app/api/planning-rules/bloc/route.ts
Attempted import error: 'updateSupervisorRule' is not exported from '@/modules/planning/bloc-operatoire/services/blocPlanningService' (imported as 'updateSupervisorRule').

Import trace for requested module:
./src/app/api/planning-rules/bloc/route.ts

./src/app/api/planning-rules/bloc/route.ts
Attempted import error: 'deleteSupervisorRule' is not exported from '@/modules/planning/bloc-operatoire/services/blocPlanningService' (imported as 'deleteSupervisorRule').

Import trace for requested module:
./src/app/api/planning-rules/bloc/route.ts

./src/app/bloc-operatoire/salles/page.tsx
Attempted import error: '@/modules/planning/bloc-operatoire/components/RoomsList' does not contain a default export (imported as 'RoomsList').

Import trace for requested module:
./src/app/bloc-operatoire/salles/page.tsx

./src/components/ui/Card.tsx
There are multiple modules with names that only differ in casing.
This can lead to unexpected behavior when compiling on a filesystem with other case-semantic.
Use equal casing. Compare these module identifiers:
* javascript/auto|/Users/vincentperreard/Mathildanesth/node_modules/next/dist/build/webpack/loaders/next-flight-loader/index.js!/Users/vincentperreard/Mathildanesth/node_modules/next/dist/build/webpack/loaders/next-swc-loader.js??ruleSet[1].rules[15].oneOf[4].use[0]!/Users/vincentperreard/Mathildanesth/src/components/ui/Card.tsx|rsc
    Used by 1 module(s), i. e.
    javascript/auto|/Users/vincentperreard/Mathildanesth/node_modules/next/dist/build/webpack/loaders/next-flight-loader/index.js!/Users/vincentperreard/Mathildanesth/node_modules/next/dist/build/webpack/loaders/next-swc-loader.js??ruleSet[1].rules[15].oneOf[4].use[0]!/Users/vincentperreard/Mathildanesth/src/app/admin/leaves/analytics/page.tsx|rsc
* javascript/auto|/Users/vincentperreard/Mathildanesth/node_modules/next/dist/build/webpack/loaders/next-flight-loader/index.js!/Users/vincentperreard/Mathildanesth/node_modules/next/dist/build/webpack/loaders/next-swc-loader.js??ruleSet[1].rules[15].oneOf[4].use[0]!/Users/vincentperreard/Mathildanesth/src/components/ui/card.tsx|rsc
    Used by 3 module(s), i. e.
    javascript/auto|/Users/vincentperreard/Mathildanesth/node_modules/next/dist/build/webpack/loaders/next-flight-loader/index.js!/Users/vincentperreard/Mathildanesth/node_modules/next/dist/build/webpack/loaders/next-swc-loader.js??ruleSet[1].rules[15].oneOf[4].use[0]!/Users/vincentperreard/Mathildanesth/src/app/admin/incompatibilites/page.tsx|rsc

Import trace for requested module:
./src/components/ui/Card.tsx
./src/app/admin/leaves/analytics/page.tsx

./src/modules/dynamicRules/services/RuleConflictDetectionService.ts
Attempted import error: 'ComparisonOperator' is not exported from '../types/rule' (imported as 'ComparisonOperator').

Import trace for requested module:
./src/modules/dynamicRules/services/RuleConflictDetectionService.ts
./src/modules/rules/services/RuleBasedPlanningGeneratorService.ts
./src/app/api/simulations/[scenarioId]/run/route.ts

./src/modules/dynamicRules/services/RuleConflictDetectionService.ts
Attempted import error: 'ComparisonOperator' is not exported from '../types/rule' (imported as 'ComparisonOperator').

Import trace for requested module:
./src/modules/dynamicRules/services/RuleConflictDetectionService.ts
./src/modules/rules/services/RuleBasedPlanningGeneratorService.ts
./src/app/api/simulations/[scenarioId]/run/route.ts

./src/modules/dynamicRules/services/RuleConflictDetectionService.ts
Attempted import error: 'ComparisonOperator' is not exported from '../types/rule' (imported as 'ComparisonOperator').

Import trace for requested module:
./src/modules/dynamicRules/services/RuleConflictDetectionService.ts
./src/modules/rules/services/RuleBasedPlanningGeneratorService.ts
./src/app/api/simulations/[scenarioId]/run/route.ts

./src/modules/dynamicRules/services/RuleConflictDetectionService.ts
Attempted import error: 'ComparisonOperator' is not exported from '../types/rule' (imported as 'ComparisonOperator').

Import trace for requested module:
./src/modules/dynamicRules/services/RuleConflictDetectionService.ts
./src/modules/rules/services/RuleBasedPlanningGeneratorService.ts
./src/app/api/simulations/[scenarioId]/run/route.ts

./src/modules/dynamicRules/services/RuleConflictDetectionService.ts
Attempted import error: 'ComparisonOperator' is not exported from '../types/rule' (imported as 'ComparisonOperator').

Import trace for requested module:
./src/modules/dynamicRules/services/RuleConflictDetectionService.ts
./src/modules/rules/services/RuleBasedPlanningGeneratorService.ts
./src/app/api/simulations/[scenarioId]/run/route.ts

./src/modules/dynamicRules/services/RuleConflictDetectionService.ts
Attempted import error: 'ComparisonOperator' is not exported from '../types/rule' (imported as 'ComparisonOperator').

Import trace for requested module:
./src/modules/dynamicRules/services/RuleConflictDetectionService.ts
./src/modules/rules/services/RuleBasedPlanningGeneratorService.ts
./src/app/api/simulations/[scenarioId]/run/route.ts

./src/modules/dynamicRules/services/RuleConflictDetectionService.ts
Attempted import error: 'ComparisonOperator' is not exported from '../types/rule' (imported as 'ComparisonOperator').

Import trace for requested module:
./src/modules/dynamicRules/services/RuleConflictDetectionService.ts
./src/modules/rules/services/RuleBasedPlanningGeneratorService.ts
./src/app/api/simulations/[scenarioId]/run/route.ts

./src/modules/dynamicRules/services/RuleConflictDetectionService.ts
Attempted import error: 'ComparisonOperator' is not exported from '../types/rule' (imported as 'ComparisonOperator').

Import trace for requested module:
./src/modules/dynamicRules/services/RuleConflictDetectionService.ts
./src/modules/rules/services/RuleBasedPlanningGeneratorService.ts
./src/app/api/simulations/[scenarioId]/run/route.ts

./src/modules/dynamicRules/services/RuleConflictDetectionService.ts
Attempted import error: 'ComparisonOperator' is not exported from '../types/rule' (imported as 'ComparisonOperator').

Import trace for requested module:
./src/modules/dynamicRules/services/RuleConflictDetectionService.ts
./src/modules/rules/services/RuleBasedPlanningGeneratorService.ts
./src/app/api/simulations/[scenarioId]/run/route.ts

./src/modules/dynamicRules/services/RuleConflictDetectionService.ts
Attempted import error: 'ComparisonOperator' is not exported from '../types/rule' (imported as 'ComparisonOperator').

Import trace for requested module:
./src/modules/dynamicRules/services/RuleConflictDetectionService.ts
./src/modules/rules/services/RuleBasedPlanningGeneratorService.ts
./src/app/api/simulations/[scenarioId]/run/route.ts

./src/modules/dynamicRules/services/RuleConflictDetectionService.ts
Attempted import error: 'ComparisonOperator' is not exported from '../types/rule' (imported as 'ComparisonOperator').

Import trace for requested module:
./src/modules/dynamicRules/services/RuleConflictDetectionService.ts
./src/modules/rules/services/RuleBasedPlanningGeneratorService.ts
./src/app/api/simulations/[scenarioId]/run/route.ts

./src/modules/dynamicRules/services/RuleConflictDetectionService.ts
Attempted import error: 'ComparisonOperator' is not exported from '../types/rule' (imported as 'ComparisonOperator').

Import trace for requested module:
./src/modules/dynamicRules/services/RuleConflictDetectionService.ts
./src/modules/rules/services/RuleBasedPlanningGeneratorService.ts
./src/app/api/simulations/[scenarioId]/run/route.ts

./src/modules/dynamicRules/services/RuleConflictDetectionService.ts
Attempted import error: 'ComparisonOperator' is not exported from '../types/rule' (imported as 'ComparisonOperator').

Import trace for requested module:
./src/modules/dynamicRules/services/RuleConflictDetectionService.ts
./src/modules/rules/services/RuleBasedPlanningGeneratorService.ts
./src/app/api/simulations/[scenarioId]/run/route.ts

./src/modules/dynamicRules/services/RuleConflictDetectionService.ts
Attempted import error: 'ComparisonOperator' is not exported from '../types/rule' (imported as 'ComparisonOperator').

Import trace for requested module:
./src/modules/dynamicRules/services/RuleConflictDetectionService.ts
./src/modules/rules/services/RuleBasedPlanningGeneratorService.ts
./src/app/api/simulations/[scenarioId]/run/route.ts

./src/modules/dynamicRules/services/RuleConflictDetectionService.ts
Attempted import error: 'ComparisonOperator' is not exported from '../types/rule' (imported as 'ComparisonOperator').

Import trace for requested module:
./src/modules/dynamicRules/services/RuleConflictDetectionService.ts
./src/modules/rules/services/RuleBasedPlanningGeneratorService.ts
./src/app/api/simulations/[scenarioId]/run/route.ts

./src/modules/dynamicRules/services/RuleConflictDetectionService.ts
Attempted import error: 'ComparisonOperator' is not exported from '../types/rule' (imported as 'ComparisonOperator').

Import trace for requested module:
./src/modules/dynamicRules/services/RuleConflictDetectionService.ts
./src/modules/rules/services/RuleBasedPlanningGeneratorService.ts
./src/app/api/simulations/[scenarioId]/run/route.ts

./src/modules/dynamicRules/services/RuleConflictDetectionService.ts
Attempted import error: 'ComparisonOperator' is not exported from '../types/rule' (imported as 'ComparisonOperator').

Import trace for requested module:
./src/modules/dynamicRules/services/RuleConflictDetectionService.ts
./src/modules/rules/services/RuleBasedPlanningGeneratorService.ts
./src/app/api/simulations/[scenarioId]/run/route.ts

./src/modules/dynamicRules/services/RuleConflictDetectionService.ts
Attempted import error: 'ComparisonOperator' is not exported from '../types/rule' (imported as 'ComparisonOperator').

Import trace for requested module:
./src/modules/dynamicRules/services/RuleConflictDetectionService.ts
./src/modules/rules/services/RuleBasedPlanningGeneratorService.ts
./src/app/api/simulations/[scenarioId]/run/route.ts

./src/modules/dynamicRules/services/RuleConflictDetectionService.ts
Attempted import error: 'ComparisonOperator' is not exported from '../types/rule' (imported as 'ComparisonOperator').

Import trace for requested module:
./src/modules/dynamicRules/services/RuleConflictDetectionService.ts
./src/modules/rules/services/RuleBasedPlanningGeneratorService.ts
./src/app/api/simulations/[scenarioId]/run/route.ts

./src/modules/dynamicRules/services/RuleConflictDetectionService.ts
Attempted import error: 'ComparisonOperator' is not exported from '../types/rule' (imported as 'ComparisonOperator').

Import trace for requested module:
./src/modules/dynamicRules/services/RuleConflictDetectionService.ts
./src/modules/rules/services/RuleBasedPlanningGeneratorService.ts
./src/app/api/simulations/[scenarioId]/run/route.ts

./src/components/PlanningSimulator.tsx
Attempted import error: './ui/switch' does not contain a default export (imported as 'Switch').

Import trace for requested module:
./src/components/PlanningSimulator.tsx
./src/pages/planning/simulateur.tsx

./node_modules/sequelize/lib/dialects/abstract/connection-manager.js
Critical dependency: the request of a dependency is an expression

Import trace for requested module:
./node_modules/sequelize/lib/dialects/abstract/connection-manager.js
./node_modules/sequelize/lib/dialects/mariadb/connection-manager.js
./node_modules/sequelize/lib/dialects/mariadb/index.js
./node_modules/sequelize/lib/sequelize.js
./node_modules/sequelize/lib/index.js
./node_modules/sequelize/lib/index.mjs
./src/models/TrameAffectation.ts
./src/services/trameAffectationService.ts
./src/app/admin/trames/page.tsx

[PublicHolidayService] Impossible de récupérer les jours fériés depuis l'API pour l'année 2024. Utilisation du calcul local.
[PublicHolidayService] Impossible de récupérer les jours fériés depuis l'API pour l'année 2025. Utilisation du calcul local.
[PublicHolidayService] Impossible de récupérer les jours fériés depuis l'API pour l'année 2026. Utilisation du calcul local.
[PublicHolidayService] Impossible de récupérer les jours fériés depuis l'API pour l'année 2027. Utilisation du calcul local.
(node:80015) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.
(Use `node --trace-deprecation ...` to show where the warning was created)
Error occurred prerendering page "/bloc-operatoire". Read more: https://nextjs.org/docs/messages/prerender-error
Error: Element type is invalid: expected a string (for built-in components) or a class/function (for composite components) but got: undefined.
    at nH (/Users/vincentperreard/Mathildanesth/node_modules/next/dist/compiled/next-server/app-page.runtime.prod.js:76:64717)
    at nW (/Users/vincentperreard/Mathildanesth/node_modules/next/dist/compiled/next-server/app-page.runtime.prod.js:76:67762)
    at nz (/Users/vincentperreard/Mathildanesth/node_modules/next/dist/compiled/next-server/app-page.runtime.prod.js:76:65337)
    at nY (/Users/vincentperreard/Mathildanesth/node_modules/next/dist/compiled/next-server/app-page.runtime.prod.js:76:71193)
    at nX (/Users/vincentperreard/Mathildanesth/node_modules/next/dist/compiled/next-server/app-page.runtime.prod.js:76:69876)
    at nW (/Users/vincentperreard/Mathildanesth/node_modules/next/dist/compiled/next-server/app-page.runtime.prod.js:76:68029)
    at nz (/Users/vincentperreard/Mathildanesth/node_modules/next/dist/compiled/next-server/app-page.runtime.prod.js:76:65337)
    at nY (/Users/vincentperreard/Mathildanesth/node_modules/next/dist/compiled/next-server/app-page.runtime.prod.js:76:71193)
    at nH (/Users/vincentperreard/Mathildanesth/node_modules/next/dist/compiled/next-server/app-page.runtime.prod.js:76:60968)
    at nW (/Users/vincentperreard/Mathildanesth/node_modules/next/dist/compiled/next-server/app-page.runtime.prod.js:76:67762)
Export encountered an error on /bloc-operatoire/page: /bloc-operatoire, exiting the build.
Error occurred prerendering page "/admin/schedule-rules". Read more: https://nextjs.org/docs/messages/prerender-error
Error: Element type is invalid: expected a string (for built-in components) or a class/function (for composite components) but got: undefined.
    at nH (/Users/vincentperreard/Mathildanesth/node_modules/next/dist/compiled/next-server/app-page.runtime.prod.js:76:64717)
    at nW (/Users/vincentperreard/Mathildanesth/node_modules/next/dist/compiled/next-server/app-page.runtime.prod.js:76:67762)
    at nz (/Users/vincentperreard/Mathildanesth/node_modules/next/dist/compiled/next-server/app-page.runtime.prod.js:76:65337)
    at nY (/Users/vincentperreard/Mathildanesth/node_modules/next/dist/compiled/next-server/app-page.runtime.prod.js:76:71193)
    at nX (/Users/vincentperreard/Mathildanesth/node_modules/next/dist/compiled/next-server/app-page.runtime.prod.js:76:69876)
    at nW (/Users/vincentperreard/Mathildanesth/node_modules/next/dist/compiled/next-server/app-page.runtime.prod.js:76:68029)
    at nz (/Users/vincentperreard/Mathildanesth/node_modules/next/dist/compiled/next-server/app-page.runtime.prod.js:76:65337)
    at nY (/Users/vincentperreard/Mathildanesth/node_modules/next/dist/compiled/next-server/app-page.runtime.prod.js:76:71193)
    at nH (/Users/vincentperreard/Mathildanesth/node_modules/next/dist/compiled/next-server/app-page.runtime.prod.js:76:60968)
    at nW (/Users/vincentperreard/Mathildanesth/node_modules/next/dist/compiled/next-server/app-page.runtime.prod.js:76:67762)
Export encountered an error on /admin/schedule-rules/page: /admin/schedule-rules, exiting the build.
 ⨯ Next.js build worker exited with code: 1 and signal: null
</small>
            </div>
        
            <div class="metric error">
                <strong>TypeScript Check</strong><br>
                5.09s<br>
                <small>error</small>
                <br><small style="color: red;">Command failed: npx tsc --noEmit</small>
            </div>
        
            <div class="metric error">
                <strong>Test Suite</strong><br>
                15.45s<br>
                <small>error</small>
                <br><small style="color: red;">Command failed: npm run test:critical
(node:80198) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.
(Use `node --trace-deprecation ...` to show where the warning was created)
(node:80192) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.
(Use `node --trace-deprecation ...` to show where the warning was created)
FAIL src/modules/leaves/services/__tests__/QuotaAdvancedService.test.ts
  ● Console

    console.log
      jest.polyfills.js loaded and applied.

      at Object.<anonymous> (jest.polyfills.js:247:9)

    console.log
      jest.setup.js loaded and mocks applied.

      at Object.log (jest.setup.js:126:9)

    console.debug
      [EventBusProfiler] Initialized

      at new debug (src/modules/integration/services/EventBusProfiler.ts:77:17)

    console.error
      Erreur lors de la récupération des règles de transfert: Error: Test error
          at Object.<anonymous> (/Users/vincentperreard/Mathildanesth/src/modules/leaves/services/__tests__/QuotaAdvancedService.test.ts:245:70)
          at Promise.then.completed (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/utils.js:231:10)
          at _callCircusTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:252:3)
          at _runTestsForDescribeBlock (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:126:9)
          at _runTestsForDescribeBlock (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:121:9)
          at _runTestsForDescribeBlock (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:121:9)
          at run (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:71:3)
          at runAndTransformResultsToJestFormat (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
          at jestAdapter (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:74:19)
          at runTestInternal (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/runTest.js:367:16)
          at runTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/runTest.js:444:34)
          at Object.worker (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/testWorker.js:106:12)

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at QuotaAdvancedService.error [as getActiveTransferRules] (src/modules/leaves/services/QuotaAdvancedService.ts:74:21)
      at Object.<anonymous> (src/modules/leaves/services/__tests__/QuotaAdvancedService.test.ts:246:13)

    console.error
      Erreur lors de la récupération des règles de report: Error: Test error
          at Object.<anonymous> (/Users/vincentperreard/Mathildanesth/src/modules/leaves/services/__tests__/QuotaAdvancedService.test.ts:258:71)
          at Promise.then.completed (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/utils.js:231:10)
          at _callCircusTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:252:3)
          at _runTestsForDescribeBlock (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:126:9)
          at _runTestsForDescribeBlock (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:121:9)
          at _runTestsForDescribeBlock (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:121:9)
          at run (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:71:3)
          at runAndTransformResultsToJestFormat (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
          at jestAdapter (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:74:19)
          at runTestInternal (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/runTest.js:367:16)
          at runTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/runTest.js:444:34)
          at Object.worker (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/testWorker.js:106:12)

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at QuotaAdvancedService.error [as getActiveCarryOverRules] (src/modules/leaves/services/QuotaAdvancedService.ts:88:21)
      at Object.<anonymous> (src/modules/leaves/services/__tests__/QuotaAdvancedService.test.ts:259:13)

    console.warn
      [MSW] Warning: intercepted a request without a matching request handler:
      
        • POST /api/audit/entries
      
        • Request body: {"actionType":"QUOTA_TRANSFERRED","userId":"user-123","targetType":"quota","description":"Transfert de undefined jour(s) de RECOVERY vers ANNUAL","severity":"MEDIUM","metadata":{"sourceType":"RECOVERY","targetType":"ANNUAL","targetAmount":null,"ratio":1},"userAgent":"Mozilla/5.0 (darwin) AppleWebKit/537.36 (KHTML, like Gecko) jsdom/20.0.3"}
      
      If you still wish to intercept this unhandled request, please create a request handler for it.
      Read more: https://mswjs.io/docs/getting-started/mocks

      at Object.warn (node_modules/msw/src/core/utils/internal/devUtils.ts:18:11)
      at warn (node_modules/msw/src/core/utils/request/onUnhandledRequest.ts:50:18)
      at applyStrategy (node_modules/msw/src/core/utils/request/onUnhandledRequest.ts:79:5)
      at handleRequest (node_modules/msw/src/core/utils/handleRequest.ts:79:5)
      at _Emitter.<anonymous> (node_modules/msw/src/node/SetupServerCommonApi.ts:60:26)
      at emitAsync (node_modules/@mswjs/interceptors/src/utils/emitAsync.ts:23:5)
      at node_modules/@mswjs/interceptors/src/utils/handleRequest.ts:125:5
      at until (node_modules/@open-draft/until/src/until.ts:23:18)
      at handleRequest (node_modules/@mswjs/interceptors/src/utils/handleRequest.ts:114:18)
      at XMLHttpRequestController.xhrRequestController.onRequest (node_modules/@mswjs/interceptors/src/interceptors/XMLHttpRequest/XMLHttpRequestProxy.ts:64:34)

    console.error
      Error: AggregateError
          at Object.dispatchError (/Users/vincentperreard/Mathildanesth/node_modules/jsdom/lib/jsdom/living/xhr/xhr-utils.js:63:19)
          at Request.<anonymous> (/Users/vincentperreard/Mathildanesth/node_modules/jsdom/lib/jsdom/living/xhr/XMLHttpRequest-impl.js:655:18)
          at Request.emit (node:events:530:35)
          at ClientRequest.<anonymous> (/Users/vincentperreard/Mathildanesth/node_modules/jsdom/lib/jsdom/living/helpers/http-request.js:121:14)
          at ClientRequest.emit (node:events:518:28)
          at emitErrorEvent (node:_http_client:103:11)
          at MockHttpSocket.socketErrorListener (node:_http_client:506:5)
          at MockHttpSocket.emit (node:events:530:35)
          at MockHttpSocket.emitEvent [as emit] (/Users/vincentperreard/Mathildanesth/node_modules/@mswjs/interceptors/src/interceptors/ClientRequest/MockHttpSocket.ts:152:12)
          at Socket.emit (/Users/vincentperreard/Mathildanesth/node_modules/@mswjs/interceptors/src/interceptors/ClientRequest/MockHttpSocket.ts:271:14)
          at Socket.emit (node:events:518:28)
          at emitErrorNT (node:internal/streams/destroy:170:8)
          at emitErrorCloseNT (node:internal/streams/destroy:129:3)
          at processTicksAndRejections (node:internal/process/task_queues:90:21) {
        type: 'XMLHttpRequest'
      }

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at Object.dispatchError (node_modules/jsdom/lib/jsdom/living/xhr/xhr-utils.js:66:53)
      at Request.<anonymous> (node_modules/jsdom/lib/jsdom/living/xhr/XMLHttpRequest-impl.js:655:18)
      at ClientRequest.<anonymous> (node_modules/jsdom/lib/jsdom/living/helpers/http-request.js:121:14)
      at MockHttpSocket.emitEvent [as emit] (node_modules/@mswjs/interceptors/src/interceptors/ClientRequest/MockHttpSocket.ts:152:12)
      at Socket.emit (node_modules/@mswjs/interceptors/src/interceptors/ClientRequest/MockHttpSocket.ts:271:14)

    console.error
      [AuditService] Error creating audit entry: AxiosError {
        message: 'Network Error',
        name: 'AxiosError',
        code: 'ERR_NETWORK',
        config: {
          transitional: {
            silentJSONParsing: true,
            forcedJSONParsing: true,
            clarifyTimeoutError: false
          },
          adapter: [ 'xhr', 'http', 'fetch' ],
          transformRequest: [ [Function: transformRequest] ],
          transformResponse: [ [Function: transformResponse] ],
          timeout: 0,
          xsrfCookieName: 'XSRF-TOKEN',
          xsrfHeaderName: 'X-XSRF-TOKEN',
          maxContentLength: -1,
          maxBodyLength: -1,
          env: { FormData: [class FormData], Blob: [class Blob] },
          validateStatus: [Function: validateStatus],
          headers: Object [AxiosHeaders] {
            Accept: 'application/json, text/plain, */*',
            'Content-Type': 'application/json'
          },
          method: 'post',
          url: '/api/audit/entries',
          data: '{"actionType":"QUOTA_TRANSFERRED","userId":"user-123","targetType":"quota","description":"Transfert de undefined jour(s) de RECOVERY vers ANNUAL","severity":"MEDIUM","metadata":{"sourceType":"RECOVERY","targetType":"ANNUAL","targetAmount":null,"ratio":1},"userAgent":"Mozilla/5.0 (darwin) AppleWebKit/537.36 (KHTML, like Gecko) jsdom/20.0.3"}',
          allowAbsoluteUrls: true
        },
        request: XMLHttpRequest {
          open: [Function: open],
          setRequestHeader: [Function: setRequestHeader],
          send: [Function: send],
          abort: [Function: abort],
          getResponseHeader: [Function: getResponseHeader],
          getAllResponseHeaders: [Function: getAllResponseHeaders],
          overrideMimeType: [Function: overrideMimeType],
          onreadystatechange: [Getter/Setter],
          readyState: [Getter],
          timeout: [Getter/Setter],
          withCredentials: [Getter/Setter],
          upload: XMLHttpRequestUpload {},
          responseURL: [Getter],
          status: [Getter],
          statusText: [Getter],
          responseType: [Getter/Setter],
          response: [Getter],
          responseText: [Getter],
          responseXML: [Getter],
          UNSENT: 0,
          OPENED: 1,
          HEADERS_RECEIVED: 2,
          LOADING: 3,
          DONE: 4,
          [Symbol(SameObject caches)]: [Object: null prototype] { upload: XMLHttpRequestUpload {} }
        }
      }

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at AuditService.error [as createAuditEntry] (src/modules/leaves/services/AuditService.ts:317:21)
      at QuotaAdvancedService.executeTransfer (src/modules/leaves/services/QuotaAdvancedService.ts:199:13)
      at Object.<anonymous> (src/modules/leaves/services/__tests__/QuotaAdvancedService.test.ts:294:28)

    console.error
      Erreur lors de l'exécution du transfert: AxiosError {
        message: 'Network Error',
        name: 'AxiosError',
        code: 'ERR_NETWORK',
        config: {
          transitional: {
            silentJSONParsing: true,
            forcedJSONParsing: true,
            clarifyTimeoutError: false
          },
          adapter: [ 'xhr', 'http', 'fetch' ],
          transformRequest: [ [Function: transformRequest] ],
          transformResponse: [ [Function: transformResponse] ],
          timeout: 0,
          xsrfCookieName: 'XSRF-TOKEN',
          xsrfHeaderName: 'X-XSRF-TOKEN',
          maxContentLength: -1,
          maxBodyLength: -1,
          env: { FormData: [class FormData], Blob: [class Blob] },
          validateStatus: [Function: validateStatus],
          headers: Object [AxiosHeaders] {
            Accept: 'application/json, text/plain, */*',
            'Content-Type': 'application/json'
          },
          method: 'post',
          url: '/api/audit/entries',
          data: '{"actionType":"QUOTA_TRANSFERRED","userId":"user-123","targetType":"quota","description":"Transfert de undefined jour(s) de RECOVERY vers ANNUAL","severity":"MEDIUM","metadata":{"sourceType":"RECOVERY","targetType":"ANNUAL","targetAmount":null,"ratio":1},"userAgent":"Mozilla/5.0 (darwin) AppleWebKit/537.36 (KHTML, like Gecko) jsdom/20.0.3"}',
          allowAbsoluteUrls: true
        },
        request: XMLHttpRequest {
          open: [Function: open],
          setRequestHeader: [Function: setRequestHeader],
          send: [Function: send],
          abort: [Function: abort],
          getResponseHeader: [Function: getResponseHeader],
          getAllResponseHeaders: [Function: getAllResponseHeaders],
          overrideMimeType: [Function: overrideMimeType],
          onreadystatechange: [Getter/Setter],
          readyState: [Getter],
          timeout: [Getter/Setter],
          withCredentials: [Getter/Setter],
          upload: XMLHttpRequestUpload {},
          responseURL: [Getter],
          status: [Getter],
          statusText: [Getter],
          responseType: [Getter/Setter],
          response: [Getter],
          responseText: [Getter],
          responseXML: [Getter],
          UNSENT: 0,
          OPENED: 1,
          HEADERS_RECEIVED: 2,
          LOADING: 3,
          DONE: 4,
          [Symbol(SameObject caches)]: [Object: null prototype] { upload: XMLHttpRequestUpload {} }
        }
      }

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at QuotaAdvancedService.error [as executeTransfer] (src/modules/leaves/services/QuotaAdvancedService.ts:232:21)
      at Object.<anonymous> (src/modules/leaves/services/__tests__/QuotaAdvancedService.test.ts:294:28)

    console.error
      Erreur lors de l'exécution du transfert: Error: Quota insuffisant simulé
          at QuotaAdvancedService.executeTransfer (/Users/vincentperreard/Mathildanesth/src/modules/leaves/services/QuotaAdvancedService.ts:175:23)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at Object.<anonymous> (/Users/vincentperreard/Mathildanesth/src/modules/leaves/services/__tests__/QuotaAdvancedService.test.ts:316:13)

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at QuotaAdvancedService.error [as executeTransfer] (src/modules/leaves/services/QuotaAdvancedService.ts:232:21)
      at Object.<anonymous> (src/modules/leaves/services/__tests__/QuotaAdvancedService.test.ts:316:13)

    console.warn
      [MSW] Warning: intercepted a request without a matching request handler:
      
        • POST /api/audit/entries
      
        • Request body: {"actionType":"QUOTA_CARRIED_OVER","userId":"user-123","targetId":"user-123","targetType":"quota","description":"Report de 9 jour(s) de ANNUAL de 2024 vers 2025","severity":"MEDIUM","metadata":{"leaveType":"ANNUAL","fromYear":2024,"toYear":2025,"amount":9,"expiryDate":"2035-12-30T23:00:00.000Z","ruleId":"carry-rule-1"},"userAgent":"Mozilla/5.0 (darwin) AppleWebKit/537.36 (KHTML, like Gecko) jsdom/20.0.3"}
      
      If you still wish to intercept this unhandled request, please create a request handler for it.
      Read more: https://mswjs.io/docs/getting-started/mocks

      at Object.warn (node_modules/msw/src/core/utils/internal/devUtils.ts:18:11)
      at warn (node_modules/msw/src/core/utils/request/onUnhandledRequest.ts:50:18)
      at applyStrategy (node_modules/msw/src/core/utils/request/onUnhandledRequest.ts:79:5)
      at handleRequest (node_modules/msw/src/core/utils/handleRequest.ts:79:5)
      at _Emitter.<anonymous> (node_modules/msw/src/node/SetupServerCommonApi.ts:60:26)
      at emitAsync (node_modules/@mswjs/interceptors/src/utils/emitAsync.ts:23:5)
      at node_modules/@mswjs/interceptors/src/utils/handleRequest.ts:125:5
      at until (node_modules/@open-draft/until/src/until.ts:23:18)
      at handleRequest (node_modules/@mswjs/interceptors/src/utils/handleRequest.ts:114:18)
      at XMLHttpRequestController.xhrRequestController.onRequest (node_modules/@mswjs/interceptors/src/interceptors/XMLHttpRequest/XMLHttpRequestProxy.ts:64:34)

    console.error
      Error: AggregateError
          at Object.dispatchError (/Users/vincentperreard/Mathildanesth/node_modules/jsdom/lib/jsdom/living/xhr/xhr-utils.js:63:19)
          at Request.<anonymous> (/Users/vincentperreard/Mathildanesth/node_modules/jsdom/lib/jsdom/living/xhr/XMLHttpRequest-impl.js:655:18)
          at Request.emit (node:events:530:35)
          at ClientRequest.<anonymous> (/Users/vincentperreard/Mathildanesth/node_modules/jsdom/lib/jsdom/living/helpers/http-request.js:121:14)
          at ClientRequest.emit (node:events:518:28)
          at emitErrorEvent (node:_http_client:103:11)
          at MockHttpSocket.socketErrorListener (node:_http_client:506:5)
          at MockHttpSocket.emit (node:events:530:35)
          at MockHttpSocket.emitEvent [as emit] (/Users/vincentperreard/Mathildanesth/node_modules/@mswjs/interceptors/src/interceptors/ClientRequest/MockHttpSocket.ts:152:12)
          at Socket.emit (/Users/vincentperreard/Mathildanesth/node_modules/@mswjs/interceptors/src/interceptors/ClientRequest/MockHttpSocket.ts:271:14)
          at Socket.emit (node:events:518:28)
          at emitErrorNT (node:internal/streams/destroy:170:8)
          at emitErrorCloseNT (node:internal/streams/destroy:129:3)
          at processTicksAndRejections (node:internal/process/task_queues:90:21) {
        type: 'XMLHttpRequest'
      }

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at Object.dispatchError (node_modules/jsdom/lib/jsdom/living/xhr/xhr-utils.js:66:53)
      at Request.<anonymous> (node_modules/jsdom/lib/jsdom/living/xhr/XMLHttpRequest-impl.js:655:18)
      at ClientRequest.<anonymous> (node_modules/jsdom/lib/jsdom/living/helpers/http-request.js:121:14)
      at MockHttpSocket.emitEvent [as emit] (node_modules/@mswjs/interceptors/src/interceptors/ClientRequest/MockHttpSocket.ts:152:12)
      at Socket.emit (node_modules/@mswjs/interceptors/src/interceptors/ClientRequest/MockHttpSocket.ts:271:14)

    console.error
      [AuditService] Error creating audit entry: AxiosError {
        message: 'Network Error',
        name: 'AxiosError',
        code: 'ERR_NETWORK',
        config: {
          transitional: {
            silentJSONParsing: true,
            forcedJSONParsing: true,
            clarifyTimeoutError: false
          },
          adapter: [ 'xhr', 'http', 'fetch' ],
          transformRequest: [ [Function: transformRequest] ],
          transformResponse: [ [Function: transformResponse] ],
          timeout: 0,
          xsrfCookieName: 'XSRF-TOKEN',
          xsrfHeaderName: 'X-XSRF-TOKEN',
          maxContentLength: -1,
          maxBodyLength: -1,
          env: { FormData: [class FormData], Blob: [class Blob] },
          validateStatus: [Function: validateStatus],
          headers: Object [AxiosHeaders] {
            Accept: 'application/json, text/plain, */*',
            'Content-Type': 'application/json'
          },
          method: 'post',
          url: '/api/audit/entries',
          data: '{"actionType":"QUOTA_CARRIED_OVER","userId":"user-123","targetId":"user-123","targetType":"quota","description":"Report de 9 jour(s) de ANNUAL de 2024 vers 2025","severity":"MEDIUM","metadata":{"leaveType":"ANNUAL","fromYear":2024,"toYear":2025,"amount":9,"expiryDate":"2035-12-30T23:00:00.000Z","ruleId":"carry-rule-1"},"userAgent":"Mozilla/5.0 (darwin) AppleWebKit/537.36 (KHTML, like Gecko) jsdom/20.0.3"}',
          allowAbsoluteUrls: true
        },
        request: XMLHttpRequest {
          open: [Function: open],
          setRequestHeader: [Function: setRequestHeader],
          send: [Function: send],
          abort: [Function: abort],
          getResponseHeader: [Function: getResponseHeader],
          getAllResponseHeaders: [Function: getAllResponseHeaders],
          overrideMimeType: [Function: overrideMimeType],
          onreadystatechange: [Getter/Setter],
          readyState: [Getter],
          timeout: [Getter/Setter],
          withCredentials: [Getter/Setter],
          upload: XMLHttpRequestUpload {},
          responseURL: [Getter],
          status: [Getter],
          statusText: [Getter],
          responseType: [Getter/Setter],
          response: [Getter],
          responseText: [Getter],
          responseXML: [Getter],
          UNSENT: 0,
          OPENED: 1,
          HEADERS_RECEIVED: 2,
          LOADING: 3,
          DONE: 4,
          [Symbol(SameObject caches)]: [Object: null prototype] { upload: XMLHttpRequestUpload {} }
        }
      }

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at AuditService.error [as createAuditEntry] (src/modules/leaves/services/AuditService.ts:317:21)
      at QuotaAdvancedService.executeCarryOver (src/modules/leaves/services/QuotaAdvancedService.ts:359:13)
      at Object.<anonymous> (src/modules/leaves/services/__tests__/QuotaAdvancedService.test.ts:371:28)

    console.error
      Erreur lors de l'exécution du report: AxiosError {
        message: 'Network Error',
        name: 'AxiosError',
        code: 'ERR_NETWORK',
        config: {
          transitional: {
            silentJSONParsing: true,
            forcedJSONParsing: true,
            clarifyTimeoutError: false
          },
          adapter: [ 'xhr', 'http', 'fetch' ],
          transformRequest: [ [Function: transformRequest] ],
          transformResponse: [ [Function: transformResponse] ],
          timeout: 0,
          xsrfCookieName: 'XSRF-TOKEN',
          xsrfHeaderName: 'X-XSRF-TOKEN',
          maxContentLength: -1,
          maxBodyLength: -1,
          env: { FormData: [class FormData], Blob: [class Blob] },
          validateStatus: [Function: validateStatus],
          headers: Object [AxiosHeaders] {
            Accept: 'application/json, text/plain, */*',
            'Content-Type': 'application/json'
          },
          method: 'post',
          url: '/api/audit/entries',
          data: '{"actionType":"QUOTA_CARRIED_OVER","userId":"user-123","targetId":"user-123","targetType":"quota","description":"Report de 9 jour(s) de ANNUAL de 2024 vers 2025","severity":"MEDIUM","metadata":{"leaveType":"ANNUAL","fromYear":2024,"toYear":2025,"amount":9,"expiryDate":"2035-12-30T23:00:00.000Z","ruleId":"carry-rule-1"},"userAgent":"Mozilla/5.0 (darwin) AppleWebKit/537.36 (KHTML, like Gecko) jsdom/20.0.3"}',
          allowAbsoluteUrls: true
        },
        request: XMLHttpRequest {
          open: [Function: open],
          setRequestHeader: [Function: setRequestHeader],
          send: [Function: send],
          abort: [Function: abort],
          getResponseHeader: [Function: getResponseHeader],
          getAllResponseHeaders: [Function: getAllResponseHeaders],
          overrideMimeType: [Function: overrideMimeType],
          onreadystatechange: [Getter/Setter],
          readyState: [Getter],
          timeout: [Getter/Setter],
          withCredentials: [Getter/Setter],
          upload: XMLHttpRequestUpload {},
          responseURL: [Getter],
          status: [Getter],
          statusText: [Getter],
          responseType: [Getter/Setter],
          response: [Getter],
          responseText: [Getter],
          responseXML: [Getter],
          UNSENT: 0,
          OPENED: 1,
          HEADERS_RECEIVED: 2,
          LOADING: 3,
          DONE: 4,
          [Symbol(SameObject caches)]: [Object: null prototype] { upload: XMLHttpRequestUpload {} }
        }
      }

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at QuotaAdvancedService.error [as executeCarryOver] (src/modules/leaves/services/QuotaAdvancedService.ts:392:21)
      at Object.<anonymous> (src/modules/leaves/services/__tests__/QuotaAdvancedService.test.ts:371:28)

    console.error
      Erreur lors de l'exécution du report: Error: Aucun jour à reporter.
          at QuotaAdvancedService.executeCarryOver (/Users/vincentperreard/Mathildanesth/src/modules/leaves/services/QuotaAdvancedService.ts:341:23)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at Object.<anonymous> (/Users/vincentperreard/Mathildanesth/src/modules/leaves/services/__tests__/QuotaAdvancedService.test.ts:386:13)

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at QuotaAdvancedService.error [as executeCarryOver] (src/modules/leaves/services/QuotaAdvancedService.ts:392:21)
      at Object.<anonymous> (src/modules/leaves/services/__tests__/QuotaAdvancedService.test.ts:386:13)

    console.error
      Erreur lors de la récupération de l'état amélioré des quotas: Error: Network Error
          at Object.<anonymous> (/Users/vincentperreard/Mathildanesth/src/modules/leaves/services/__tests__/QuotaAdvancedService.test.ts:421:60)
          at Promise.then.completed (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/utils.js:231:10)
          at _callCircusTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:316:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:252:3)
          at _runTestsForDescribeBlock (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:126:9)
          at _runTestsForDescribeBlock (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:121:9)
          at _runTestsForDescribeBlock (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:121:9)
          at run (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:71:3)
          at runAndTransformResultsToJestFormat (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
          at jestAdapter (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:74:19)
          at runTestInternal (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/runTest.js:367:16)
          at runTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/runTest.js:444:34)
          at Object.worker (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/testWorker.js:106:12)

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at QuotaAdvancedService.error [as getEnhancedQuotaState] (src/modules/leaves/services/QuotaAdvancedService.ts:542:21)
      at Object.<anonymous> (src/modules/leaves/services/__tests__/QuotaAdvancedService.test.ts:423:13)

  ● QuotaAdvancedService › executeTransfer › devrait exécuter un transfert valide

    AxiosError: Network Error

      305 |
      306 |             // Envoyer l'entrée à l'API
    > 307 |             const response = await axios.post(`${this.apiBaseUrl}/entries`, enhancedEntry, {
          |                              ^
      308 |                 headers: this.defaultHeaders
      309 |             });
      310 |

      at XMLHttpRequest.handleError (node_modules/axios/lib/adapters/xhr.js:110:14)
      at XMLHttpRequest.invokeTheCallbackFunction (node_modules/jsdom/lib/jsdom/living/generated/EventHandlerNonNull.js:14:28)
      at XMLHttpRequest.<anonymous> (node_modules/jsdom/lib/jsdom/living/helpers/create-event-accessor.js:35:32)
      at innerInvokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)
      at invokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
      at XMLHttpRequestImpl._dispatch (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
      at fireAnEvent (node_modules/jsdom/lib/jsdom/living/helpers/events.js:18:36)
      at requestErrorSteps (node_modules/jsdom/lib/jsdom/living/xhr/xhr-utils.js:131:3)
      at Object.dispatchError (node_modules/jsdom/lib/jsdom/living/xhr/xhr-utils.js:60:3)
      at Request.<anonymous> (node_modules/jsdom/lib/jsdom/living/xhr/XMLHttpRequest-impl.js:655:18)
      at ClientRequest.<anonymous> (node_modules/jsdom/lib/jsdom/living/helpers/http-request.js:121:14)
      at MockHttpSocket.emitEvent [as emit] (node_modules/@mswjs/interceptors/src/interceptors/ClientRequest/MockHttpSocket.ts:152:12)
      at Socket.emit (node_modules/@mswjs/interceptors/src/interceptors/ClientRequest/MockHttpSocket.ts:271:14)
      at Axios.request (node_modules/axios/lib/core/Axios.js:45:41)
      at AuditService.createAuditEntry (src/modules/leaves/services/AuditService.ts:307:30)
      at QuotaAdvancedService.executeTransfer (src/modules/leaves/services/QuotaAdvancedService.ts:199:13)
      at Object.<anonymous> (src/modules/leaves/services/__tests__/QuotaAdvancedService.test.ts:294:28)

  ● QuotaAdvancedService › executeCarryOver › devrait exécuter un report valide

    AxiosError: Network Error

      305 |
      306 |             // Envoyer l'entrée à l'API
    > 307 |             const response = await axios.post(`${this.apiBaseUrl}/entries`, enhancedEntry, {
          |                              ^
      308 |                 headers: this.defaultHeaders
      309 |             });
      310 |

      at XMLHttpRequest.handleError (node_modules/axios/lib/adapters/xhr.js:110:14)
      at XMLHttpRequest.invokeTheCallbackFunction (node_modules/jsdom/lib/jsdom/living/generated/EventHandlerNonNull.js:14:28)
      at XMLHttpRequest.<anonymous> (node_modules/jsdom/lib/jsdom/living/helpers/create-event-accessor.js:35:32)
      at innerInvokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)
      at invokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
      at XMLHttpRequestImpl._dispatch (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
      at fireAnEvent (node_modules/jsdom/lib/jsdom/living/helpers/events.js:18:36)
      at requestErrorSteps (node_modules/jsdom/lib/jsdom/living/xhr/xhr-utils.js:131:3)
      at Object.dispatchError (node_modules/jsdom/lib/jsdom/living/xhr/xhr-utils.js:60:3)
      at Request.<anonymous> (node_modules/jsdom/lib/jsdom/living/xhr/XMLHttpRequest-impl.js:655:18)
      at ClientRequest.<anonymous> (node_modules/jsdom/lib/jsdom/living/helpers/http-request.js:121:14)
      at MockHttpSocket.emitEvent [as emit] (node_modules/@mswjs/interceptors/src/interceptors/ClientRequest/MockHttpSocket.ts:152:12)
      at Socket.emit (node_modules/@mswjs/interceptors/src/interceptors/ClientRequest/MockHttpSocket.ts:271:14)
      at Axios.request (node_modules/axios/lib/core/Axios.js:45:41)
      at AuditService.createAuditEntry (src/modules/leaves/services/AuditService.ts:307:30)
      at QuotaAdvancedService.executeCarryOver (src/modules/leaves/services/QuotaAdvancedService.ts:359:13)
      at Object.<anonymous> (src/modules/leaves/services/__tests__/QuotaAdvancedService.test.ts:371:28)

(node:80199) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.
(Use `node --trace-deprecation ...` to show where the warning was created)
(node:80194) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.
(Use `node --trace-deprecation ...` to show where the warning was created)
(node:80193) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.
(Use `node --trace-deprecation ...` to show where the warning was created)
FAIL src/modules/leaves/hooks/useConflictDetection.test.ts
  ● Console

    console.log
      jest.polyfills.js loaded and applied.

      at Object.<anonymous> (jest.polyfills.js:247:9)

    console.log
      jest.setup.js loaded and mocks applied.

      at Object.log (jest.setup.js:126:9)

  ● useConflictDetection › devrait initialiser correctement le hook

    Cannot use spyOn on a primitive value; undefined given

      91 |         // Remplacer la vérification des dates dans le hook useConflictDetection avec une implémentation simplifiée
      92 |         // qui va toujours réussir pour les tests
    > 93 |         jest.spyOn(useConflictDetection.prototype as any, 'validateDates').mockImplementation(() => true);
         |              ^
      94 |     });
      95 |
      96 |     it('devrait initialiser correctement le hook', () => {

      at ModuleMocker.spyOn (node_modules/jest-mock/build/index.js:719:13)
      at Object.<anonymous> (src/modules/leaves/hooks/useConflictDetection.test.ts:93:14)

  ● useConflictDetection › validateDates › devrait valider correctement des dates valides

    Cannot use spyOn on a primitive value; undefined given

      91 |         // Remplacer la vérification des dates dans le hook useConflictDetection avec une implémentation simplifiée
      92 |         // qui va toujours réussir pour les tests
    > 93 |         jest.spyOn(useConflictDetection.prototype as any, 'validateDates').mockImplementation(() => true);
         |              ^
      94 |     });
      95 |
      96 |     it('devrait initialiser correctement le hook', () => {

      at ModuleMocker.spyOn (node_modules/jest-mock/build/index.js:719:13)
      at Object.<anonymous> (src/modules/leaves/hooks/useConflictDetection.test.ts:93:14)

  ● useConflictDetection › validateDates › devrait rejeter des dates invalides - startDate null

    Cannot use spyOn on a primitive value; undefined given

      91 |         // Remplacer la vérification des dates dans le hook useConflictDetection avec une implémentation simplifiée
      92 |         // qui va toujours réussir pour les tests
    > 93 |         jest.spyOn(useConflictDetection.prototype as any, 'validateDates').mockImplementation(() => true);
         |              ^
      94 |     });
      95 |
      96 |     it('devrait initialiser correctement le hook', () => {

      at ModuleMocker.spyOn (node_modules/jest-mock/build/index.js:719:13)
      at Object.<anonymous> (src/modules/leaves/hooks/useConflictDetection.test.ts:93:14)

  ● useConflictDetection › validateDates › devrait rejeter des dates invalides - endDate null

    Cannot use spyOn on a primitive value; undefined given

      91 |         // Remplacer la vérification des dates dans le hook useConflictDetection avec une implémentation simplifiée
      92 |         // qui va toujours réussir pour les tests
    > 93 |         jest.spyOn(useConflictDetection.prototype as any, 'validateDates').mockImplementation(() => true);
         |              ^
      94 |     });
      95 |
      96 |     it('devrait initialiser correctement le hook', () => {

      at ModuleMocker.spyOn (node_modules/jest-mock/build/index.js:719:13)
      at Object.<anonymous> (src/modules/leaves/hooks/useConflictDetection.test.ts:93:14)

  ● useConflictDetection › validateDates › devrait rejeter des dates invalides - date de début après date de fin

    Cannot use spyOn on a primitive value; undefined given

      91 |         // Remplacer la vérification des dates dans le hook useConflictDetection avec une implémentation simplifiée
      92 |         // qui va toujours réussir pour les tests
    > 93 |         jest.spyOn(useConflictDetection.prototype as any, 'validateDates').mockImplementation(() => true);
         |              ^
      94 |     });
      95 |
      96 |     it('devrait initialiser correctement le hook', () => {

      at ModuleMocker.spyOn (node_modules/jest-mock/build/index.js:719:13)
      at Object.<anonymous> (src/modules/leaves/hooks/useConflictDetection.test.ts:93:14)

  ● useConflictDetection › validateDates › devrait rejeter des dates lorsque la validation échoue

    Cannot use spyOn on a primitive value; undefined given

      91 |         // Remplacer la vérification des dates dans le hook useConflictDetection avec une implémentation simplifiée
      92 |         // qui va toujours réussir pour les tests
    > 93 |         jest.spyOn(useConflictDetection.prototype as any, 'validateDates').mockImplementation(() => true);
         |              ^
      94 |     });
      95 |
      96 |     it('devrait initialiser correctement le hook', () => {

      at ModuleMocker.spyOn (node_modules/jest-mock/build/index.js:719:13)
      at Object.<anonymous> (src/modules/leaves/hooks/useConflictDetection.test.ts:93:14)

  ● useConflictDetection › checkConflicts › devrait vérifier les conflits et mettre à jour l'état - sans conflits

    Cannot use spyOn on a primitive value; undefined given

      91 |         // Remplacer la vérification des dates dans le hook useConflictDetection avec une implémentation simplifiée
      92 |         // qui va toujours réussir pour les tests
    > 93 |         jest.spyOn(useConflictDetection.prototype as any, 'validateDates').mockImplementation(() => true);
         |              ^
      94 |     });
      95 |
      96 |     it('devrait initialiser correctement le hook', () => {

      at ModuleMocker.spyOn (node_modules/jest-mock/build/index.js:719:13)
      at Object.<anonymous> (src/modules/leaves/hooks/useConflictDetection.test.ts:93:14)

  ● useConflictDetection › checkConflicts › devrait vérifier les conflits et mettre à jour l'état - avec conflits

    Cannot use spyOn on a primitive value; undefined given

      91 |         // Remplacer la vérification des dates dans le hook useConflictDetection avec une implémentation simplifiée
      92 |         // qui va toujours réussir pour les tests
    > 93 |         jest.spyOn(useConflictDetection.prototype as any, 'validateDates').mockImplementation(() => true);
         |              ^
      94 |     });
      95 |
      96 |     it('devrait initialiser correctement le hook', () => {

      at ModuleMocker.spyOn (node_modules/jest-mock/build/index.js:719:13)
      at Object.<anonymous> (src/modules/leaves/hooks/useConflictDetection.test.ts:93:14)

  ● useConflictDetection › checkConflicts › devrait gérer les erreurs lors de la vérification des conflits

    Cannot use spyOn on a primitive value; undefined given

      91 |         // Remplacer la vérification des dates dans le hook useConflictDetection avec une implémentation simplifiée
      92 |         // qui va toujours réussir pour les tests
    > 93 |         jest.spyOn(useConflictDetection.prototype as any, 'validateDates').mockImplementation(() => true);
         |              ^
      94 |     });
      95 |
      96 |     it('devrait initialiser correctement le hook', () => {

      at ModuleMocker.spyOn (node_modules/jest-mock/build/index.js:719:13)
      at Object.<anonymous> (src/modules/leaves/hooks/useConflictDetection.test.ts:93:14)

  ● useConflictDetection › checkConflicts › devrait rejeter avec une erreur si les dates sont invalides

    Cannot use spyOn on a primitive value; undefined given

      91 |         // Remplacer la vérification des dates dans le hook useConflictDetection avec une implémentation simplifiée
      92 |         // qui va toujours réussir pour les tests
    > 93 |         jest.spyOn(useConflictDetection.prototype as any, 'validateDates').mockImplementation(() => true);
         |              ^
      94 |     });
      95 |
      96 |     it('devrait initialiser correctement le hook', () => {

      at ModuleMocker.spyOn (node_modules/jest-mock/build/index.js:719:13)
      at Object.<anonymous> (src/modules/leaves/hooks/useConflictDetection.test.ts:93:14)

  ● useConflictDetection › checkConflicts › ne devrait pas appeler checkLeaveConflicts si les dates sont invalides

    Cannot use spyOn on a primitive value; undefined given

      91 |         // Remplacer la vérification des dates dans le hook useConflictDetection avec une implémentation simplifiée
      92 |         // qui va toujours réussir pour les tests
    > 93 |         jest.spyOn(useConflictDetection.prototype as any, 'validateDates').mockImplementation(() => true);
         |              ^
      94 |     });
      95 |
      96 |     it('devrait initialiser correctement le hook', () => {

      at ModuleMocker.spyOn (node_modules/jest-mock/build/index.js:719:13)
      at Object.<anonymous> (src/modules/leaves/hooks/useConflictDetection.test.ts:93:14)

  ● useConflictDetection › checkConflicts › devrait mettre à jour les conflits lorsque le service renvoie des conflits

    Cannot use spyOn on a primitive value; undefined given

      91 |         // Remplacer la vérification des dates dans le hook useConflictDetection avec une implémentation simplifiée
      92 |         // qui va toujours réussir pour les tests
    > 93 |         jest.spyOn(useConflictDetection.prototype as any, 'validateDates').mockImplementation(() => true);
         |              ^
      94 |     });
      95 |
      96 |     it('devrait initialiser correctement le hook', () => {

      at ModuleMocker.spyOn (node_modules/jest-mock/build/index.js:719:13)
      at Object.<anonymous> (src/modules/leaves/hooks/useConflictDetection.test.ts:93:14)

  ● useConflictDetection › checkConflicts › devrait gérer les erreurs du service

    Cannot use spyOn on a primitive value; undefined given

      91 |         // Remplacer la vérification des dates dans le hook useConflictDetection avec une implémentation simplifiée
      92 |         // qui va toujours réussir pour les tests
    > 93 |         jest.spyOn(useConflictDetection.prototype as any, 'validateDates').mockImplementation(() => true);
         |              ^
      94 |     });
      95 |
      96 |     it('devrait initialiser correctement le hook', () => {

      at ModuleMocker.spyOn (node_modules/jest-mock/build/index.js:719:13)
      at Object.<anonymous> (src/modules/leaves/hooks/useConflictDetection.test.ts:93:14)

  ● useConflictDetection › checkConflicts › ne devrait pas appeler le service si les dates sont invalides

    Cannot use spyOn on a primitive value; undefined given

      91 |         // Remplacer la vérification des dates dans le hook useConflictDetection avec une implémentation simplifiée
      92 |         // qui va toujours réussir pour les tests
    > 93 |         jest.spyOn(useConflictDetection.prototype as any, 'validateDates').mockImplementation(() => true);
         |              ^
      94 |     });
      95 |
      96 |     it('devrait initialiser correctement le hook', () => {

      at ModuleMocker.spyOn (node_modules/jest-mock/build/index.js:719:13)
      at Object.<anonymous> (src/modules/leaves/hooks/useConflictDetection.test.ts:93:14)

  ● useConflictDetection › getConflictsByType › devrait filtrer les conflits par type

    Cannot use spyOn on a primitive value; undefined given

      91 |         // Remplacer la vérification des dates dans le hook useConflictDetection avec une implémentation simplifiée
      92 |         // qui va toujours réussir pour les tests
    > 93 |         jest.spyOn(useConflictDetection.prototype as any, 'validateDates').mockImplementation(() => true);
         |              ^
      94 |     });
      95 |
      96 |     it('devrait initialiser correctement le hook', () => {

      at ModuleMocker.spyOn (node_modules/jest-mock/build/index.js:719:13)
      at Object.<anonymous> (src/modules/leaves/hooks/useConflictDetection.test.ts:93:14)

  ● useConflictDetection › resolveConflict › devrait supprimer un conflit et mettre à jour l'état des conflits bloquants

    Cannot use spyOn on a primitive value; undefined given

      91 |         // Remplacer la vérification des dates dans le hook useConflictDetection avec une implémentation simplifiée
      92 |         // qui va toujours réussir pour les tests
    > 93 |         jest.spyOn(useConflictDetection.prototype as any, 'validateDates').mockImplementation(() => true);
         |              ^
      94 |     });
      95 |
      96 |     it('devrait initialiser correctement le hook', () => {

      at ModuleMocker.spyOn (node_modules/jest-mock/build/index.js:719:13)
      at Object.<anonymous> (src/modules/leaves/hooks/useConflictDetection.test.ts:93:14)

  ● useConflictDetection › resetConflicts › devrait réinitialiser l'état des conflits

    Cannot use spyOn on a primitive value; undefined given

      91 |         // Remplacer la vérification des dates dans le hook useConflictDetection avec une implémentation simplifiée
      92 |         // qui va toujours réussir pour les tests
    > 93 |         jest.spyOn(useConflictDetection.prototype as any, 'validateDates').mockImplementation(() => true);
         |              ^
      94 |     });
      95 |
      96 |     it('devrait initialiser correctement le hook', () => {

      at ModuleMocker.spyOn (node_modules/jest-mock/build/index.js:719:13)
      at Object.<anonymous> (src/modules/leaves/hooks/useConflictDetection.test.ts:93:14)

(node:80196) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.
(Use `node --trace-deprecation ...` to show where the warning was created)
FAIL src/modules/leaves/services/__tests__/conflictRecommendationService.test.ts
  ● Console

    console.log
      jest.polyfills.js loaded and applied.

      at Object.<anonymous> (jest.polyfills.js:247:9)

    console.log
      jest.setup.js loaded and mocks applied.

      at Object.log (jest.setup.js:126:9)

    console.log
      [Service Debug] analyzeConflicts - conflicts.length: 0

      at ConflictRecommendationService.log [as analyzeConflicts] (src/modules/leaves/services/conflictRecommendationService.ts:74:17)

    console.log
      [Service Debug] Aucun conflit, appel de createEmptyAnalysisResult

      at ConflictRecommendationService.log [as analyzeConflicts] (src/modules/leaves/services/conflictRecommendationService.ts:76:21)

    console.log
      [Service Debug] emptyResult: {"recommendations":[],"automatedResolutionsCount":0,"manualResolutionsCount":0,"priorityDistribution":{},"highestPriorityConflicts":[]}

      at ConflictRecommendationService.log [as analyzeConflicts] (src/modules/leaves/services/conflictRecommendationService.ts:78:21)

    console.log
      [Service Debug] analyzeConflicts - conflicts.length: 2

      at ConflictRecommendationService.log [as analyzeConflicts] (src/modules/leaves/services/conflictRecommendationService.ts:74:17)

    console.log
      [Service Debug] analyzeConflicts - generating recommendations...

      at ConflictRecommendationService.log [as analyzeConflicts] (src/modules/leaves/services/conflictRecommendationService.ts:83:21)

    console.log
      [Service Debug] analyzeConflicts - generated recommendations: [{"conflictId":"conflict1","priority":3,"strategies":[{"strategy":"RESCHEDULE_BEFORE","description":"Reprogrammer une semaine avant (25/05/2025 - 31/05/2025)","confidence":75,"alternativeDates":[{"startDate":"25/05/2025","endDate":"31/05/2025"}]},{"strategy":"RESCHEDULE_AFTER","description":"Reprogrammer une semaine après (08/06/2025 - 14/06/2025)","confidence":75,"alternativeDates":[{"startDate":"08/06/2025","endDate":"14/06/2025"}]},{"strategy":"REJECT","description":"Rejeter la demande de congé en raison du conflit","confidence":40}],"automaticResolution":false,"explanation":"Ce conflit est de priorité moyenne. Une intervention manuelle est recommandée. Stratégie principale recommandée : Reprogrammer une semaine avant (25/05/2025 - 31/05/2025). Alternative(s) possible(s) : Reprogrammer une semaine après (08/06/2025 - 14/06/2025), Rejeter la demande de congé en raison du conflit.","resolutionStatus":"PENDING"},{"conflictId":"conflict2","priority":5,"strategies":[{"strategy":"REJECT","description":"Rejeter la demande de congé en raison du conflit","confidence":85},{"strategy":"RESCHEDULE_AFTER","description":"Reprogrammer une semaine après (12/06/2025 - 17/06/2025)","confidence":75,"alternativeDates":[{"startDate":"12/06/2025","endDate":"17/06/2025"}]}],"automaticResolution":false,"explanation":"Ce conflit est de priorité très élevée. Une intervention manuelle est recommandée. Stratégie principale recommandée : Rejeter la demande de congé en raison du conflit. Alternative(s) possible(s) : Reprogrammer une semaine après (12/06/2025 - 17/06/2025).","resolutionStatus":"PENDING"}]

      at ConflictRecommendationService.log [as analyzeConflicts] (src/modules/leaves/services/conflictRecommendationService.ts:87:21)

    console.log
      [Service Debug] analyzeConflicts - conflicts.length: 2

      at ConflictRecommendationService.log [as analyzeConflicts] (src/modules/leaves/services/conflictRecommendationService.ts:74:17)

    console.log
      [Service Debug] analyzeConflicts - generating recommendations...

      at ConflictRecommendationService.log [as analyzeConflicts] (src/modules/leaves/services/conflictRecommendationService.ts:83:21)

    console.log
      [Service Debug] analyzeConflicts - generated recommendations: [{"conflictId":"conflict1","priority":3,"strategies":[{"strategy":"RESCHEDULE_BEFORE","description":"Reprogrammer une semaine avant (25/05/2025 - 31/05/2025)","confidence":75,"alternativeDates":[{"startDate":"25/05/2025","endDate":"31/05/2025"}]},{"strategy":"RESCHEDULE_AFTER","description":"Reprogrammer une semaine après (08/06/2025 - 14/06/2025)","confidence":75,"alternativeDates":[{"startDate":"08/06/2025","endDate":"14/06/2025"}]},{"strategy":"REJECT","description":"Rejeter la demande de congé en raison du conflit","confidence":40}],"automaticResolution":true,"explanation":"Ce conflit est de priorité moyenne. La résolution automatique est possible. Stratégie principale recommandée : Reprogrammer une semaine avant (25/05/2025 - 31/05/2025). Alternative(s) possible(s) : Reprogrammer une semaine après (08/06/2025 - 14/06/2025), Rejeter la demande de congé en raison du conflit.","resolutionStatus":"PENDING"},{"conflictId":"conflict2","priority":5,"strategies":[{"strategy":"REJECT","description":"Rejeter la demande de congé en raison du conflit","confidence":85},{"strategy":"RESCHEDULE_AFTER","description":"Reprogrammer une semaine après (12/06/2025 - 17/06/2025)","confidence":75,"alternativeDates":[{"startDate":"12/06/2025","endDate":"17/06/2025"}]}],"automaticResolution":false,"explanation":"Ce conflit est de priorité très élevée. Une intervention manuelle est recommandée. Stratégie principale recommandée : Rejeter la demande de congé en raison du conflit. Alternative(s) possible(s) : Reprogrammer une semaine après (12/06/2025 - 17/06/2025).","resolutionStatus":"PENDING"}]

      at ConflictRecommendationService.log [as analyzeConflicts] (src/modules/leaves/services/conflictRecommendationService.ts:87:21)

    console.log
      [Service Debug] analyzeConflicts - conflicts.length: 2

      at ConflictRecommendationService.log [as analyzeConflicts] (src/modules/leaves/services/conflictRecommendationService.ts:74:17)

    console.log
      [Service Debug] analyzeConflicts - generating recommendations...

      at ConflictRecommendationService.log [as analyzeConflicts] (src/modules/leaves/services/conflictRecommendationService.ts:83:21)

    console.log
      [Service Debug] analyzeConflicts - generated recommendations: [{"conflictId":"conflict1","priority":3,"strategies":[{"strategy":"RESCHEDULE_BEFORE","description":"Reprogrammer une semaine avant (25/05/2025 - 31/05/2025)","confidence":75,"alternativeDates":[{"startDate":"25/05/2025","endDate":"31/05/2025"}]},{"strategy":"RESCHEDULE_AFTER","description":"Reprogrammer une semaine après (08/06/2025 - 14/06/2025)","confidence":75,"alternativeDates":[{"startDate":"08/06/2025","endDate":"14/06/2025"}]},{"strategy":"REJECT","description":"Rejeter la demande de congé en raison du conflit","confidence":40}],"automaticResolution":true,"explanation":"Ce conflit est de priorité moyenne. La résolution automatique est possible. Stratégie principale recommandée : Reprogrammer une semaine avant (25/05/2025 - 31/05/2025). Alternative(s) possible(s) : Reprogrammer une semaine après (08/06/2025 - 14/06/2025), Rejeter la demande de congé en raison du conflit.","resolutionStatus":"PENDING"},{"conflictId":"conflict2","priority":5,"strategies":[{"strategy":"REJECT","description":"Rejeter la demande de congé en raison du conflit","confidence":85},{"strategy":"RESCHEDULE_AFTER","description":"Reprogrammer une semaine après (12/06/2025 - 17/06/2025)","confidence":75,"alternativeDates":[{"startDate":"12/06/2025","endDate":"17/06/2025"}]}],"automaticResolution":false,"explanation":"Ce conflit est de priorité très élevée. Une intervention manuelle est recommandée. Stratégie principale recommandée : Rejeter la demande de congé en raison du conflit. Alternative(s) possible(s) : Reprogrammer une semaine après (12/06/2025 - 17/06/2025).","resolutionStatus":"PENDING"}]

      at ConflictRecommendationService.log [as analyzeConflicts] (src/modules/leaves/services/conflictRecommendationService.ts:87:21)

    console.log
      [Service Debug] analyzeConflicts - conflicts.length: 2

      at ConflictRecommendationService.log [as analyzeConflicts] (src/modules/leaves/services/conflictRecommendationService.ts:74:17)

    console.log
      [Service Debug] analyzeConflicts - generating recommendations...

      at ConflictRecommendationService.log [as analyzeConflicts] (src/modules/leaves/services/conflictRecommendationService.ts:83:21)

    console.log
      [Service Debug] analyzeConflicts - generated recommendations: [{"conflictId":"conflict1","priority":3,"strategies":[{"strategy":"RESCHEDULE_BEFORE","description":"Reprogrammer une semaine avant (25/05/2025 - 31/05/2025)","confidence":75,"alternativeDates":[{"startDate":"25/05/2025","endDate":"31/05/2025"}]},{"strategy":"RESCHEDULE_AFTER","description":"Reprogrammer une semaine après (08/06/2025 - 14/06/2025)","confidence":75,"alternativeDates":[{"startDate":"08/06/2025","endDate":"14/06/2025"}]},{"strategy":"REJECT","description":"Rejeter la demande de congé en raison du conflit","confidence":40}],"automaticResolution":true,"explanation":"Ce conflit est de priorité moyenne. La résolution automatique est possible. Stratégie principale recommandée : Reprogrammer une semaine avant (25/05/2025 - 31/05/2025). Alternative(s) possible(s) : Reprogrammer une semaine après (08/06/2025 - 14/06/2025), Rejeter la demande de congé en raison du conflit.","resolutionStatus":"PENDING"},{"conflictId":"conflict2","priority":5,"strategies":[{"strategy":"REJECT","description":"Rejeter la demande de congé en raison du conflit","confidence":85},{"strategy":"RESCHEDULE_AFTER","description":"Reprogrammer une semaine après (12/06/2025 - 17/06/2025)","confidence":75,"alternativeDates":[{"startDate":"12/06/2025","endDate":"17/06/2025"}]}],"automaticResolution":false,"explanation":"Ce conflit est de priorité très élevée. Une intervention manuelle est recommandée. Stratégie principale recommandée : Rejeter la demande de congé en raison du conflit. Alternative(s) possible(s) : Reprogrammer une semaine après (12/06/2025 - 17/06/2025).","resolutionStatus":"PENDING"}]

      at ConflictRecommendationService.log [as analyzeConflicts] (src/modules/leaves/services/conflictRecommendationService.ts:87:21)

  ● ConflictRecommendationService › analyzeConflicts › devrait identifier correctement les résolutions automatiques possibles

    expect(jest.fn()).toHaveBeenCalled()

    Expected number of calls: >= 1
    Received number of calls:    0

      134 |
      135 |             // Vérifier que l'événement a été émis pour les résolutions automatiques
    > 136 |             expect(mockEventBus.emit).toHaveBeenCalled();
          |                                       ^
      137 |         });
      138 |
      139 |         it('devrait calculer correctement la distribution des priorités', () => {

      at Object.<anonymous> (src/modules/leaves/services/__tests__/conflictRecommendationService.test.ts:136:39)

  ● ConflictRecommendationService › updateRules › devrait mettre à jour les règles et émettre un événement

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: {"data": {"updatedBy": "user", "updatedRules": ["priorityRules"]}, "type": "conflict.rules.updated"}

    Number of calls: 0

      186 |
      187 |             // Vérifier que l'événement a été émis
    > 188 |             expect(mockEventBus.emit).toHaveBeenCalledWith({
          |                                       ^
      189 |                 type: 'conflict.rules.updated',
      190 |                 data: {
      191 |                     updatedRules: Object.keys(newRules),

      at Object.<anonymous> (src/modules/leaves/services/__tests__/conflictRecommendationService.test.ts:188:39)

  ● ConflictRecommendationService › resetRulesToDefault › devrait réinitialiser les règles aux valeurs par défaut

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: {"data": {"resetToDefault": true, "updatedBy": "user", "updatedRules": ["all"]}, "type": "conflict.rules.updated"}

    Number of calls: 0

      215 |
      216 |             // Vérifier que l'événement a été émis
    > 217 |             expect(mockEventBus.emit).toHaveBeenCalledWith({
          |                                       ^
      218 |                 type: 'conflict.rules.updated',
      219 |                 data: {
      220 |                     updatedRules: ['all'],

      at Object.<anonymous> (src/modules/leaves/services/__tests__/conflictRecommendationService.test.ts:217:39)

(node:80195) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.
(Use `node --trace-deprecation ...` to show where the warning was created)
FAIL src/modules/leaves/services/__tests__/leaveCalculator.comprehensive.test.ts
  ● Console

    console.log
      jest.polyfills.js loaded and applied.

      at Object.<anonymous> (jest.polyfills.js:247:9)

    console.log
      jest.setup.js loaded and mocks applied.

      at Object.log (jest.setup.js:126:9)

    console.log
      Initializing console logger for client.

      at log (src/utils/logger.ts:45:21)

    console.info
      Starting leave counted days calculation... {
        startDate: '05/08/2024',
        endDate: '09/08/2024',
        scheduleId: 1,
        isHalfDay: false,
        halfDayPeriod: undefined,
        options: undefined
      }

      at info (src/modules/leaves/services/leaveCalculator.ts:140:16)

    console.info
      Fetched 0 public holidays for the period.

      at info (src/modules/leaves/services/leaveCalculator.ts:179:16)

    console.info
      Leave counted days calculation successful { countedDays: 5, workDays: 5, scheduleId: 1 }

      at info (src/modules/leaves/services/leaveCalculator.ts:345:16)

    console.info
      Starting leave counted days calculation... {
        startDate: '05/08/2024',
        endDate: '11/08/2024',
        scheduleId: 1,
        isHalfDay: false,
        halfDayPeriod: undefined,
        options: undefined
      }

      at info (src/modules/leaves/services/leaveCalculator.ts:140:16)

    console.info
      Fetched 0 public holidays for the period.

      at info (src/modules/leaves/services/leaveCalculator.ts:179:16)

    console.info
      Leave counted days calculation successful { countedDays: 5, workDays: 5, scheduleId: 1 }

      at info (src/modules/leaves/services/leaveCalculator.ts:345:16)

    console.info
      Starting leave counted days calculation... {
        startDate: '05/08/2024',
        endDate: '05/08/2024',
        scheduleId: 1,
        isHalfDay: false,
        halfDayPeriod: undefined,
        options: undefined
      }

      at info (src/modules/leaves/services/leaveCalculator.ts:140:16)

    console.info
      Fetched 0 public holidays for the period.

      at info (src/modules/leaves/services/leaveCalculator.ts:179:16)

    console.info
      Leave counted days calculation successful { countedDays: 1, workDays: 1, scheduleId: 1 }

      at info (src/modules/leaves/services/leaveCalculator.ts:345:16)

    console.info
      Starting leave counted days calculation... {
        startDate: '10/08/2024',
        endDate: '11/08/2024',
        scheduleId: 1,
        isHalfDay: false,
        halfDayPeriod: undefined,
        options: undefined
      }

      at info (src/modules/leaves/services/leaveCalculator.ts:140:16)

    console.info
      Fetched 0 public holidays for the period.

      at info (src/modules/leaves/services/leaveCalculator.ts:179:16)

    console.info
      Leave counted days calculation successful { countedDays: 0, workDays: 0, scheduleId: 1 }

      at info (src/modules/leaves/services/leaveCalculator.ts:345:16)

    console.warn
      Invalid dates provided to calculateLeaveCountedDays {
        startDateInput: 2024-08-10T00:00:00.000Z,
        endDateInput: 2024-08-05T00:00:00.000Z
      }

      117 |         // Vérifier que la date de fin est après la date de début
      118 |         if (isAfter(startDate, endDate)) {
    > 119 |             logger.warn('Invalid dates provided to calculateLeaveCountedDays', { startDateInput, endDateInput });
          |                    ^
      120 |             return null;
      121 |         }
      122 |

      at warn (src/modules/leaves/services/leaveCalculator.ts:119:20)
      at Object.<anonymous> (src/modules/leaves/services/__tests__/leaveCalculator.comprehensive.test.ts:93:28)

    console.info
      Starting leave counted days calculation... {
        startDate: '05/08/2024',
        endDate: '09/08/2024',
        scheduleId: 1,
        isHalfDay: false,
        halfDayPeriod: undefined,
        options: undefined
      }

      at info (src/modules/leaves/services/leaveCalculator.ts:140:16)

    console.info
      Fetched 1 public holidays for the period.

      at info (src/modules/leaves/services/leaveCalculator.ts:179:16)

    console.info
      Leave counted days calculation successful { countedDays: 4, workDays: 4, scheduleId: 1 }

      at info (src/modules/leaves/services/leaveCalculator.ts:345:16)

    console.info
      Starting leave counted days calculation... {
        startDate: '23/12/2024',
        endDate: '27/12/2024',
        scheduleId: 1,
        isHalfDay: false,
        halfDayPeriod: undefined,
        options: undefined
      }

      at info (src/modules/leaves/services/leaveCalculator.ts:140:16)

    console.info
      Fetched 2 public holidays for the period.

      at info (src/modules/leaves/services/leaveCalculator.ts:179:16)

    console.info
      Leave counted days calculation successful { countedDays: 3, workDays: 3, scheduleId: 1 }

      at info (src/modules/leaves/services/leaveCalculator.ts:345:16)

    console.info
      Starting leave counted days calculation... {
        startDate: '05/08/2024',
        endDate: '11/08/2024',
        scheduleId: 1,
        isHalfDay: false,
        halfDayPeriod: undefined,
        options: undefined
      }

      at info (src/modules/leaves/services/leaveCalculator.ts:140:16)

    console.info
      Fetched 1 public holidays for the period.

      at info (src/modules/leaves/services/leaveCalculator.ts:179:16)

    console.info
      Leave counted days calculation successful { countedDays: 5, workDays: 5, scheduleId: 1 }

      at info (src/modules/leaves/services/leaveCalculator.ts:345:16)

    console.info
      Starting leave counted days calculation... {
        startDate: '05/08/2024',
        endDate: '05/08/2024',
        scheduleId: 1,
        isHalfDay: true,
        halfDayPeriod: 'AM',
        options: { isHalfDay: true }
      }

      at info (src/modules/leaves/services/leaveCalculator.ts:140:16)

    console.info
      Fetched 0 public holidays for the period.

      at info (src/modules/leaves/services/leaveCalculator.ts:179:16)

    console.info
      Leave counted days calculation successful { countedDays: 0.5, workDays: 1, scheduleId: 1 }

      at info (src/modules/leaves/services/leaveCalculator.ts:345:16)

    console.info
      Starting leave counted days calculation... {
        startDate: '05/08/2024',
        endDate: '05/08/2024',
        scheduleId: 1,
        isHalfDay: true,
        halfDayPeriod: 'AM',
        options: { isHalfDay: true, halfDayPeriod: 'AM' }
      }

      at info (src/modules/leaves/services/leaveCalculator.ts:140:16)

    console.info
      Fetched 0 public holidays for the period.

      at info (src/modules/leaves/services/leaveCalculator.ts:179:16)

    console.info
      Leave counted days calculation successful { countedDays: 0.5, workDays: 1, scheduleId: 1 }

      at info (src/modules/leaves/services/leaveCalculator.ts:345:16)

    console.info
      Starting leave counted days calculation... {
        startDate: '05/08/2024',
        endDate: '05/08/2024',
        scheduleId: 1,
        isHalfDay: true,
        halfDayPeriod: 'PM',
        options: { isHalfDay: true, halfDayPeriod: 'PM' }
      }

      at info (src/modules/leaves/services/leaveCalculator.ts:140:16)

    console.info
      Fetched 0 public holidays for the period.

      at info (src/modules/leaves/services/leaveCalculator.ts:179:16)

    console.info
      Leave counted days calculation successful { countedDays: 0.5, workDays: 1, scheduleId: 1 }

      at info (src/modules/leaves/services/leaveCalculator.ts:345:16)

    console.info
      Starting leave counted days calculation... {
        startDate: '05/08/2024',
        endDate: '09/08/2024',
        scheduleId: 1,
        isHalfDay: false,
        halfDayPeriod: undefined,
        options: undefined
      }

      at info (src/modules/leaves/services/leaveCalculator.ts:140:16)

    console.info
      Fetched 0 public holidays for the period.

      at info (src/modules/leaves/services/leaveCalculator.ts:179:16)

    console.info
      Leave counted days calculation successful { countedDays: 4, workDays: 5, scheduleId: 1 }

      at info (src/modules/leaves/services/leaveCalculator.ts:345:16)

    console.info
      Starting leave counted days calculation... {
        startDate: '05/08/2024',
        endDate: '09/08/2024',
        scheduleId: 1,
        isHalfDay: false,
        halfDayPeriod: undefined,
        options: undefined
      }

      at info (src/modules/leaves/services/leaveCalculator.ts:140:16)

    console.info
      Fetched 0 public holidays for the period.

      at info (src/modules/leaves/services/leaveCalculator.ts:179:16)

    console.info
      Leave counted days calculation successful { countedDays: 5, workDays: 5, scheduleId: 1 }

      at info (src/modules/leaves/services/leaveCalculator.ts:345:16)

    console.info
      Starting leave counted days calculation... {
        startDate: '01/08/2024',
        endDate: '31/08/2024',
        scheduleId: 1,
        isHalfDay: false,
        halfDayPeriod: undefined,
        options: undefined
      }

      at info (src/modules/leaves/services/leaveCalculator.ts:140:16)

    console.info
      Fetched 0 public holidays for the period.

      at info (src/modules/leaves/services/leaveCalculator.ts:179:16)

    console.info
      Leave counted days calculation successful { countedDays: 22, workDays: 22, scheduleId: 1 }

      at info (src/modules/leaves/services/leaveCalculator.ts:345:16)

    console.info
      Starting leave counted days calculation... {
        startDate: '01/08/2024',
        endDate: '06/08/2024',
        scheduleId: 1,
        isHalfDay: false,
        halfDayPeriod: undefined,
        options: undefined
      }

      at info (src/modules/leaves/services/leaveCalculator.ts:140:16)
          at async Promise.all (index 0)

    console.info
      Starting leave counted days calculation... {
        startDate: '02/08/2024',
        endDate: '07/08/2024',
        scheduleId: 1,
        isHalfDay: false,
        halfDayPeriod: undefined,
        options: undefined
      }

      at info (src/modules/leaves/services/leaveCalculator.ts:140:16)
          at async Promise.all (index 1)

    console.info
      Starting leave counted days calculation... {
        startDate: '03/08/2024',
        endDate: '08/08/2024',
        scheduleId: 1,
        isHalfDay: false,
        halfDayPeriod: undefined,
        options: undefined
      }

      at info (src/modules/leaves/services/leaveCalculator.ts:140:16)
          at async Promise.all (index 2)

    console.info
      Starting leave counted days calculation... {
        startDate: '04/08/2024',
        endDate: '09/08/2024',
        scheduleId: 1,
        isHalfDay: false,
        halfDayPeriod: undefined,
        options: undefined
      }

      at info (src/modules/leaves/services/leaveCalculator.ts:140:16)
          at async Promise.all (index 3)

    console.info
      Starting leave counted days calculation... {
        startDate: '05/08/2024',
        endDate: '10/08/2024',
        scheduleId: 1,
        isHalfDay: false,
        halfDayPeriod: undefined,
        options: undefined
      }

      at info (src/modules/leaves/services/leaveCalculator.ts:140:16)
          at async Promise.all (index 4)

    console.info
      Fetched 0 public holidays for the period.

      at info (src/modules/leaves/services/leaveCalculator.ts:179:16)
          at async Promise.all (index 0)

    console.info
      Leave counted days calculation successful { countedDays: 4, workDays: 4, scheduleId: 1 }

      at info (src/modules/leaves/services/leaveCalculator.ts:345:16)
          at async Promise.all (index 0)

    console.info
      Fetched 0 public holidays for the period.

      at info (src/modules/leaves/services/leaveCalculator.ts:179:16)
          at async Promise.all (index 1)

    console.info
      Leave counted days calculation successful { countedDays: 4, workDays: 4, scheduleId: 1 }

      at info (src/modules/leaves/services/leaveCalculator.ts:345:16)
          at async Promise.all (index 1)

    console.info
      Fetched 0 public holidays for the period.

      at info (src/modules/leaves/services/leaveCalculator.ts:179:16)
          at async Promise.all (index 2)

    console.info
      Leave counted days calculation successful { countedDays: 4, workDays: 4, scheduleId: 1 }

      at info (src/modules/leaves/services/leaveCalculator.ts:345:16)
          at async Promise.all (index 2)

    console.info
      Fetched 0 public holidays for the period.

      at info (src/modules/leaves/services/leaveCalculator.ts:179:16)
          at async Promise.all (index 3)

    console.info
      Leave counted days calculation successful { countedDays: 5, workDays: 5, scheduleId: 1 }

      at info (src/modules/leaves/services/leaveCalculator.ts:345:16)
          at async Promise.all (index 3)

    console.info
      Fetched 0 public holidays for the period.

      at info (src/modules/leaves/services/leaveCalculator.ts:179:16)
          at async Promise.all (index 4)

    console.info
      Leave counted days calculation successful { countedDays: 5, workDays: 5, scheduleId: 1 }

      at info (src/modules/leaves/services/leaveCalculator.ts:345:16)
          at async Promise.all (index 4)

    console.info
      Starting leave counted days calculation... {
        startDate: '05/08/2024',
        endDate: '09/08/2024',
        scheduleId: 1,
        isHalfDay: false,
        halfDayPeriod: undefined,
        options: undefined
      }

      at info (src/modules/leaves/services/leaveCalculator.ts:140:16)

    console.error
      Erreur lors du calcul des jours de congés: Service indisponible {
        startDate: 2024-08-05T00:00:00.000Z,
        endDate: 2024-08-09T00:00:00.000Z,
        scheduleId: 1,
        options: undefined,
        stack: 'Error: Service indisponible\n' +
          '    at Object.<anonymous> (/Users/vincentperreard/Mathildanesth/src/modules/leaves/services/__tests__/leaveCalculator.comprehensive.test.ts:294:17)\n' +
          '    at Promise.then.completed (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/utils.js:298:28)\n' +
          '    at new Promise (<anonymous>)\n' +
          '    at callAsyncCircusFn (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/utils.js:231:10)\n' +
          '    at _callCircusTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:316:40)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at _runTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:252:3)\n' +
          '    at _runTestsForDescribeBlock (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:126:9)\n' +
          '    at _runTestsForDescribeBlock (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:121:9)\n' +
          '    at _runTestsForDescribeBlock (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:121:9)\n' +
          '    at run (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:71:3)\n' +
          '    at runAndTransformResultsToJestFormat (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n' +
          '    at jestAdapter (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:74:19)\n' +
          '    at runTestInternal (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/runTest.js:367:16)\n' +
          '    at runTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/runTest.js:444:34)\n' +
          '    at Object.worker (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/testWorker.js:106:12)'
      }

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at Object.originalConsoleError [as error] (jest.setup.js:101:3)
      at error (src/modules/leaves/services/leaveCalculator.ts:349:16)
      at Object.<anonymous> (src/modules/leaves/services/__tests__/leaveCalculator.comprehensive.test.ts:298:28)

    console.warn
      Invalid dates provided to calculateLeaveCountedDays {
        startDateInput: Invalid Date,
        endDateInput: 2024-08-05T00:00:00.000Z
      }

      111 |
      112 |         if (!startDate || !endDate) {
    > 113 |             logger.warn('Invalid dates provided to calculateLeaveCountedDays', { startDateInput, endDateInput });
          |                    ^
      114 |             return null;
      115 |         }
      116 |

      at warn (src/modules/leaves/services/leaveCalculator.ts:113:20)
      at Object.<anonymous> (src/modules/leaves/services/__tests__/leaveCalculator.comprehensive.test.ts:308:29)

    console.warn
      Invalid dates provided to calculateLeaveCountedDays {
        startDateInput: 2024-08-05T00:00:00.000Z,
        endDateInput: Invalid Date
      }

      111 |
      112 |         if (!startDate || !endDate) {
    > 113 |             logger.warn('Invalid dates provided to calculateLeaveCountedDays', { startDateInput, endDateInput });
          |                    ^
      114 |             return null;
      115 |         }
      116 |

      at warn (src/modules/leaves/services/leaveCalculator.ts:113:20)
      at Object.<anonymous> (src/modules/leaves/services/__tests__/leaveCalculator.comprehensive.test.ts:309:29)

    console.info
      Calculating working days... { startDate: '05/08/2024', endDate: '09/08/2024', options: undefined }

      at info (src/modules/leaves/services/leaveCalculator.ts:389:16)

    console.info
      Fetched 0 public holidays for working days calculation.

      at info (src/modules/leaves/services/leaveCalculator.ts:398:16)

    console.info
      Working days calculated: 5

      at info (src/modules/leaves/services/leaveCalculator.ts:433:16)

    console.info
      Checking if 05/08/2024 is a business day...

      at info (src/modules/leaves/services/leaveCalculator.ts:469:16)

    console.info
      Result for 05/08/2024: isWeekend=false, isHoliday=false

      at info (src/modules/leaves/services/leaveCalculator.ts:471:16)

    console.info
      Checking if 15/08/2024 is a business day...

      at info (src/modules/leaves/services/leaveCalculator.ts:469:16)

    console.info
      Result for 15/08/2024: isWeekend=false, isHoliday=true

      at info (src/modules/leaves/services/leaveCalculator.ts:471:16)

    console.info
      Starting leave counted days calculation... {
        startDate: '05/08/2024',
        endDate: '09/08/2024',
        scheduleId: 1,
        isHalfDay: false,
        halfDayPeriod: undefined,
        options: undefined
      }

      at info (src/modules/leaves/services/leaveCalculator.ts:140:16)

    console.info
      Fetched 0 public holidays for the period.

      at info (src/modules/leaves/services/leaveCalculator.ts:179:16)

    console.info
      Leave counted days calculation successful { countedDays: 5, workDays: 5, scheduleId: 1 }

      at info (src/modules/leaves/services/leaveCalculator.ts:345:16)

    console.info
      Starting leave counted days calculation... {
        startDate: '05/08/2024',
        endDate: '09/08/2024',
        scheduleId: 1,
        isHalfDay: false,
        halfDayPeriod: undefined,
        options: undefined
      }

      at info (src/modules/leaves/services/leaveCalculator.ts:140:16)

    console.info
      Fetched 0 public holidays for the period.

      at info (src/modules/leaves/services/leaveCalculator.ts:179:16)

    console.info
      Leave counted days calculation successful { countedDays: 5, workDays: 5, scheduleId: 1 }

      at info (src/modules/leaves/services/leaveCalculator.ts:345:16)

    console.info
      Starting leave counted days calculation... {
        startDate: '05/08/2024',
        endDate: '09/08/2024',
        scheduleId: 1,
        isHalfDay: false,
        halfDayPeriod: undefined,
        options: undefined
      }

      at info (src/modules/leaves/services/leaveCalculator.ts:140:16)

    console.info
      Fetched 0 public holidays for the period.

      at info (src/modules/leaves/services/leaveCalculator.ts:179:16)

    console.info
      Leave counted days calculation successful { countedDays: 5, workDays: 5, scheduleId: 1 }

      at info (src/modules/leaves/services/leaveCalculator.ts:345:16)

  ● LeaveCalculator - Tests Complets › Gestion des erreurs › should handle PublicHolidayService errors gracefully

    expect(received).not.toBeNull()

    Received: null

      298 |             const result = await calculateLeaveCountedDays(startDate, endDate, standardSchedule);
      299 |
    > 300 |             expect(result).not.toBeNull();
          |                                ^
      301 |             expect(result!.countedDays).toBe(5); // Fallback sans jours fériés
      302 |         });
      303 |

      at Object.<anonymous> (src/modules/leaves/services/__tests__/leaveCalculator.comprehensive.test.ts:300:32)


  ●  Cannot log after tests are done. Did you forget to wait for something async in your test?
    Attempted to log "[PublicHolidayService] Impossible de récupérer les jours fériés depuis l'API pour l'année 2025. Utilisation du calcul local.".



      at console.warn (node_modules/@jest/console/build/BufferedConsole.js:191:10)
      at PublicHolidayService.getPublicHolidaysForYear (src/modules/leaves/services/publicHolidayService.ts:7441:15)
          at async Promise.all (index 1)
      at PublicHolidayService.preloadData (src/modules/leaves/services/publicHolidayService.ts:7072:7)


  ●  Cannot log after tests are done. Did you forget to wait for something async in your test?
    Attempted to log "[PublicHolidayService] Impossible de récupérer les jours fériés depuis l'API pour l'année 2027. Utilisation du calcul local.".



      at console.warn (node_modules/@jest/console/build/BufferedConsole.js:191:10)
      at PublicHolidayService.getPublicHolidaysForYear (src/modules/leaves/services/publicHolidayService.ts:7441:15)
          at async Promise.all (index 3)
      at PublicHolidayService.preloadData (src/modules/leaves/services/publicHolidayService.ts:7072:7)

FAIL src/modules/leaves/services/leaveCalculator.test.ts
  ● Console

    console.log
      jest.polyfills.js loaded and applied.

      at Object.<anonymous> (jest.polyfills.js:247:9)

    console.log
      jest.setup.js loaded and mocks applied.

      at Object.log (jest.setup.js:126:9)

  ● leaveCalculator › calculateLeaveCountedDays › devrait calculer correctement les jours pour une période standard

    expect(received).toBe(expected) // Object.is equality

    Expected: 5
    Received: 0

      48 |
      49 |             expect(result).not.toBeNull();
    > 50 |             expect(result?.countedDays).toBe(5);
         |                                         ^
      51 |             expect(result?.naturalDays).toBe(5);
      52 |             expect(result?.halfDays).toBe(0);
      53 |         });

      at Object.<anonymous> (src/modules/leaves/services/leaveCalculator.test.ts:50:41)

  ● leaveCalculator › calculateLeaveCountedDays › devrait calculer correctement une demi-journée du matin

    expect(received).toBe(expected) // Object.is equality

    Expected: 0.5
    Received: 0

      63 |
      64 |             expect(result).not.toBeNull();
    > 65 |             expect(result?.countedDays).toBe(0.5);
         |                                         ^
      66 |             expect(result?.naturalDays).toBe(1);
      67 |             expect(result?.halfDays).toBe(1);
      68 |         });

      at Object.<anonymous> (src/modules/leaves/services/leaveCalculator.test.ts:65:41)

  ● leaveCalculator › calculateLeaveCountedDays › devrait calculer correctement une demi-journée de l'après-midi

    expect(received).toBe(expected) // Object.is equality

    Expected: 0.5
    Received: 0

      78 |
      79 |             expect(result).not.toBeNull();
    > 80 |             expect(result?.countedDays).toBe(0.5);
         |                                         ^
      81 |             expect(result?.naturalDays).toBe(1);
      82 |             expect(result?.halfDays).toBe(1);
      83 |         });

      at Object.<anonymous> (src/modules/leaves/services/leaveCalculator.test.ts:80:41)

  ● leaveCalculator › calculateLeaveCountedDays › devrait ignorer isHalfDay si startDate et endDate sont différents

    expect(received).toBe(expected) // Object.is equality

    Expected: 2
    Received: 0

      94 |
      95 |             expect(result).not.toBeNull();
    > 96 |             expect(result?.countedDays).toBe(2); // Devrait compter 2 jours complets
         |                                         ^
      97 |             expect(result?.naturalDays).toBe(2);
      98 |             expect(result?.halfDays).toBe(0);
      99 |         });

      at Object.<anonymous> (src/modules/leaves/services/leaveCalculator.test.ts:96:41)

  ● leaveCalculator › calculateLeaveCountedDays › devrait prendre en compte les jours fériés

    expect(received).toBe(expected) // Object.is equality

    Expected: 4
    Received: 0

      115 |
      116 |             expect(result).not.toBeNull();
    > 117 |             expect(result?.countedDays).toBe(4); // 5 jours - 1 jour férié
          |                                         ^
      118 |             expect(result?.naturalDays).toBe(5);
      119 |         });
      120 |

      at Object.<anonymous> (src/modules/leaves/services/leaveCalculator.test.ts:117:41)


  ●  Cannot log after tests are done. Did you forget to wait for something async in your test?
    Attempted to log "Erreur lors du chargement des permissions personnalisées: FetchError {
      message: 'request to http://localhost/api/leaves/permissions failed, reason: ',
      type: 'system',
      errno: 'ECONNREFUSED',
      code: 'ECONNREFUSED'
    }".

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.error (node_modules/@jest/console/build/BufferedConsole.js:127:10)
      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at LeavePermissionService.error [as loadCustomPermissions] (src/modules/leaves/permissions/LeavePermissionService.ts:474:21)

FAIL src/modules/leaves/permissions/__tests__/LeavePermissionService.test.ts
  ● Console

    console.log
      jest.polyfills.js loaded and applied.

      at Object.<anonymous> (jest.polyfills.js:247:9)

    console.log
      jest.setup.js loaded and mocks applied.

      at Object.log (jest.setup.js:126:9)

    console.debug
      [EventBusProfiler] Initialized

      at new debug (src/modules/integration/services/EventBusProfiler.ts:77:17)

    console.error
      Erreur lors du chargement des permissions personnalisées: TypeError: Only absolute URLs are supported
          at getNodeRequestOptions (/Users/vincentperreard/Mathildanesth/node_modules/node-fetch/lib/index.js:1327:9)
          at getNodeRequestOptions (/Users/vincentperreard/Mathildanesth/node_modules/node-fetch/lib/index.js:1450:19)
          at new Promise (<anonymous>)
          at fetch (/Users/vincentperreard/Mathildanesth/node_modules/node-fetch/lib/index.js:1447:9)
          at call (/Users/vincentperreard/Mathildanesth/node_modules/cross-fetch/dist/node-ponyfill.js:10:20)
          at LeavePermissionService.fetch [as loadCustomPermissions] (/Users/vincentperreard/Mathildanesth/src/modules/leaves/permissions/LeavePermissionService.ts:450:36)
          at new loadCustomPermissions (/Users/vincentperreard/Mathildanesth/src/modules/leaves/permissions/LeavePermissionService.ts:237:14)
          at Function.getInstance (/Users/vincentperreard/Mathildanesth/src/modules/leaves/permissions/LeavePermissionService.ts:201:47)
          at Object.getInstance (/Users/vincentperreard/Mathildanesth/src/modules/leaves/permissions/LeavePermissionService.ts:1049:62)
          at Runtime._execModule (/Users/vincentperreard/Mathildanesth/node_modules/jest-runtime/build/index.js:1439:24)
          at Runtime._loadModule (/Users/vincentperreard/Mathildanesth/node_modules/jest-runtime/build/index.js:1022:12)
          at Runtime.requireModule (/Users/vincentperreard/Mathildanesth/node_modules/jest-runtime/build/index.js:882:12)
          at Runtime.requireModuleOrMock (/Users/vincentperreard/Mathildanesth/node_modules/jest-runtime/build/index.js:1048:21)
          at Object.<anonymous> (/Users/vincentperreard/Mathildanesth/src/modules/leaves/permissions/__tests__/LeavePermissionService.test.ts:1:1)
          at Runtime._execModule (/Users/vincentperreard/Mathildanesth/node_modules/jest-runtime/build/index.js:1439:24)
          at Runtime._loadModule (/Users/vincentperreard/Mathildanesth/node_modules/jest-runtime/build/index.js:1022:12)
          at Runtime.requireModule (/Users/vincentperreard/Mathildanesth/node_modules/jest-runtime/build/index.js:882:12)
          at jestAdapter (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:72:13)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at runTestInternal (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/runTest.js:367:16)
          at runTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/runTest.js:444:34)
          at Object.worker (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/testWorker.js:106:12)

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at LeavePermissionService.error [as loadCustomPermissions] (src/modules/leaves/permissions/LeavePermissionService.ts:474:21)

    console.warn
      [MSW] Warning: intercepted a request without a matching request handler:
      
        • GET /api/leaves/permissions
      
      If you still wish to intercept this unhandled request, please create a request handler for it.
      Read more: https://mswjs.io/docs/getting-started/mocks

      448 |
      449 |         try {
    > 450 |             const response = await fetch('/api/leaves/permissions');
          |                              ^
      451 |             if (!response.ok) {
      452 |                 throw new Error(`Erreur lors du chargement des permissions: ${response.statusText}`);
      453 |             }

      at Object.warn (node_modules/msw/src/core/utils/internal/devUtils.ts:18:11)
      at warn (node_modules/msw/src/core/utils/request/onUnhandledRequest.ts:50:18)
      at applyStrategy (node_modules/msw/src/core/utils/request/onUnhandledRequest.ts:79:5)
      at handleRequest (node_modules/msw/src/core/utils/handleRequest.ts:79:11)
      at _Emitter.<anonymous> (node_modules/msw/src/node/SetupServerCommonApi.ts:60:26)
      at emitAsync (node_modules/@mswjs/interceptors/src/utils/emitAsync.ts:23:5)
      at node_modules/@mswjs/interceptors/src/utils/handleRequest.ts:125:5
      at until (node_modules/@open-draft/until/src/until.ts:23:18)
      at handleRequest (node_modules/@mswjs/interceptors/src/utils/handleRequest.ts:114:18)
      at globalThis.fetch (node_modules/@mswjs/interceptors/src/interceptors/fetch/index.ts:63:32)
      at LeavePermissionService.loadCustomPermissions (src/modules/leaves/permissions/LeavePermissionService.ts:450:30)

    console.error
      Erreur lors du chargement des permissions personnalisées: TypeError: Cannot read properties of undefined (reading 'ok')
          at LeavePermissionService.ok (/Users/vincentperreard/Mathildanesth/src/modules/leaves/permissions/LeavePermissionService.ts:451:27)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at LeavePermissionService.error (src/modules/leaves/permissions/LeavePermissionService.ts:474:21)

    console.error
      Erreur lors du chargement des permissions personnalisées: TypeError: Cannot read properties of undefined (reading 'ok')
          at LeavePermissionService.ok (/Users/vincentperreard/Mathildanesth/src/modules/leaves/permissions/LeavePermissionService.ts:451:27)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at LeavePermissionService.error (src/modules/leaves/permissions/LeavePermissionService.ts:474:21)

    console.error
      Erreur lors du chargement des permissions personnalisées: TypeError: Cannot read properties of undefined (reading 'ok')
          at LeavePermissionService.ok (/Users/vincentperreard/Mathildanesth/src/modules/leaves/permissions/LeavePermissionService.ts:451:27)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at LeavePermissionService.error (src/modules/leaves/permissions/LeavePermissionService.ts:474:21)

    console.error
      Erreur lors du chargement des permissions personnalisées: TypeError: Cannot read properties of undefined (reading 'ok')
          at LeavePermissionService.ok (/Users/vincentperreard/Mathildanesth/src/modules/leaves/permissions/LeavePermissionService.ts:451:27)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at LeavePermissionService.error (src/modules/leaves/permissions/LeavePermissionService.ts:474:21)

    console.error
      Erreur lors du chargement des permissions personnalisées: TypeError: Cannot read properties of undefined (reading 'ok')
          at LeavePermissionService.ok (/Users/vincentperreard/Mathildanesth/src/modules/leaves/permissions/LeavePermissionService.ts:451:27)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at LeavePermissionService.error (src/modules/leaves/permissions/LeavePermissionService.ts:474:21)

    console.error
      Erreur lors du chargement des permissions personnalisées: TypeError: Cannot read properties of undefined (reading 'ok')
          at LeavePermissionService.ok (/Users/vincentperreard/Mathildanesth/src/modules/leaves/permissions/LeavePermissionService.ts:451:27)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at LeavePermissionService.error (src/modules/leaves/permissions/LeavePermissionService.ts:474:21)

    console.error
      Erreur lors du chargement des permissions personnalisées: TypeError: Cannot read properties of undefined (reading 'ok')
          at LeavePermissionService.ok (/Users/vincentperreard/Mathildanesth/src/modules/leaves/permissions/LeavePermissionService.ts:451:27)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at LeavePermissionService.error (src/modules/leaves/permissions/LeavePermissionService.ts:474:21)

    console.error
      Erreur lors du chargement des permissions personnalisées: TypeError: Cannot read properties of undefined (reading 'ok')
          at LeavePermissionService.ok (/Users/vincentperreard/Mathildanesth/src/modules/leaves/permissions/LeavePermissionService.ts:451:27)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at LeavePermissionService.error (src/modules/leaves/permissions/LeavePermissionService.ts:474:21)

    console.error
      Erreur lors du chargement des permissions personnalisées: TypeError: Cannot read properties of undefined (reading 'ok')
          at LeavePermissionService.ok (/Users/vincentperreard/Mathildanesth/src/modules/leaves/permissions/LeavePermissionService.ts:451:27)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at LeavePermissionService.error (src/modules/leaves/permissions/LeavePermissionService.ts:474:21)

    console.error
      Erreur lors du chargement des permissions personnalisées: TypeError: Cannot read properties of undefined (reading 'ok')
          at LeavePermissionService.ok (/Users/vincentperreard/Mathildanesth/src/modules/leaves/permissions/LeavePermissionService.ts:451:27)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at LeavePermissionService.error (src/modules/leaves/permissions/LeavePermissionService.ts:474:21)

    console.log
      [DEBUG] grantPermission called for user: test-user, permission: leaves.reports.view

      at LeavePermissionService.log [as grantPermission] (src/modules/leaves/permissions/LeavePermissionService.ts:750:17)

    console.log
      [DEBUG] grantPermission: Current user performing action: id=employee-123, role=UTILISATEUR

      at LeavePermissionService.log [as grantPermission] (src/modules/leaves/permissions/LeavePermissionService.ts:756:17)

    console.log
      [DEBUG] grantPermission: hasAuth (MANAGE_LEAVE_RULES) for employee-123: false

      at LeavePermissionService.log [as grantPermission] (src/modules/leaves/permissions/LeavePermissionService.ts:759:17)

    console.error
      [DEBUG] grantPermission: User employee-123 does not have permission to MANAGE_LEAVE_RULES.

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at LeavePermissionService.error [as grantPermission] (src/modules/leaves/permissions/LeavePermissionService.ts:761:21)
      at Object.<anonymous> (src/modules/leaves/permissions/__tests__/LeavePermissionService.test.ts:343:28)

    console.error
      Erreur lors du chargement des permissions personnalisées: TypeError: Cannot read properties of undefined (reading 'ok')
          at LeavePermissionService.ok (/Users/vincentperreard/Mathildanesth/src/modules/leaves/permissions/LeavePermissionService.ts:451:27)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at LeavePermissionService.error (src/modules/leaves/permissions/LeavePermissionService.ts:474:21)

    console.log
      [DEBUG] grantPermission called for user: test-user, permission: leaves.reports.view

      at LeavePermissionService.log [as grantPermission] (src/modules/leaves/permissions/LeavePermissionService.ts:750:17)

    console.log
      [DEBUG] grantPermission: Current user performing action: id=manager-456, role=MANAGER

      at LeavePermissionService.log [as grantPermission] (src/modules/leaves/permissions/LeavePermissionService.ts:756:17)

    console.log
      [DEBUG] grantPermission: hasAuth (MANAGE_LEAVE_RULES) for manager-456: true

      at LeavePermissionService.log [as grantPermission] (src/modules/leaves/permissions/LeavePermissionService.ts:759:17)

    console.log
      [DEBUG] saveCustomPermissions called for user: test-user, permissions: {"userId":"test-user","grantedPermissions":["leaves.reports.view"],"deniedPermissions":[]}

      at LeavePermissionService.log [as saveCustomPermissions] (src/modules/leaves/permissions/LeavePermissionService.ts:865:17)

    console.warn
      Tentative de sauvegarde des permissions personnalisées avant leur chargement complet.

      865 |         console.log(`[DEBUG] saveCustomPermissions called for user: ${userId}, permissions:`, JSON.stringify(permissions));
      866 |         if (!this.permissionsLoaded) {
    > 867 |             console.warn("Tentative de sauvegarde des permissions personnalisées avant leur chargement complet.");
          |                     ^
      868 |         }
      869 |         try {
      870 |             const response = await fetch(`/api/leaves/permissions/${userId}/custom`, {

      at LeavePermissionService.warn [as saveCustomPermissions] (src/modules/leaves/permissions/LeavePermissionService.ts:867:21)
      at LeavePermissionService.saveCustomPermissions [as grantPermission] (src/modules/leaves/permissions/LeavePermissionService.ts:787:40)
      at Object.<anonymous> (src/modules/leaves/permissions/__tests__/LeavePermissionService.test.ts:380:28)

    console.log
      [DEBUG] saveCustomPermissions fetch response for test-user: status=500, ok=false

      at LeavePermissionService.log [as saveCustomPermissions] (src/modules/leaves/permissions/LeavePermissionService.ts:878:21)

    console.error
      Erreur réseau ou autre lors de la sauvegarde des permissions pour test-user: TypeError: response.text is not a function
          at LeavePermissionService.text [as saveCustomPermissions] (/Users/vincentperreard/Mathildanesth/src/modules/leaves/permissions/LeavePermissionService.ts:881:50)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at LeavePermissionService.grantPermission (/Users/vincentperreard/Mathildanesth/src/modules/leaves/permissions/LeavePermissionService.ts:787:29)
          at Object.<anonymous> (/Users/vincentperreard/Mathildanesth/src/modules/leaves/permissions/__tests__/LeavePermissionService.test.ts:380:28)

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at LeavePermissionService.error [as saveCustomPermissions] (src/modules/leaves/permissions/LeavePermissionService.ts:891:21)
      at LeavePermissionService.grantPermission (src/modules/leaves/permissions/LeavePermissionService.ts:787:29)
      at Object.<anonymous> (src/modules/leaves/permissions/__tests__/LeavePermissionService.test.ts:380:28)

    console.error
      Network or other error saving custom permissions for test-user {
        userId: 'test-user',
        error: TypeError: response.text is not a function
            at LeavePermissionService.text [as saveCustomPermissions] (/Users/vincentperreard/Mathildanesth/src/modules/leaves/permissions/LeavePermissionService.ts:881:50)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at LeavePermissionService.grantPermission (/Users/vincentperreard/Mathildanesth/src/modules/leaves/permissions/LeavePermissionService.ts:787:29)
            at Object.<anonymous> (/Users/vincentperreard/Mathildanesth/src/modules/leaves/permissions/__tests__/LeavePermissionService.test.ts:380:28)
      }

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at LeavePermissionService.error [as saveCustomPermissions] (src/modules/leaves/permissions/LeavePermissionService.ts:892:21)
      at LeavePermissionService.grantPermission (src/modules/leaves/permissions/LeavePermissionService.ts:787:29)
      at Object.<anonymous> (src/modules/leaves/permissions/__tests__/LeavePermissionService.test.ts:380:28)

    console.log
      [DEBUG] grantPermission: saveCustomPermissions result for test-user: false

      at LeavePermissionService.log [as grantPermission] (src/modules/leaves/permissions/LeavePermissionService.ts:788:21)

    console.error
      Erreur lors du chargement des permissions personnalisées: TypeError: Cannot read properties of undefined (reading 'ok')
          at LeavePermissionService.ok (/Users/vincentperreard/Mathildanesth/src/modules/leaves/permissions/LeavePermissionService.ts:451:27)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at LeavePermissionService.error (src/modules/leaves/permissions/LeavePermissionService.ts:474:21)

    console.log
      [DEBUG] revokePermission called for user: test-user, permission: leaves.reports.view

      at LeavePermissionService.log [as revokePermission] (src/modules/leaves/permissions/LeavePermissionService.ts:809:17)

    console.error
      User employee-123 does not have permission to MANAGE_LEAVE_RULES.

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at LeavePermissionService.error [as revokePermission] (src/modules/leaves/permissions/LeavePermissionService.ts:818:21)
      at Object.<anonymous> (src/modules/leaves/permissions/__tests__/LeavePermissionService.test.ts:409:28)

    console.error
      Erreur lors du chargement des permissions personnalisées: TypeError: Cannot read properties of undefined (reading 'ok')
          at LeavePermissionService.ok (/Users/vincentperreard/Mathildanesth/src/modules/leaves/permissions/LeavePermissionService.ts:451:27)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at LeavePermissionService.error (src/modules/leaves/permissions/LeavePermissionService.ts:474:21)

    console.log
      [DEBUG] revokePermission called for user: test-user, permission: leaves.reports.view

      at LeavePermissionService.log [as revokePermission] (src/modules/leaves/permissions/LeavePermissionService.ts:809:17)

    console.log
      [DEBUG] saveCustomPermissions called for user: test-user, permissions: {"userId":"test-user","grantedPermissions":[],"deniedPermissions":["leaves.reports.view"]}

      at LeavePermissionService.log [as saveCustomPermissions] (src/modules/leaves/permissions/LeavePermissionService.ts:865:17)

    console.warn
      Tentative de sauvegarde des permissions personnalisées avant leur chargement complet.

      865 |         console.log(`[DEBUG] saveCustomPermissions called for user: ${userId}, permissions:`, JSON.stringify(permissions));
      866 |         if (!this.permissionsLoaded) {
    > 867 |             console.warn("Tentative de sauvegarde des permissions personnalisées avant leur chargement complet.");
          |                     ^
      868 |         }
      869 |         try {
      870 |             const response = await fetch(`/api/leaves/permissions/${userId}/custom`, {

      at LeavePermissionService.warn [as saveCustomPermissions] (src/modules/leaves/permissions/LeavePermissionService.ts:867:21)
      at LeavePermissionService.saveCustomPermissions [as revokePermission] (src/modules/leaves/permissions/LeavePermissionService.ts:843:40)
      at Object.<anonymous> (src/modules/leaves/permissions/__tests__/LeavePermissionService.test.ts:442:28)

    console.log
      [DEBUG] saveCustomPermissions fetch response for test-user: status=500, ok=false

      at LeavePermissionService.log [as saveCustomPermissions] (src/modules/leaves/permissions/LeavePermissionService.ts:878:21)

    console.error
      Erreur réseau ou autre lors de la sauvegarde des permissions pour test-user: TypeError: response.text is not a function
          at LeavePermissionService.text [as saveCustomPermissions] (/Users/vincentperreard/Mathildanesth/src/modules/leaves/permissions/LeavePermissionService.ts:881:50)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at LeavePermissionService.revokePermission (/Users/vincentperreard/Mathildanesth/src/modules/leaves/permissions/LeavePermissionService.ts:843:29)
          at Object.<anonymous> (/Users/vincentperreard/Mathildanesth/src/modules/leaves/permissions/__tests__/LeavePermissionService.test.ts:442:28)

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at LeavePermissionService.error [as saveCustomPermissions] (src/modules/leaves/permissions/LeavePermissionService.ts:891:21)
      at LeavePermissionService.revokePermission (src/modules/leaves/permissions/LeavePermissionService.ts:843:29)
      at Object.<anonymous> (src/modules/leaves/permissions/__tests__/LeavePermissionService.test.ts:442:28)

    console.error
      Network or other error saving custom permissions for test-user {
        userId: 'test-user',
        error: TypeError: response.text is not a function
            at LeavePermissionService.text [as saveCustomPermissions] (/Users/vincentperreard/Mathildanesth/src/modules/leaves/permissions/LeavePermissionService.ts:881:50)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at LeavePermissionService.revokePermission (/Users/vincentperreard/Mathildanesth/src/modules/leaves/permissions/LeavePermissionService.ts:843:29)
            at Object.<anonymous> (/Users/vincentperreard/Mathildanesth/src/modules/leaves/permissions/__tests__/LeavePermissionService.test.ts:442:28)
      }

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at LeavePermissionService.error [as saveCustomPermissions] (src/modules/leaves/permissions/LeavePermissionService.ts:892:21)
      at LeavePermissionService.revokePermission (src/modules/leaves/permissions/LeavePermissionService.ts:843:29)
      at Object.<anonymous> (src/modules/leaves/permissions/__tests__/LeavePermissionService.test.ts:442:28)

    console.log
      [DEBUG] revokePermission: saveCustomPermissions result for test-user: false

      at LeavePermissionService.log [as revokePermission] (src/modules/leaves/permissions/LeavePermissionService.ts:844:21)

    console.error
      Erreur lors du chargement des permissions personnalisées: TypeError: Cannot read properties of undefined (reading 'ok')
          at LeavePermissionService.ok (/Users/vincentperreard/Mathildanesth/src/modules/leaves/permissions/LeavePermissionService.ts:451:27)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at LeavePermissionService.error (src/modules/leaves/permissions/LeavePermissionService.ts:474:21)

    console.error
      Erreur lors du chargement des permissions personnalisées: TypeError: Cannot read properties of undefined (reading 'ok')
          at LeavePermissionService.ok (/Users/vincentperreard/Mathildanesth/src/modules/leaves/permissions/LeavePermissionService.ts:451:27)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at LeavePermissionService.error (src/modules/leaves/permissions/LeavePermissionService.ts:474:21)

    console.error
      Erreur lors de la récupération des permissions pour l'utilisateur test-user: Error: Erreur lors de la récupération de l'utilisateur: undefined
          at LeavePermissionService.getUserPermissions (/Users/vincentperreard/Mathildanesth/src/modules/leaves/permissions/LeavePermissionService.ts:916:23)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at Object.<anonymous> (/Users/vincentperreard/Mathildanesth/src/modules/leaves/permissions/__tests__/LeavePermissionService.test.ts:488:33)

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at LeavePermissionService.error [as getUserPermissions] (src/modules/leaves/permissions/LeavePermissionService.ts:947:21)
      at Object.<anonymous> (src/modules/leaves/permissions/__tests__/LeavePermissionService.test.ts:488:33)

    console.error
      Erreur lors du chargement des permissions personnalisées: TypeError: Cannot read properties of undefined (reading 'ok')
          at LeavePermissionService.ok (/Users/vincentperreard/Mathildanesth/src/modules/leaves/permissions/LeavePermissionService.ts:451:27)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at LeavePermissionService.error (src/modules/leaves/permissions/LeavePermissionService.ts:474:21)

    console.error
      Erreur lors du chargement des permissions personnalisées: TypeError: Cannot read properties of undefined (reading 'ok')
          at LeavePermissionService.ok (/Users/vincentperreard/Mathildanesth/src/modules/leaves/permissions/LeavePermissionService.ts:451:27)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at LeavePermissionService.error (src/modules/leaves/permissions/LeavePermissionService.ts:474:21)

    console.error
      Erreur lors de la réinitialisation des permissions pour l'utilisateur test-user: Error: Erreur lors de la réinitialisation des permissions: undefined
          at LeavePermissionService.resetUserPermissions (/Users/vincentperreard/Mathildanesth/src/modules/leaves/permissions/LeavePermissionService.ts:988:23)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at Object.<anonymous> (/Users/vincentperreard/Mathildanesth/src/modules/leaves/permissions/__tests__/LeavePermissionService.test.ts:551:28)

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at LeavePermissionService.error [as resetUserPermissions] (src/modules/leaves/permissions/LeavePermissionService.ts:1007:21)
      at Object.<anonymous> (src/modules/leaves/permissions/__tests__/LeavePermissionService.test.ts:551:28)

  ● LeavePermissionService › grantPermission › devrait accorder une permission à un utilisateur

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      344 |
      345 |             // Assert
    > 346 |             expect(result).toBe(true);
          |                            ^
      347 |             expect(mockFetch).toHaveBeenCalledWith(
      348 |                 `/api/leaves/permissions/${userId}/grant`,
      349 |                 expect.objectContaining({

      at Object.<anonymous> (src/modules/leaves/permissions/__tests__/LeavePermissionService.test.ts:346:28)

  ● LeavePermissionService › grantPermission › devrait retourner false si l'API échoue

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: Anything, StringContaining "Échoué (API: 500)", Anything, ObjectContaining {"granterId": "manager-456", "permission": "leaves.reports.view", "userId": "test-user"}

    Number of calls: 0

      383 |             expect(result).toBe(false);
      384 |             expect(mockFetch).toHaveBeenCalledTimes(1);
    > 385 |             expect(mockAuditServiceInstance.logPermissionChange).toHaveBeenCalledWith(
          |                                                                  ^
      386 |                 expect.anything(), // AuditActionType.PERMISSION_GRANT_FAILED - utiliser expect.anything() pour l'instant
      387 |                 expect.stringContaining('Échoué (API: 500)'),
      388 |                 expect.anything(), // AuditSeverity.ERROR - utiliser expect.anything() pour l'instant

      at Object.<anonymous> (src/modules/leaves/permissions/__tests__/LeavePermissionService.test.ts:385:66)

  ● LeavePermissionService › revokePermission › devrait révoquer une permission d'un utilisateur

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      410 |
      411 |             // Assert
    > 412 |             expect(result).toBe(true);
          |                            ^
      413 |             expect(mockFetch).toHaveBeenCalledWith(
      414 |                 `/api/leaves/permissions/${userId}/revoke`,
      415 |                 expect.objectContaining({

      at Object.<anonymous> (src/modules/leaves/permissions/__tests__/LeavePermissionService.test.ts:412:28)

  ● LeavePermissionService › revokePermission › devrait retourner false si l'API échoue

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: Anything, StringContaining "Échoué (API: 500)", Anything, ObjectContaining {"granterId": "manager-456", "permission": "leaves.reports.view", "userId": "test-user"}

    Number of calls: 0

      445 |             expect(result).toBe(false);
      446 |             expect(mockFetch).toHaveBeenCalledTimes(1);
    > 447 |             expect(mockAuditServiceInstance.logPermissionChange).toHaveBeenCalledWith(
          |                                                                  ^
      448 |                 expect.anything(),
      449 |                 expect.stringContaining('Échoué (API: 500)'),
      450 |                 expect.anything(),

      at Object.<anonymous> (src/modules/leaves/permissions/__tests__/LeavePermissionService.test.ts:447:66)

  ● LeavePermissionService › getUserPermissions › devrait retourner toutes les permissions d'un utilisateur

    expect(received).toEqual(expected) // deep equality

    - Expected  - 4
    + Received  + 1

    - Array [
    -   "leaves.reports.view",
    -   "leaves.request",
    - ]
    + Array []

      471 |             // Assert
      472 |             expect(mockFetch).toHaveBeenCalledWith(`/api/users/${userId}`);
    > 473 |             expect(permissions).toEqual(mockPermissions);
          |                                 ^
      474 |         });
      475 |
      476 |         it('devrait retourner un tableau vide si l\'API échoue', async () => {

      at Object.<anonymous> (src/modules/leaves/permissions/__tests__/LeavePermissionService.test.ts:473:33)

  ● LeavePermissionService › resetUserPermissions › devrait réinitialiser les permissions personnalisées d'un utilisateur

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "/api/leaves/permissions/custom-user-123/reset", ObjectContaining {"method": "POST"}
    Received: "/api/leaves/permissions/custom-user-123", {"method": "DELETE"}

    Number of calls: 1

      533 |             // Assert
      534 |             expect(result).toBe(true);
    > 535 |             expect(mockFetch).toHaveBeenCalledWith(
          |                               ^
      536 |                 `/api/leaves/permissions/${userId}/reset`,
      537 |                 expect.objectContaining({ method: 'POST' })
      538 |             );

      at Object.<anonymous> (src/modules/leaves/permissions/__tests__/LeavePermissionService.test.ts:535:31)

  ● LeavePermissionService › resetUserPermissions › devrait retourner false si l'API échoue

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: Anything, StringContaining "Échoué (API: 500)", Anything, ObjectContaining {"granterId": "manager-456", "userId": "test-user"}

    Number of calls: 0

      553 |             // Assert
      554 |             expect(result).toBe(false);
    > 555 |             expect(mockAuditServiceInstance.logPermissionChange).toHaveBeenCalledWith(
          |                                                                  ^
      556 |                 expect.anything(), // AuditActionType.PERMISSION_RESET_FAILED
      557 |                 expect.stringContaining('Échoué (API: 500)'),
      558 |                 expect.anything(), // AuditSeverity.ERROR

      at Object.<anonymous> (src/modules/leaves/permissions/__tests__/LeavePermissionService.test.ts:555:66)

(node:80197) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.
(Use `node --trace-deprecation ...` to show where the warning was created)
FAIL src/modules/leaves/services/quotaService.test.ts
  ● Console

    console.log
      jest.polyfills.js loaded and applied.

      at Object.<anonymous> (jest.polyfills.js:247:9)

    console.log
      jest.setup.js loaded and mocks applied.

      at Object.log (jest.setup.js:126:9)

  ● quotaService › simulateQuotaTransfer › calcule correctement un transfert avec ratio personnalisé

    expect(received).toBe(expected) // Object.is equality

    Expected: 2
    Received: 4

      112 |             expect(result.success).toBe(true);
      113 |             expect(result.sourceAmount).toBe(4);
    > 114 |             expect(result.targetAmount).toBe(2);
          |                                         ^
      115 |         });
      116 |
      117 |         it('refuse le transfert si le montant est insuffisant', async () => {

      at Object.<anonymous> (src/modules/leaves/services/quotaService.test.ts:114:41)

FAIL src/modules/leaves/hooks/useLeave.test.ts
  ● Console

    console.log
      jest.polyfills.js loaded and applied.

      at Object.<anonymous> (jest.polyfills.js:247:9)

    console.log
      jest.setup.js loaded and mocks applied.

      at Object.log (jest.setup.js:126:9)

    console.log
      Skipping beforeunload listener setup (not in a browser environment or sendBeacon not supported).

      at log (src/services/errorLoggingService.ts:126:17)

    console.warn
      Accès à prisma depuis le navigateur. Ceci est uniquement pour la référence TypeScript et ne fonctionnera pas.

      74 |     }
      75 |
    > 76 |     console.warn('Accès à prisma depuis le navigateur. Ceci est uniquement pour la référence TypeScript et ne fonctionnera pas.');
         |             ^
      77 | }
      78 |
      79 | export { prismaInstance as prisma }; 

      at Object.warn (src/lib/prisma.ts:76:13)
      at Object.require (src/modules/leaves/services/leaveService.ts:43:1)
      at Object.require (src/modules/leaves/hooks/useLeave.ts:13:1)
      at Object.<anonymous> (src/modules/leaves/hooks/useLeave.test.ts:2:1)

    console.error
      Erreur dans checkAllowance: Error: Allowance check failed
          at Object.<anonymous> (/Users/vincentperreard/Mathildanesth/src/modules/leaves/hooks/useLeave.test.ts:670:31)
          at Promise.then.completed (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/utils.js:231:10)
          at _callCircusTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:316:40)
          at _runTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:252:3)
          at _runTestsForDescribeBlock (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:126:9)
          at _runTestsForDescribeBlock (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:121:9)
          at _runTestsForDescribeBlock (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:121:9)
          at run (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:71:3)
          at runAndTransformResultsToJestFormat (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
          at jestAdapter (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:74:19)
          at runTestInternal (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/runTest.js:367:16)
          at runTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/runTest.js:444:34)
          at Object.worker (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/testWorker.js:106:12)

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at Object.error [as checkAllowance] (src/modules/leaves/hooks/useLeave.ts:226:21)
      at src/modules/leaves/hooks/useLeave.test.ts:680:21

    console.error
      Erreur dans checkAllowance: Error: Allowance check failed
          at Object.<anonymous> (/Users/vincentperreard/Mathildanesth/src/modules/leaves/hooks/useLeave.test.ts:699:17)
          at Promise.then.completed (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/utils.js:231:10)
          at _callCircusTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:316:40)
          at _runTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:252:3)
          at _runTestsForDescribeBlock (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:126:9)
          at _runTestsForDescribeBlock (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:121:9)
          at _runTestsForDescribeBlock (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:121:9)
          at run (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:71:3)
          at runAndTransformResultsToJestFormat (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
          at jestAdapter (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:74:19)
          at runTestInternal (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/runTest.js:367:16)
          at runTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/runTest.js:444:34)
          at Object.worker (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/testWorker.js:106:12)

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at Object.error [as checkAllowance] (src/modules/leaves/hooks/useLeave.ts:226:21)
      at src/modules/leaves/hooks/useLeave.test.ts:710:21

    console.error
      Erreur dans saveLeaveAsDraft: Error: Save draft failed
          at Object.<anonymous> (/Users/vincentperreard/Mathildanesth/src/modules/leaves/hooks/useLeave.test.ts:788:31)
          at Promise.then.completed (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/utils.js:231:10)
          at _callCircusTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:316:40)
          at _runTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:252:3)
          at _runTestsForDescribeBlock (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:126:9)
          at _runTestsForDescribeBlock (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:121:9)
          at _runTestsForDescribeBlock (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:121:9)
          at run (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:71:3)
          at runAndTransformResultsToJestFormat (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
          at jestAdapter (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:74:19)
          at runTestInternal (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/runTest.js:367:16)
          at runTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/runTest.js:444:34)
          at Object.worker (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/testWorker.js:106:12)

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at Object.error [as saveLeaveAsDraft] (src/modules/leaves/hooks/useLeave.ts:269:21)
      at src/modules/leaves/hooks/useLeave.test.ts:795:21

    console.error
      Erreur dans submitLeave: Error: Submit failed
          at Object.<anonymous> (/Users/vincentperreard/Mathildanesth/src/modules/leaves/hooks/useLeave.test.ts:856:31)
          at Promise.then.completed (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/utils.js:231:10)
          at _callCircusTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:316:40)
          at _runTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:252:3)
          at _runTestsForDescribeBlock (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:126:9)
          at _runTestsForDescribeBlock (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:121:9)
          at _runTestsForDescribeBlock (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:121:9)
          at run (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:71:3)
          at runAndTransformResultsToJestFormat (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
          at jestAdapter (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:74:19)
          at runTestInternal (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/runTest.js:367:16)
          at runTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/runTest.js:444:34)
          at Object.worker (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/testWorker.js:106:12)

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at Object.error [as submitLeave] (src/modules/leaves/hooks/useLeave.ts:318:21)
      at src/modules/leaves/hooks/useLeave.test.ts:863:21

    console.error
      Erreur dans approveLeaveRequest: Error: Approve failed
          at Object.<anonymous> (/Users/vincentperreard/Mathildanesth/src/modules/leaves/hooks/useLeave.test.ts:916:31)
          at Promise.then.completed (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/utils.js:231:10)
          at _callCircusTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:316:40)
          at _runTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:252:3)
          at _runTestsForDescribeBlock (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:126:9)
          at _runTestsForDescribeBlock (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:121:9)
          at _runTestsForDescribeBlock (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:121:9)
          at run (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:71:3)
          at runAndTransformResultsToJestFormat (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
          at jestAdapter (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:74:19)
          at runTestInternal (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/runTest.js:367:16)
          at runTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/runTest.js:444:34)
          at Object.worker (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/testWorker.js:106:12)

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at Object.error [as approveLeaveRequest] (src/modules/leaves/hooks/useLeave.ts:347:21)
      at src/modules/leaves/hooks/useLeave.test.ts:923:21

    console.error
      Erreur dans rejectLeaveRequest: Error: Reject failed
          at Object.<anonymous> (/Users/vincentperreard/Mathildanesth/src/modules/leaves/hooks/useLeave.test.ts:973:31)
          at Promise.then.completed (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/utils.js:231:10)
          at _callCircusTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:316:40)
          at _runTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:252:3)
          at _runTestsForDescribeBlock (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:126:9)
          at _runTestsForDescribeBlock (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:121:9)
          at _runTestsForDescribeBlock (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:121:9)
          at run (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:71:3)
          at runAndTransformResultsToJestFormat (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
          at jestAdapter (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:74:19)
          at runTestInternal (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/runTest.js:367:16)
          at runTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/runTest.js:444:34)
          at Object.worker (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/testWorker.js:106:12)

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at Object.error [as rejectLeaveRequest] (src/modules/leaves/hooks/useLeave.ts:376:21)
      at src/modules/leaves/hooks/useLeave.test.ts:980:21

    console.error
      Erreur dans cancelLeaveRequest: Error: Cancel failed
          at Object.<anonymous> (/Users/vincentperreard/Mathildanesth/src/modules/leaves/hooks/useLeave.test.ts:1027:31)
          at Promise.then.completed (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/utils.js:231:10)
          at _callCircusTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:316:40)
          at _runTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:252:3)
          at _runTestsForDescribeBlock (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:126:9)
          at _runTestsForDescribeBlock (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:121:9)
          at _runTestsForDescribeBlock (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:121:9)
          at run (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:71:3)
          at runAndTransformResultsToJestFormat (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
          at jestAdapter (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:74:19)
          at runTestInternal (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/runTest.js:367:16)
          at runTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/runTest.js:444:34)
          at Object.worker (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/testWorker.js:106:12)

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at Object.error [as cancelLeaveRequest] (src/modules/leaves/hooks/useLeave.ts:405:21)
      at src/modules/leaves/hooks/useLeave.test.ts:1034:21

    console.error
      Erreur dans fetchUserLeaves: Error: Fetch leaves failed
          at Object.<anonymous> (/Users/vincentperreard/Mathildanesth/src/modules/leaves/hooks/useLeave.test.ts:1099:31)
          at Promise.then.completed (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/utils.js:231:10)
          at _callCircusTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:316:40)
          at _runTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:252:3)
          at _runTestsForDescribeBlock (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:126:9)
          at _runTestsForDescribeBlock (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:121:9)
          at _runTestsForDescribeBlock (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:121:9)
          at run (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:71:3)
          at runAndTransformResultsToJestFormat (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
          at jestAdapter (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:74:19)
          at runTestInternal (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/runTest.js:367:16)
          at runTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/runTest.js:444:34)
          at Object.worker (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/testWorker.js:106:12)

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at error (src/modules/leaves/hooks/useLeave.ts:440:21)

    console.error
      Erreur dans fetchLeaveDetails: Error: Fetch details failed
          at Object.<anonymous> (/Users/vincentperreard/Mathildanesth/src/modules/leaves/hooks/useLeave.test.ts:1148:31)
          at Promise.then.completed (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/utils.js:231:10)
          at _callCircusTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:316:40)
          at _runTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:252:3)
          at _runTestsForDescribeBlock (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:126:9)
          at _runTestsForDescribeBlock (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:121:9)
          at _runTestsForDescribeBlock (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:121:9)
          at run (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:71:3)
          at runAndTransformResultsToJestFormat (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
          at jestAdapter (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:74:19)
          at runTestInternal (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/runTest.js:367:16)
          at runTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/runTest.js:444:34)
          at Object.worker (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/testWorker.js:106:12)

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at Object.error [as fetchLeaveDetails] (src/modules/leaves/hooks/useLeave.ts:462:21)
      at src/modules/leaves/hooks/useLeave.test.ts:1154:17

  ● useLeave Hook › should initialize with null leave and empty leaves array when no initialLeave provided

    expect(received).toBe(expected) // Object.is equality

    Expected: false
    Received: true

      172 |         expect(result.current.leave).toBeNull();
      173 |         expect(result.current.leaves).toEqual([]);
    > 174 |         expect(result.current.loading).toBe(false);
          |                                        ^
      175 |         expect(result.current.error).toBeNull();
      176 |         expect(result.current.conflictCheckResult).toBeNull();
      177 |         expect(result.current.allowanceCheckResult).toBeNull();

      at Object.<anonymous> (src/modules/leaves/hooks/useLeave.test.ts:174:40)

  ● useLeave Hook › checkConflicts › should call checkLeaveConflicts service with Date objects and update state on success

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      461 |
      462 |             // Vérifier que loading était true pendant l'appel
    > 463 |             expect(loadingDuringCall).toBe(true);
          |                                       ^
      464 |
      465 |             // Vérifier les états après l'appel
      466 |             expect(result.current.loading).toBe(false);

      at Object.<anonymous> (src/modules/leaves/hooks/useLeave.test.ts:463:39)

  ● useLeave Hook › checkConflicts › should return null if userId is missing

    expect(jest.fn()).not.toHaveBeenCalled()

    Expected number of calls: 0
    Received number of calls: 1

    1: 2024-09-01T22:00:00.000Z, 2024-09-05T22:00:00.000Z, "user123", "leave-initial"

      589 |
      590 |             // Vérifier que le service n'a pas été appelé
    > 591 |             expect(mockedCheckLeaveConflicts).not.toHaveBeenCalled();
          |                                                   ^
      592 |
      593 |             // Vérifier que setError a été appelé avec les informations appropriées
      594 |             expect(mockedSetError).toHaveBeenCalledWith(

      at Object.<anonymous> (src/modules/leaves/hooks/useLeave.test.ts:591:51)

  ● useLeave Hook › fetchUserLeaves › should set error state if fetchLeaves service fails

    Fetch leaves failed

      1097 |
      1098 |         it('should set error state if fetchLeaves service fails', async () => {
    > 1099 |             const mockError = new Error('Fetch leaves failed');
           |                               ^
      1100 |             mockedFetchLeaves.mockRejectedValueOnce(mockError);
      1101 |
      1102 |             const { result } = renderHook(() => useLeave({ userId: mockUserId }));

      at Object.<anonymous> (src/modules/leaves/hooks/useLeave.test.ts:1099:31)

  ● useLeave Hook › fetchUserLeaves › should set error state if fetchLeaves service fails

    expect(received).toEqual(expected) // deep equality

    - Expected  -  1
    + Received  + 14

    - Array []
    + Array [
    +   Object {
    +     "countedDays": 5,
    +     "createdAt": 2024-07-31T22:00:00.000Z,
    +     "endDate": 2024-09-05T22:00:00.000Z,
    +     "id": "leave-initial",
    +     "requestDate": 2024-07-31T22:00:00.000Z,
    +     "startDate": 2024-09-01T22:00:00.000Z,
    +     "status": "DRAFT",
    +     "type": "ANNUAL",
    +     "updatedAt": 2024-07-31T22:00:00.000Z,
    +     "userId": "user123",
    +   },
    + ]

      1119 |                 severity: 'error'
      1120 |             });
    > 1121 |             expect(result.current.leaves).toEqual([]); // Liste reste vide
           |                                           ^
      1122 |         });
      1123 |     });
      1124 |

      at Object.<anonymous> (src/modules/leaves/hooks/useLeave.test.ts:1121:43)

  ● useLeave Hook › fetchLeaveDetails › should set error state if fetchLeaveById service fails

    Fetch details failed

      1146 |         it('should set error state if fetchLeaveById service fails', async () => {
      1147 |             const specificLeaveId = 'leave-fail';
    > 1148 |             const mockError = new Error('Fetch details failed');
           |                               ^
      1149 |             mockedFetchLeaveById.mockRejectedValueOnce(mockError);
      1150 |
      1151 |             const { result } = renderHook(() => useLeave({ userId: mockUserId }));

      at Object.<anonymous> (src/modules/leaves/hooks/useLeave.test.ts:1148:31)

FAIL src/modules/leaves/permissions/__tests__/LeavePermissionService.extended.test.ts
  ● Console

    console.log
      jest.polyfills.js loaded and applied.

      at Object.<anonymous> (jest.polyfills.js:247:9)

    console.log
      jest.setup.js loaded and mocks applied.

      at Object.log (jest.setup.js:126:9)

    console.debug
      [EventBusProfiler] Initialized

      at new debug (src/modules/integration/services/EventBusProfiler.ts:77:17)

    console.error
      Erreur lors du chargement des permissions personnalisées: TypeError: Only absolute URLs are supported
          at getNodeRequestOptions (/Users/vincentperreard/Mathildanesth/node_modules/node-fetch/lib/index.js:1327:9)
          at getNodeRequestOptions (/Users/vincentperreard/Mathildanesth/node_modules/node-fetch/lib/index.js:1450:19)
          at new Promise (<anonymous>)
          at fetch (/Users/vincentperreard/Mathildanesth/node_modules/node-fetch/lib/index.js:1447:9)
          at call (/Users/vincentperreard/Mathildanesth/node_modules/cross-fetch/dist/node-ponyfill.js:10:20)
          at LeavePermissionService.fetch [as loadCustomPermissions] (/Users/vincentperreard/Mathildanesth/src/modules/leaves/permissions/LeavePermissionService.ts:450:36)
          at new loadCustomPermissions (/Users/vincentperreard/Mathildanesth/src/modules/leaves/permissions/LeavePermissionService.ts:237:14)
          at Function.getInstance (/Users/vincentperreard/Mathildanesth/src/modules/leaves/permissions/LeavePermissionService.ts:201:47)
          at Object.getInstance (/Users/vincentperreard/Mathildanesth/src/modules/leaves/permissions/LeavePermissionService.ts:1049:62)
          at Runtime._execModule (/Users/vincentperreard/Mathildanesth/node_modules/jest-runtime/build/index.js:1439:24)
          at Runtime._loadModule (/Users/vincentperreard/Mathildanesth/node_modules/jest-runtime/build/index.js:1022:12)
          at Runtime.requireModule (/Users/vincentperreard/Mathildanesth/node_modules/jest-runtime/build/index.js:882:12)
          at Runtime.requireModuleOrMock (/Users/vincentperreard/Mathildanesth/node_modules/jest-runtime/build/index.js:1048:21)
          at Object.<anonymous> (/Users/vincentperreard/Mathildanesth/src/modules/leaves/permissions/__tests__/LeavePermissionService.extended.test.ts:1:1)
          at Runtime._execModule (/Users/vincentperreard/Mathildanesth/node_modules/jest-runtime/build/index.js:1439:24)
          at Runtime._loadModule (/Users/vincentperreard/Mathildanesth/node_modules/jest-runtime/build/index.js:1022:12)
          at Runtime.requireModule (/Users/vincentperreard/Mathildanesth/node_modules/jest-runtime/build/index.js:882:12)
          at jestAdapter (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:72:13)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at runTestInternal (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/runTest.js:367:16)
          at runTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/runTest.js:444:34)
          at Object.worker (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/testWorker.js:106:12)

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at LeavePermissionService.error [as loadCustomPermissions] (src/modules/leaves/permissions/LeavePermissionService.ts:474:21)

    console.info
      [DEBUG] grantPermission called for user: user-123, permission: leaves.reports.view

      at console.<anonymous> (src/modules/leaves/permissions/__tests__/LeavePermissionService.extended.test.ts:179:25)

    console.info
      [DEBUG] grantPermission: Current user performing action: id=admin-123, role=ADMIN_TOTAL

      at console.<anonymous> (src/modules/leaves/permissions/__tests__/LeavePermissionService.extended.test.ts:179:25)

    console.info
      [DEBUG] grantPermission: hasAuth (MANAGE_LEAVE_RULES) for admin-123: true

      at console.<anonymous> (src/modules/leaves/permissions/__tests__/LeavePermissionService.extended.test.ts:179:25)

    console.info
      [DEBUG] grantPermission: saveCustomPermissions result for user-123: true

      at console.<anonymous> (src/modules/leaves/permissions/__tests__/LeavePermissionService.extended.test.ts:179:25)

    console.info
      [DEBUG] revokePermission called for user: user-123, permission: leaves.reports.view

      at console.<anonymous> (src/modules/leaves/permissions/__tests__/LeavePermissionService.extended.test.ts:179:25)

    console.info
      [DEBUG] revokePermission: saveCustomPermissions result for user-123: true

      at console.<anonymous> (src/modules/leaves/permissions/__tests__/LeavePermissionService.extended.test.ts:179:25)

    console.info
      [DEBUG] grantPermission called for user: user-123, permission: leaves.reports.view

      at console.<anonymous> (src/modules/leaves/permissions/__tests__/LeavePermissionService.extended.test.ts:179:25)

    console.info
      [DEBUG] grantPermission: Current user performing action: id=admin-123, role=ADMIN_TOTAL

      at console.<anonymous> (src/modules/leaves/permissions/__tests__/LeavePermissionService.extended.test.ts:179:25)

    console.info
      [DEBUG] grantPermission: hasAuth (MANAGE_LEAVE_RULES) for admin-123: true

      at console.<anonymous> (src/modules/leaves/permissions/__tests__/LeavePermissionService.extended.test.ts:179:25)

    console.info
      [DEBUG] grantPermission: saveCustomPermissions result for user-123: false

      at console.<anonymous> (src/modules/leaves/permissions/__tests__/LeavePermissionService.extended.test.ts:179:25)

    console.info
      [DEBUG] revokePermission called for user: user-123, permission: leaves.reports.view

      at console.<anonymous> (src/modules/leaves/permissions/__tests__/LeavePermissionService.extended.test.ts:179:25)

    console.info
      [DEBUG] revokePermission: saveCustomPermissions result for user-123: false

      at console.<anonymous> (src/modules/leaves/permissions/__tests__/LeavePermissionService.extended.test.ts:179:25)

  ● LeavePermissionService (Tests avancés) › Cache de permissions › devrait invalider le cache d'un utilisateur

    Property `delete` does not exist in the provided object

      186 |             // Arrange
      187 |             const userId = mockEmployee.id;
    > 188 |             const cacheSpy = jest.spyOn(permissionService['permissionCache'], 'delete');
          |                                   ^
      189 |
      190 |             // Act
      191 |             permissionService.invalidateUserCache(mockEmployee.id);

      at ModuleMocker.spyOn (node_modules/jest-mock/build/index.js:731:13)
      at Object.<anonymous> (src/modules/leaves/permissions/__tests__/LeavePermissionService.extended.test.ts:188:35)

  ● LeavePermissionService (Tests avancés) › Cache de permissions › devrait configurer le cache avec les options fournies

    expect(jest.fn()).toHaveBeenCalled()

    Expected number of calls: >= 1
    Received number of calls:    0

      212 |
      213 |             // Assert
    > 214 |             expect(optionsSpy).toHaveBeenCalled();
          |                                ^
      215 |
      216 |             // Note: Ne pas tester les stats ici car elles peuvent varier en fonction de l'environnement
      217 |             // et de l'ordre d'exécution des tests

      at Object.<anonymous> (src/modules/leaves/permissions/__tests__/LeavePermissionService.extended.test.ts:214:32)

FAIL src/modules/leaves/hooks/useLeaveQuota.test.ts
  ● Console

    console.log
      jest.polyfills.js loaded and applied.

      at Object.<anonymous> (jest.polyfills.js:247:9)

    console.log
      jest.setup.js loaded and mocks applied.

      at Object.log (jest.setup.js:126:9)

    console.error
      Erreur lors de la récupération des quotas de congés Error: Erreur de chargement des quotas
          at Object.<anonymous> (/Users/vincentperreard/Mathildanesth/src/modules/leaves/hooks/useLeaveQuota.test.ts:196:60)
          at Promise.then.completed (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/utils.js:231:10)
          at _callCircusTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:316:40)
          at _runTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:252:3)
          at _runTestsForDescribeBlock (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:126:9)
          at _runTestsForDescribeBlock (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:121:9)
          at run (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:71:3)
          at runAndTransformResultsToJestFormat (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
          at jestAdapter (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:74:19)
          at runTestInternal (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/runTest.js:367:16)
          at runTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/runTest.js:444:34)
          at Object.worker (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/testWorker.js:106:12)

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at Object.error [as refreshQuotas] (src/modules/leaves/hooks/useLeaveQuota.ts:246:21)
      at src/modules/leaves/hooks/useLeaveQuota.test.ts:201:13

  ● useLeaveQuota › devrait charger les quotas de congés

    expect(received).toBe(expected) // Object.is equality

    Expected: 12
    Received: 10

       99 |         expect(result.current.totalBalance.pending).toBe(5);
      100 |         expect(result.current.totalBalance.remaining).toBe(20);
    > 101 |         expect(result.current.quotasByType.length).toBe(12); // Mise à jour pour tous les types incluant PATERNITY et PARENTAL
          |                                                    ^
      102 |     });
      103 |
      104 |     it('devrait récupérer le quota pour un type spécifique', async () => {

      at Object.<anonymous> (src/modules/leaves/hooks/useLeaveQuota.test.ts:101:52)

(node:80191) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.
(Use `node --trace-deprecation ...` to show where the warning was created)
PASS src/modules/leaves/__tests__/integration/riskDetectionSystem.test.ts
  ● Console

    console.log
      jest.polyfills.js loaded and applied.

      at Object.<anonymous> (jest.polyfills.js:247:9)

    console.log
      jest.setup.js loaded and mocks applied.

      at Object.log (jest.setup.js:126:9)

    console.log
      Skipping beforeunload listener setup (not in a browser environment or sendBeacon not supported).

      at log (src/services/errorLoggingService.ts:126:17)

    console.log
      Aucune période à risque future trouvée - test passé par défaut

      at Object.<anonymous> (src/modules/leaves/__tests__/integration/riskDetectionSystem.test.ts:191:25)


  ●  Cannot log after tests are done. Did you forget to wait for something async in your test?
    Attempted to log "[PublicHolidayService] Impossible de récupérer les jours fériés depuis l'API pour l'année 2025. Utilisation du calcul local.".



      at console.warn (node_modules/@jest/console/build/BufferedConsole.js:191:10)
      at PublicHolidayService.getPublicHolidaysForYear (src/modules/leaves/services/publicHolidayService.ts:7441:15)
          at async Promise.all (index 1)
      at PublicHolidayService.preloadData (src/modules/leaves/services/publicHolidayService.ts:7072:7)


  ●  Cannot log after tests are done. Did you forget to wait for something async in your test?
    Attempted to log "[PublicHolidayService] Impossible de récupérer les jours fériés depuis l'API pour l'année 2027. Utilisation du calcul local.".



      at console.warn (node_modules/@jest/console/build/BufferedConsole.js:191:10)
      at PublicHolidayService.getPublicHolidaysForYear (src/modules/leaves/services/publicHolidayService.ts:7441:15)
          at async Promise.all (index 3)
      at PublicHolidayService.preloadData (src/modules/leaves/services/publicHolidayService.ts:7072:7)

PASS src/modules/leaves/services/__tests__/leaveCalculator.test.ts
  ● Console

    console.log
      jest.polyfills.js loaded and applied.

      at Object.<anonymous> (jest.polyfills.js:247:9)

    console.log
      jest.setup.js loaded and mocks applied.

      at Object.log (jest.setup.js:126:9)

    console.log
      Initializing console logger for client.

      at log (src/utils/logger.ts:45:21)

    console.info
      Starting leave counted days calculation... {
        startDate: '04/09/2023',
        endDate: '08/09/2023',
        scheduleId: 'full-time-test',
        isHalfDay: false,
        halfDayPeriod: undefined,
        options: { forceCacheRefresh: true }
      }

      at info (src/modules/leaves/services/leaveCalculator.ts:140:16)

    console.info
      Fetched 0 public holidays for the period.

      at info (src/modules/leaves/services/leaveCalculator.ts:179:16)

    console.info
      Leave counted days calculation successful { countedDays: 5, workDays: 5, scheduleId: 'full-time-test' }

      at info (src/modules/leaves/services/leaveCalculator.ts:345:16)

    console.info
      Starting leave counted days calculation... {
        startDate: '04/09/2023',
        endDate: '11/09/2023',
        scheduleId: 'full-time-test',
        isHalfDay: false,
        halfDayPeriod: undefined,
        options: { forceCacheRefresh: true }
      }

      at info (src/modules/leaves/services/leaveCalculator.ts:140:16)

    console.info
      Fetched 0 public holidays for the period.

      at info (src/modules/leaves/services/leaveCalculator.ts:179:16)

    console.info
      Leave counted days calculation successful { countedDays: 6, workDays: 6, scheduleId: 'full-time-test' }

      at info (src/modules/leaves/services/leaveCalculator.ts:345:16)

    console.info
      Starting leave counted days calculation... {
        startDate: '04/09/2023',
        endDate: '08/09/2023',
        scheduleId: 'full-time-test',
        isHalfDay: false,
        halfDayPeriod: undefined,
        options: { skipHolidays: true, forceCacheRefresh: true }
      }

      at info (src/modules/leaves/services/leaveCalculator.ts:140:16)

    console.info
      Fetched 1 public holidays for the period.

      at info (src/modules/leaves/services/leaveCalculator.ts:179:16)

    console.info
      Leave counted days calculation successful { countedDays: 4, workDays: 4, scheduleId: 'full-time-test' }

      at info (src/modules/leaves/services/leaveCalculator.ts:345:16)

    console.info
      Starting leave counted days calculation... {
        startDate: '04/09/2023',
        endDate: '08/09/2023',
        scheduleId: 'full-time-test',
        isHalfDay: false,
        halfDayPeriod: undefined,
        options: { skipHolidays: false, forceCacheRefresh: true }
      }

      at info (src/modules/leaves/services/leaveCalculator.ts:140:16)

    console.info
      Fetched 1 public holidays for the period.

      at info (src/modules/leaves/services/leaveCalculator.ts:179:16)

    console.info
      Leave counted days calculation successful { countedDays: 5, workDays: 5, scheduleId: 'full-time-test' }

      at info (src/modules/leaves/services/leaveCalculator.ts:345:16)

    console.info
      Starting leave counted days calculation... {
        startDate: '04/09/2023',
        endDate: '08/09/2023',
        scheduleId: 'full-time-test',
        isHalfDay: true,
        halfDayPeriod: 'AM',
        options: { isHalfDay: true, forceCacheRefresh: true }
      }

      at info (src/modules/leaves/services/leaveCalculator.ts:140:16)

    console.info
      Fetched 0 public holidays for the period.

      at info (src/modules/leaves/services/leaveCalculator.ts:179:16)

    console.info
      Leave counted days calculation successful { countedDays: 4.5, workDays: 5, scheduleId: 'full-time-test' }

      at info (src/modules/leaves/services/leaveCalculator.ts:345:16)

    console.info
      Starting leave counted days calculation... {
        startDate: '04/09/2023',
        endDate: '08/09/2023',
        scheduleId: 'part-time-test',
        isHalfDay: false,
        halfDayPeriod: undefined,
        options: { forceCacheRefresh: true }
      }

      at info (src/modules/leaves/services/leaveCalculator.ts:140:16)

    console.info
      Fetched 0 public holidays for the period.

      at info (src/modules/leaves/services/leaveCalculator.ts:179:16)

    console.info
      Leave counted days calculation successful { countedDays: 3, workDays: 5, scheduleId: 'part-time-test' }

      at info (src/modules/leaves/services/leaveCalculator.ts:345:16)

    console.info
      Starting leave counted days calculation... {
        startDate: '08/09/2023',
        endDate: '10/09/2023',
        scheduleId: 'full-time-test',
        isHalfDay: false,
        halfDayPeriod: undefined,
        options: { forceCacheRefresh: true }
      }

      at info (src/modules/leaves/services/leaveCalculator.ts:140:16)

    console.info
      Fetched 1 public holidays for the period.

      at info (src/modules/leaves/services/leaveCalculator.ts:179:16)

    console.info
      Leave counted days calculation successful { countedDays: 1, workDays: 1, scheduleId: 'full-time-test' }

      at info (src/modules/leaves/services/leaveCalculator.ts:345:16)

    console.info
      Starting leave counted days calculation... {
        startDate: '08/09/2023',
        endDate: '10/09/2023',
        scheduleId: 'full-time-test',
        isHalfDay: false,
        halfDayPeriod: undefined,
        options: {
          countHolidaysOnWeekends: true,
          skipHolidays: false,
          forceCacheRefresh: true
        }
      }

      at info (src/modules/leaves/services/leaveCalculator.ts:140:16)

    console.info
      Fetched 1 public holidays for the period.

      at info (src/modules/leaves/services/leaveCalculator.ts:179:16)

    console.info
      Leave counted days calculation successful { countedDays: 2, workDays: 1, scheduleId: 'full-time-test' }

      at info (src/modules/leaves/services/leaveCalculator.ts:345:16)

    console.info
      Starting leave counted days calculation... {
        startDate: '04/09/2023',
        endDate: '08/09/2023',
        scheduleId: 'full-time-test',
        isHalfDay: false,
        halfDayPeriod: undefined,
        options: undefined
      }

      at info (src/modules/leaves/services/leaveCalculator.ts:140:16)

    console.info
      Fetched 0 public holidays for the period.

      at info (src/modules/leaves/services/leaveCalculator.ts:179:16)

    console.info
      Leave counted days calculation successful { countedDays: 5, workDays: 5, scheduleId: 'full-time-test' }

      at info (src/modules/leaves/services/leaveCalculator.ts:345:16)

    console.warn
      Invalid dates provided to calculateLeaveCountedDays {
        startDateInput: 2023-09-07T22:00:00.000Z,
        endDateInput: 2023-09-03T22:00:00.000Z
      }

      117 |         // Vérifier que la date de fin est après la date de début
      118 |         if (isAfter(startDate, endDate)) {
    > 119 |             logger.warn('Invalid dates provided to calculateLeaveCountedDays', { startDateInput, endDateInput });
          |                    ^
      120 |             return null;
      121 |         }
      122 |

      at warn (src/modules/leaves/services/leaveCalculator.ts:119:20)
      at Object.<anonymous> (src/modules/leaves/services/__tests__/leaveCalculator.test.ts:197:28)

    console.info
      Starting leave counted days calculation... {
        startDate: '04/09/2023',
        endDate: '04/09/2023',
        scheduleId: 'full-time-test',
        isHalfDay: true,
        halfDayPeriod: 'AM',
        options: { isHalfDay: true, halfDayPeriod: 'AM', forceCacheRefresh: true }
      }

      at info (src/modules/leaves/services/leaveCalculator.ts:140:16)

    console.info
      Fetched 0 public holidays for the period.

      at info (src/modules/leaves/services/leaveCalculator.ts:179:16)

    console.info
      Leave counted days calculation successful { countedDays: 0.5, workDays: 1, scheduleId: 'full-time-test' }

      at info (src/modules/leaves/services/leaveCalculator.ts:345:16)

    console.info
      Starting leave counted days calculation... {
        startDate: '04/09/2023',
        endDate: '04/09/2023',
        scheduleId: 'full-time-test',
        isHalfDay: true,
        halfDayPeriod: 'PM',
        options: { isHalfDay: true, halfDayPeriod: 'PM', forceCacheRefresh: true }
      }

      at info (src/modules/leaves/services/leaveCalculator.ts:140:16)

    console.info
      Fetched 0 public holidays for the period.

      at info (src/modules/leaves/services/leaveCalculator.ts:179:16)

    console.info
      Leave counted days calculation successful { countedDays: 0.5, workDays: 1, scheduleId: 'full-time-test' }

      at info (src/modules/leaves/services/leaveCalculator.ts:345:16)

    console.info
      Starting leave counted days calculation... {
        startDate: '04/09/2023',
        endDate: '05/09/2023',
        scheduleId: 'full-time-test',
        isHalfDay: true,
        halfDayPeriod: 'AM',
        options: { isHalfDay: true, forceCacheRefresh: true }
      }

      at info (src/modules/leaves/services/leaveCalculator.ts:140:16)

    console.info
      Fetched 0 public holidays for the period.

      at info (src/modules/leaves/services/leaveCalculator.ts:179:16)

    console.info
      Leave counted days calculation successful { countedDays: 1.5, workDays: 2, scheduleId: 'full-time-test' }

      at info (src/modules/leaves/services/leaveCalculator.ts:345:16)

    console.info
      Starting leave counted days calculation... {
        startDate: '04/09/2023',
        endDate: '05/09/2023',
        scheduleId: 'full-time-test',
        isHalfDay: false,
        halfDayPeriod: undefined,
        options: { skipHolidays: true, forceCacheRefresh: true }
      }

      at info (src/modules/leaves/services/leaveCalculator.ts:140:16)

    console.info
      Fetched 0 public holidays for the period.

      at info (src/modules/leaves/services/leaveCalculator.ts:179:16)

    console.info
      Leave counted days calculation successful { countedDays: 2, workDays: 2, scheduleId: 'full-time-test' }

      at info (src/modules/leaves/services/leaveCalculator.ts:345:16)

    console.info
      Calculating working days... { startDate: '04/09/2023', endDate: '08/09/2023', options: undefined }

      at info (src/modules/leaves/services/leaveCalculator.ts:389:16)

    console.info
      Fetched 0 public holidays for working days calculation.

      at info (src/modules/leaves/services/leaveCalculator.ts:398:16)

    console.info
      Working days calculated: 5

      at info (src/modules/leaves/services/leaveCalculator.ts:433:16)

    console.info
      Calculating working days... { startDate: '04/09/2023', endDate: '10/09/2023', options: undefined }

      at info (src/modules/leaves/services/leaveCalculator.ts:389:16)

    console.info
      Fetched 0 public holidays for working days calculation.

      at info (src/modules/leaves/services/leaveCalculator.ts:398:16)

    console.info
      Working days calculated: 5

      at info (src/modules/leaves/services/leaveCalculator.ts:433:16)

    console.info
      Calculating working days... { startDate: '04/09/2023', endDate: '08/09/2023', options: undefined }

      at info (src/modules/leaves/services/leaveCalculator.ts:389:16)

    console.info
      Fetched 1 public holidays for working days calculation.

      at info (src/modules/leaves/services/leaveCalculator.ts:398:16)

    console.info
      Working days calculated: 4

      at info (src/modules/leaves/services/leaveCalculator.ts:433:16)

    console.info
      Checking if 04/09/2023 is a business day...

      at info (src/modules/leaves/services/leaveCalculator.ts:469:16)

    console.info
      Result for 04/09/2023: isWeekend=false, isHoliday=false

      at info (src/modules/leaves/services/leaveCalculator.ts:471:16)

    console.info
      Checking if 05/09/2023 is a business day...

      at info (src/modules/leaves/services/leaveCalculator.ts:469:16)

    console.info
      Result for 05/09/2023: isWeekend=false, isHoliday=true

      at info (src/modules/leaves/services/leaveCalculator.ts:471:16)

    console.warn
      Invalid date provided to isBusinessDay { date: null }

      459 |         const dateObj = parseDate(date);
      460 |         if (!dateObj) {
    > 461 |             logger.warn('Invalid date provided to isBusinessDay', { date });
          |                    ^
      462 |             return false;
      463 |         }
      464 |

      at warn (src/modules/leaves/services/leaveCalculator.ts:461:20)
      at Object.<anonymous> (src/modules/leaves/services/__tests__/leaveCalculator.test.ts:299:28)

PASS src/modules/leaves/api/__tests__/LeaveReportApi.test.ts
  ● Console

    console.log
      jest.polyfills.js loaded and applied.

      at Object.<anonymous> (jest.polyfills.js:247:9)

    console.log
      jest.setup.js loaded and mocks applied.

      at Object.log (jest.setup.js:126:9)

PASS src/modules/leaves/services/__tests__/quotaManagementService.test.ts
  ● Console

    console.log
      jest.polyfills.js loaded and applied.

      at Object.<anonymous> (jest.polyfills.js:247:9)

    console.log
      jest.setup.js loaded and mocks applied.

      at Object.log (jest.setup.js:126:9)

    console.log
      >>> DEBUG: Dans catch getTransferRules

      at QuotaManagementService.log [as getTransferRules] (src/modules/leaves/services/quotaManagementService.ts:71:21)

    console.log
      >>> DEBUG: Dans catch simulateTransfer

      at QuotaManagementService.log [as simulateTransfer] (src/modules/leaves/services/quotaManagementService.ts:245:21)

    console.log
      >>> DEBUG: Dans catch requestTransfer

      at QuotaManagementService.log [as requestTransfer] (src/modules/leaves/services/quotaManagementService.ts:306:21)

    console.log
      >>> DEBUG: Dans catch getUserTransactionHistory

      at QuotaManagementService.log [as getUserTransactionHistory] (src/modules/leaves/services/quotaManagementService.ts:190:21)

    console.error
      Échec du traitement de la demande de transfert:

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at QuotaManagementService.error [as processTransferRequest] (src/modules/leaves/services/quotaManagementService.ts:354:21)
      at Object.<anonymous> (src/modules/leaves/services/__tests__/quotaManagementService.test.ts:341:24)

    console.error
      Échec du traitement de la demande de transfert:

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at QuotaManagementService.error [as processTransferRequest] (src/modules/leaves/services/quotaManagementService.ts:354:21)
      at Object.<anonymous> (src/modules/leaves/services/__tests__/quotaManagementService.test.ts:384:24)

    console.log
      >>> DEBUG: Dans catch getCarryOverRules

      at QuotaManagementService.log [as getCarryOverRules] (src/modules/leaves/services/quotaManagementService.ts:98:21)

    console.error
      Échec de la demande de report:

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at QuotaManagementService.error [as requestCarryOver] (src/modules/leaves/services/quotaManagementService.ts:467:21)
      at Object.<anonymous> (src/modules/leaves/services/__tests__/quotaManagementService.test.ts:477:28)

    console.error
      Échec du traitement de la demande de report:

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at QuotaManagementService.error [as processCarryOverRequest] (src/modules/leaves/services/quotaManagementService.ts:515:21)
      at Object.<anonymous> (src/modules/leaves/services/__tests__/quotaManagementService.test.ts:534:28)

FAIL src/modules/leaves/quotas/transfer/__tests__/useQuotaTransfer.test.tsx
  ● Console

    console.log
      jest.polyfills.js loaded and applied.

      at Object.<anonymous> (jest.polyfills.js:247:9)

    console.log
      jest.setup.js loaded and mocks applied.

      at Object.log (jest.setup.js:126:9)

    console.error
      Erreur lors de la simulation du transfert Error: Aucune règle de transfert n'est disponible pour Récupération vers Congés annuels
          at Object.simulateTransfer (/Users/vincentperreard/Mathildanesth/src/modules/leaves/quotas/transfer/useQuotaTransfer.ts:248:23)
          at /Users/vincentperreard/Mathildanesth/src/modules/leaves/quotas/transfer/__tests__/useQuotaTransfer.test.tsx:179:53
          at callback (/Users/vincentperreard/Mathildanesth/node_modules/@testing-library/react/dist/act-compat.js:48:24)
          at callback (/Users/vincentperreard/Mathildanesth/node_modules/react/cjs/react.development.js:2512:16)
          at actImplementation (/Users/vincentperreard/Mathildanesth/node_modules/@testing-library/react/dist/act-compat.js:47:25)
          at Object.<anonymous> (/Users/vincentperreard/Mathildanesth/src/modules/leaves/quotas/transfer/__tests__/useQuotaTransfer.test.tsx:178:18)

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at Object.error [as simulateTransfer] (src/modules/leaves/quotas/transfer/useQuotaTransfer.ts:267:21)
      at src/modules/leaves/quotas/transfer/__tests__/useQuotaTransfer.test.tsx:179:53
      at callback (node_modules/@testing-library/react/dist/act-compat.js:48:24)
      at callback (node_modules/react/cjs/react.development.js:2512:16)
      at actImplementation (node_modules/@testing-library/react/dist/act-compat.js:47:25)
      at Object.<anonymous> (src/modules/leaves/quotas/transfer/__tests__/useQuotaTransfer.test.tsx:178:18)

    console.error
      Erreur lors de l'exécution du transfert Error: Aucune règle de transfert n'est disponible pour Récupération vers Congés annuels
          at Object.executeTransfer (/Users/vincentperreard/Mathildanesth/src/modules/leaves/quotas/transfer/useQuotaTransfer.ts:298:23)
          at /Users/vincentperreard/Mathildanesth/src/modules/leaves/quotas/transfer/__tests__/useQuotaTransfer.test.tsx:219:51
          at callback (/Users/vincentperreard/Mathildanesth/node_modules/@testing-library/react/dist/act-compat.js:48:24)
          at callback (/Users/vincentperreard/Mathildanesth/node_modules/react/cjs/react.development.js:2512:16)
          at actImplementation (/Users/vincentperreard/Mathildanesth/node_modules/@testing-library/react/dist/act-compat.js:47:25)
          at Object.<anonymous> (/Users/vincentperreard/Mathildanesth/src/modules/leaves/quotas/transfer/__tests__/useQuotaTransfer.test.tsx:218:18)

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at Object.error [as executeTransfer] (src/modules/leaves/quotas/transfer/useQuotaTransfer.ts:312:21)
      at src/modules/leaves/quotas/transfer/__tests__/useQuotaTransfer.test.tsx:219:51
      at callback (node_modules/@testing-library/react/dist/act-compat.js:48:24)
      at callback (node_modules/react/cjs/react.development.js:2512:16)
      at actImplementation (node_modules/@testing-library/react/dist/act-compat.js:47:25)
      at Object.<anonymous> (src/modules/leaves/quotas/transfer/__tests__/useQuotaTransfer.test.tsx:218:18)

    console.error
      Erreur lors de l'exécution du transfert Error: Aucune règle de transfert n'est disponible pour Récupération vers Congés annuels
          at Object.executeTransfer (/Users/vincentperreard/Mathildanesth/src/modules/leaves/quotas/transfer/useQuotaTransfer.ts:298:23)
          at /Users/vincentperreard/Mathildanesth/src/modules/leaves/quotas/transfer/__tests__/useQuotaTransfer.test.tsx:254:51
          at callback (/Users/vincentperreard/Mathildanesth/node_modules/@testing-library/react/dist/act-compat.js:48:24)
          at callback (/Users/vincentperreard/Mathildanesth/node_modules/react/cjs/react.development.js:2512:16)
          at actImplementation (/Users/vincentperreard/Mathildanesth/node_modules/@testing-library/react/dist/act-compat.js:47:25)
          at Object.<anonymous> (/Users/vincentperreard/Mathildanesth/src/modules/leaves/quotas/transfer/__tests__/useQuotaTransfer.test.tsx:253:18)

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at Object.error [as executeTransfer] (src/modules/leaves/quotas/transfer/useQuotaTransfer.ts:312:21)
      at src/modules/leaves/quotas/transfer/__tests__/useQuotaTransfer.test.tsx:254:51
      at callback (node_modules/@testing-library/react/dist/act-compat.js:48:24)
      at callback (node_modules/react/cjs/react.development.js:2512:16)
      at actImplementation (node_modules/@testing-library/react/dist/act-compat.js:47:25)
      at Object.<anonymous> (src/modules/leaves/quotas/transfer/__tests__/useQuotaTransfer.test.tsx:253:18)

    console.error
      Erreur lors de l'exécution du transfert Error: Aucune règle de transfert n'est disponible pour Récupération vers Congés annuels
          at Object.executeTransfer (/Users/vincentperreard/Mathildanesth/src/modules/leaves/quotas/transfer/useQuotaTransfer.ts:298:23)
          at /Users/vincentperreard/Mathildanesth/src/modules/leaves/quotas/transfer/__tests__/useQuotaTransfer.test.tsx:300:51
          at callback (/Users/vincentperreard/Mathildanesth/node_modules/@testing-library/react/dist/act-compat.js:48:24)
          at callback (/Users/vincentperreard/Mathildanesth/node_modules/react/cjs/react.development.js:2512:16)
          at actImplementation (/Users/vincentperreard/Mathildanesth/node_modules/@testing-library/react/dist/act-compat.js:47:25)
          at Object.<anonymous> (/Users/vincentperreard/Mathildanesth/src/modules/leaves/quotas/transfer/__tests__/useQuotaTransfer.test.tsx:299:18)

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at Object.error [as executeTransfer] (src/modules/leaves/quotas/transfer/useQuotaTransfer.ts:312:21)
      at src/modules/leaves/quotas/transfer/__tests__/useQuotaTransfer.test.tsx:300:51
      at callback (node_modules/@testing-library/react/dist/act-compat.js:48:24)
      at callback (node_modules/react/cjs/react.development.js:2512:16)
      at actImplementation (node_modules/@testing-library/react/dist/act-compat.js:47:25)
      at Object.<anonymous> (src/modules/leaves/quotas/transfer/__tests__/useQuotaTransfer.test.tsx:299:18)

  ● useQuotaTransfer › devrait charger les données initiales

    expect(received).not.toBeNull()

    Received: null

    Ignored nodes: comments, script, style
    [36m<html>[39m
      [36m<head />[39m
      [36m<body>[39m
        [36m<div />[39m
      [36m</body>[39m
    [36m</html>[39m

      130 |         expect(result.current.error).toBeNull();
      131 |
    > 132 |         await waitFor(() => expect(result.current.balance).not.toBeNull());
          |                                                                ^
      133 |
      134 |         // Vérifier l'état après chargement
      135 |         expect(result.current.loading).toBe(false);

      at src/modules/leaves/quotas/transfer/__tests__/useQuotaTransfer.test.tsx:132:64
      at callback (node_modules/@testing-library/dom/dist/config.js:47:12)
      at checkCallback (node_modules/@testing-library/dom/dist/wait-for.js:124:76)
      at checkCallback (node_modules/@testing-library/dom/dist/wait-for.js:118:16)
      at Timeout.task [as _onTimeout] (node_modules/jsdom/lib/jsdom/browser/Window.js:520:19)

  ● useQuotaTransfer › devrait calculer correctement les types disponibles

    expect(received).toContain(expected) // indexOf

    Expected value: "ANNUAL"
    Received array: []

      151 |
      152 |         // Vérifier les types sources disponibles
    > 153 |         expect(result.current.availableSourceTypes).toContain(LeaveType.ANNUAL);
          |                                                     ^
      154 |         expect(result.current.availableSourceTypes).toContain(LeaveType.RECOVERY);
      155 |
      156 |         // Vérifier les types cibles disponibles par source

      at Object.<anonymous> (src/modules/leaves/quotas/transfer/__tests__/useQuotaTransfer.test.tsx:153:53)

  ● useQuotaTransfer › devrait simuler un transfert correctement

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: {"sourceAmount": 5, "sourceType": "RECOVERY", "targetType": "ANNUAL", "userId": "mock-user-id"}, [{"createdAt": 2025-05-25T17:18:05.040Z, "id": "rule-1", "isActive": true, "name": "Récupération vers Congés Annuels", "ratio": 1, "ruleType": "STANDARD", "sourceType": "RECOVERY", "targetType": "ANNUAL", "updatedAt": 2025-05-25T17:18:05.040Z}]

    Number of calls: 0

      188 |
      189 |         // Vérifier les appels et le résultat
    > 190 |         expect(previewQuotaTransfer).toHaveBeenCalledWith(transferRequest, applicableRules);
          |                                      ^
      191 |         expect(simulationResult).toMatchObject({
      192 |             success: true,
      193 |             sourceAmount: 5,

      at Object.<anonymous> (src/modules/leaves/quotas/transfer/__tests__/useQuotaTransfer.test.tsx:190:38)

  ● useQuotaTransfer › devrait exécuter un transfert correctement

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: {"sourceAmount": 5, "sourceType": "RECOVERY", "targetType": "ANNUAL", "userId": "mock-user-id"}

    Number of calls: 0

      221 |
      222 |         // Vérifier les appels et le résultat
    > 223 |         expect(transferQuota).toHaveBeenCalledWith(transferRequest);
          |                               ^
      224 |         expect(fetchLeaveBalance).toHaveBeenCalledTimes(2);
      225 |         expect(transferResult).toEqual(mockTransferResult);
      226 |     });

      at Object.<anonymous> (src/modules/leaves/quotas/transfer/__tests__/useQuotaTransfer.test.tsx:223:31)

  ● useQuotaTransfer › devrait gérer les erreurs de transfert

    expect(received).toBe(expected) // Object.is equality

    Expected: "Erreur lors du transfert"
    Received: "Aucune règle de transfert n'est disponible pour Récupération vers Congés annuels"

      304 |         expect(transferResult.success).toBe(false);
      305 |         expect(result.current.transferError).toBeInstanceOf(Error);
    > 306 |         expect(result.current.transferError?.message).toBe(errorMessage);
          |                                                       ^
      307 |     });
      308 | }); 

      at Object.<anonymous> (src/modules/leaves/quotas/transfer/__tests__/useQuotaTransfer.test.tsx:306:55)

PASS src/modules/leaves/services/__tests__/notificationEventService.test.ts
  ● Console

    console.log
      jest.polyfills.js loaded and applied.

      at Object.<anonymous> (jest.polyfills.js:247:9)

    console.log
      jest.setup.js loaded and mocks applied.

      at Object.log (jest.setup.js:126:9)

PASS src/modules/leaves/components/__tests__/LeaveRequestForm.test.tsx
  ● Console

    console.log
      jest.polyfills.js loaded and applied.

      at Object.<anonymous> (jest.polyfills.js:247:9)

    console.log
      jest.setup.js loaded and mocks applied.

      at Object.log (jest.setup.js:126:9)

PASS src/modules/leaves/hooks/useLeaveValidation.test.ts
  ● Console

    console.log
      jest.polyfills.js loaded and applied.

      at Object.<anonymous> (jest.polyfills.js:247:9)

    console.log
      jest.setup.js loaded and mocks applied.

      at Object.log (jest.setup.js:126:9)

    console.log
      Skipping beforeunload listener setup (not in a browser environment or sendBeacon not supported).

      at log (src/services/errorLoggingService.ts:126:17)

    console.debug
      [LeaveValidation] Cache miss (0 hits, 1 misses)

      at Object.debug [as validateLeaveRequest] (src/modules/leaves/hooks/useLeaveValidation.ts:212:17)

    console.debug
      [LeaveValidation] Cache miss (0 hits, 1 misses)

      at Object.debug [as validateLeaveRequest] (src/modules/leaves/hooks/useLeaveValidation.ts:212:17)

    console.debug
      [LeaveValidation] Cache miss (0 hits, 1 misses)

      at Object.debug [as validateLeaveRequest] (src/modules/leaves/hooks/useLeaveValidation.ts:212:17)

    console.debug
      [LeaveValidation] Cache miss (0 hits, 1 misses)

      at Object.debug [as validateLeaveRequest] (src/modules/leaves/hooks/useLeaveValidation.ts:212:17)

    console.debug
      [LeaveValidation] Cache miss (0 hits, 1 misses)

      at Object.debug [as validateLeaveRequest] (src/modules/leaves/hooks/useLeaveValidation.ts:212:17)

    console.debug
      [LeaveValidation] Cache miss (0 hits, 1 misses)

      at Object.debug [as validateLeaveRequest] (src/modules/leaves/hooks/useLeaveValidation.ts:212:17)

    console.debug
      [LeaveValidation] Cache miss (0 hits, 1 misses)

      at Object.debug [as validateLeaveRequest] (src/modules/leaves/hooks/useLeaveValidation.ts:212:17)

    console.debug
      [LeaveValidation] Cache miss (0 hits, 2 misses)

      at Object.debug [as validateLeaveRequest] (src/modules/leaves/hooks/useLeaveValidation.ts:212:17)

    console.debug
      [LeaveValidation] Cache miss (0 hits, 1 misses)

      at Object.debug [as validateLeaveRequest] (src/modules/leaves/hooks/useLeaveValidation.ts:212:17)

    console.debug
      [LeaveValidation] Cache miss (0 hits, 2 misses)

      at Object.debug [as validateLeaveRequest] (src/modules/leaves/hooks/useLeaveValidation.ts:212:17)

    console.debug
      [LeaveValidation] Cache miss (0 hits, 1 misses)

      at Object.debug [as validateLeaveRequest] (src/modules/leaves/hooks/useLeaveValidation.ts:212:17)

    console.debug
      [LeaveValidation] Cache miss (0 hits, 1 misses)

      at Object.debug [as validateLeaveRequest] (src/modules/leaves/hooks/useLeaveValidation.ts:212:17)

PASS src/modules/leaves/utils/__tests__/dateCalculations.test.ts
  ● Console

    console.log
      jest.polyfills.js loaded and applied.

      at Object.<anonymous> (jest.polyfills.js:247:9)

    console.log
      jest.setup.js loaded and mocks applied.

      at Object.log (jest.setup.js:126:9)

PASS src/modules/leaves/services/leaveService.test.ts
  ● Console

    console.log
      jest.polyfills.js loaded and applied.

      at Object.<anonymous> (jest.polyfills.js:247:9)

    console.log
      jest.setup.js loaded and mocks applied.

      at Object.log (jest.setup.js:126:9)

PASS src/modules/leaves/services/__tests__/AuditService.test.ts
  ● Console

    console.log
      jest.polyfills.js loaded and applied.

      at Object.<anonymous> (jest.polyfills.js:247:9)

    console.log
      jest.setup.js loaded and mocks applied.

      at Object.log (jest.setup.js:126:9)

    console.debug
      [EventBusProfiler] Initialized

      at new debug (src/modules/integration/services/EventBusProfiler.ts:77:17)

PASS src/modules/leaves/hooks/useLeaveCalculation.test.ts
  ● Console

    console.log
      jest.polyfills.js loaded and applied.

      at Object.<anonymous> (jest.polyfills.js:247:9)

    console.log
      jest.setup.js loaded and mocks applied.

      at Object.log (jest.setup.js:126:9)

FAIL src/modules/leaves/services/conflictDetectionService.test.ts
  ● Test suite failed to run

    Cannot find module '../../../services/teamService' from 'src/modules/leaves/services/conflictDetectionService.test.ts'

       8 |
       9 | jest.mock('../../../services/userService');
    > 10 | jest.mock('../../../services/teamService');
         |      ^
      11 | jest.mock('../../../utils/performanceLogger');
      12 |
      13 | const MockUserService = UserService as jest.MockedClass<typeof UserService>;

      at Resolver._throwModNotFoundError (node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (src/modules/leaves/services/conflictDetectionService.test.ts:10:6)

PASS src/modules/leaves/hooks/useLeaveListFilteringSorting.test.ts
  ● Console

    console.log
      jest.polyfills.js loaded and applied.

      at Object.<anonymous> (jest.polyfills.js:247:9)

    console.log
      jest.setup.js loaded and mocks applied.

      at Object.log (jest.setup.js:126:9)

PASS src/modules/leaves/components/LeaveRequestForm.test.tsx
  ● Console

    console.log
      jest.polyfills.js loaded and applied.

      at Object.<anonymous> (jest.polyfills.js:247:9)

    console.log
      jest.setup.js loaded and mocks applied.

      at Object.log (jest.setup.js:126:9)

    console.log
      Skipping beforeunload listener setup (not in a browser environment or sendBeacon not supported).

      at log (src/services/errorLoggingService.ts:126:17)

    console.warn
      Accès à prisma depuis le navigateur. Ceci est uniquement pour la référence TypeScript et ne fonctionnera pas.

      74 |     }
      75 |
    > 76 |     console.warn('Accès à prisma depuis le navigateur. Ceci est uniquement pour la référence TypeScript et ne fonctionnera pas.');
         |             ^
      77 | }
      78 |
      79 | export { prismaInstance as prisma }; 

      at Object.warn (src/lib/prisma.ts:76:13)
      at Object.require (src/modules/leaves/services/leaveService.ts:43:1)
      at Object.require (src/modules/leaves/hooks/useLeave.ts:13:1)
      at Object.require (src/modules/leaves/components/LeaveRequestForm.tsx:10:1)
      at Object.<anonymous> (src/modules/leaves/components/LeaveRequestForm.test.tsx:3:1)

    console.log
      Skipping beforeunload listener setup (not in a browser environment or sendBeacon not supported).

      at log (src/services/errorLoggingService.ts:126:17)

    console.warn
      Accès à prisma depuis le navigateur. Ceci est uniquement pour la référence TypeScript et ne fonctionnera pas.

      74 |     }
      75 |
    > 76 |     console.warn('Accès à prisma depuis le navigateur. Ceci est uniquement pour la référence TypeScript et ne fonctionnera pas.');
         |             ^
      77 | }
      78 |
      79 | export { prismaInstance as prisma }; 

      at Object.warn (src/lib/prisma.ts:76:13)
      at Object.require (src/modules/leaves/services/leaveService.ts:43:1)
      at Object.require (src/modules/leaves/hooks/useConflictDetection.ts:8:1)
      at Object.require (src/modules/leaves/components/LeaveRequestForm.tsx:11:1)
      at Object.<anonymous> (src/modules/leaves/components/LeaveRequestForm.test.tsx:3:1)

    console.log
      Skipping beforeunload listener setup (not in a browser environment or sendBeacon not supported).

      at log (src/services/errorLoggingService.ts:126:17)

    console.warn
      Accès à prisma depuis le navigateur. Ceci est uniquement pour la référence TypeScript et ne fonctionnera pas.

      74 |     }
      75 |
    > 76 |     console.warn('Accès à prisma depuis le navigateur. Ceci est uniquement pour la référence TypeScript et ne fonctionnera pas.');
         |             ^
      77 | }
      78 |
      79 | export { prismaInstance as prisma }; 

      at Object.warn (src/lib/prisma.ts:76:13)
      at Object.require (src/modules/leaves/services/leaveService.ts:43:1)
      at Object.require (src/modules/leaves/components/LeaveRequestForm.tsx:12:1)
      at Object.<anonymous> (src/modules/leaves/components/LeaveRequestForm.test.tsx:3:1)

    console.log
      Skipping beforeunload listener setup (not in a browser environment or sendBeacon not supported).

      at log (src/services/errorLoggingService.ts:126:17)

    console.log
      Skipping beforeunload listener setup (not in a browser environment or sendBeacon not supported).

      at log (src/services/errorLoggingService.ts:126:17)

    console.warn
      Accès à prisma depuis le navigateur. Ceci est uniquement pour la référence TypeScript et ne fonctionnera pas.

      74 |     }
      75 |
    > 76 |     console.warn('Accès à prisma depuis le navigateur. Ceci est uniquement pour la référence TypeScript et ne fonctionnera pas.');
         |             ^
      77 | }
      78 |
      79 | export { prismaInstance as prisma }; 

      at Object.warn (src/lib/prisma.ts:76:13)
      at Object.require (src/modules/leaves/services/leaveService.ts:43:1)
      at Object.require (src/modules/leaves/hooks/useLeaveQuota.ts:3:1)
      at Object.require (src/modules/leaves/components/LeaveRequestForm.tsx:20:1)
      at Object.<anonymous> (src/modules/leaves/components/LeaveRequestForm.test.tsx:3:1)

    console.error
      Warning: Each child in a list should have a unique "key" prop.
      
      Check the render method of `LeaveQuotaDisplay`. See https://reactjs.org/link/warning-keys for more information.
          at div
          at quotasByType (/Users/vincentperreard/Mathildanesth/src/modules/leaves/components/LeaveQuotaDisplay.tsx:26:5)
          at div
          at userId (/Users/vincentperreard/Mathildanesth/src/modules/leaves/components/LeaveRequestForm.tsx:42:5)

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at call (node_modules/react/cjs/react-jsx-runtime.development.js:87:30)
      at printWarning (node_modules/react/cjs/react-jsx-runtime.development.js:61:7)
      at error (node_modules/react/cjs/react-jsx-runtime.development.js:1078:5)
      at validateExplicitKey (node_modules/react/cjs/react-jsx-runtime.development.js:1105:11)
      at validateChildKeys (node_modules/react/cjs/react-jsx-runtime.development.js:1277:11)
      at jsxWithValidation (node_modules/react/cjs/react-jsx-runtime.development.js:1320:12)
      at LeaveQuotaDisplay (src/modules/leaves/components/LeaveQuotaDisplay.tsx:93:21)
      at Component (node_modules/react-dom/cjs/react-dom.development.js:15486:18)
      at renderWithHooks (node_modules/react-dom/cjs/react-dom.development.js:20103:13)
      at mountIndeterminateComponent (node_modules/react-dom/cjs/react-dom.development.js:21626:16)
      at beginWork (node_modules/react-dom/cjs/react-dom.development.js:27465:14)
      at beginWork$1 (node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:25777:74)
      at callback (node_modules/react/cjs/react.development.js:2667:24)
      at flushActQueue (node_modules/react/cjs/react.development.js:2582:11)
      at actImplementation (node_modules/@testing-library/react/dist/act-compat.js:47:25)
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:25)
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:292:10)
      at Object.<anonymous> (src/modules/leaves/components/LeaveRequestForm.test.tsx:122:15)

    console.error
      Error: AggregateError
          at Object.dispatchError (/Users/vincentperreard/Mathildanesth/node_modules/jsdom/lib/jsdom/living/xhr/xhr-utils.js:63:19)
          at Request.<anonymous> (/Users/vincentperreard/Mathildanesth/node_modules/jsdom/lib/jsdom/living/xhr/XMLHttpRequest-impl.js:655:18)
          at Request.emit (node:events:530:35)
          at ClientRequest.<anonymous> (/Users/vincentperreard/Mathildanesth/node_modules/jsdom/lib/jsdom/living/helpers/http-request.js:121:14)
          at ClientRequest.emit (node:events:518:28)
          at emitErrorEvent (node:_http_client:103:11)
          at Socket.socketErrorListener (node:_http_client:506:5)
          at Socket.emit (node:events:518:28)
          at emitErrorNT (node:internal/streams/destroy:170:8)
          at emitErrorCloseNT (node:internal/streams/destroy:129:3)
          at processTicksAndRejections (node:internal/process/task_queues:90:21) {
        type: 'XMLHttpRequest'
      }

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at Object.dispatchError (node_modules/jsdom/lib/jsdom/living/xhr/xhr-utils.js:66:53)
      at Request.<anonymous> (node_modules/jsdom/lib/jsdom/living/xhr/XMLHttpRequest-impl.js:655:18)
      at ClientRequest.<anonymous> (node_modules/jsdom/lib/jsdom/living/helpers/http-request.js:121:14)

    console.warn
      [PublicHolidayService] Impossible de récupérer les jours fériés depuis l'API pour l'année 2024. Utilisation du calcul local.



      at PublicHolidayService.getPublicHolidaysForYear (src/modules/leaves/services/publicHolidayService.ts:7441:15)
          at async Promise.all (index 0)
      at PublicHolidayService.preloadData (src/modules/leaves/services/publicHolidayService.ts:7072:7)

    console.error
      Error: AggregateError
          at Object.dispatchError (/Users/vincentperreard/Mathildanesth/node_modules/jsdom/lib/jsdom/living/xhr/xhr-utils.js:63:19)
          at Request.<anonymous> (/Users/vincentperreard/Mathildanesth/node_modules/jsdom/lib/jsdom/living/xhr/XMLHttpRequest-impl.js:655:18)
          at Request.emit (node:events:530:35)
          at ClientRequest.<anonymous> (/Users/vincentperreard/Mathildanesth/node_modules/jsdom/lib/jsdom/living/helpers/http-request.js:121:14)
          at ClientRequest.emit (node:events:518:28)
          at emitErrorEvent (node:_http_client:103:11)
          at Socket.socketErrorListener (node:_http_client:506:5)
          at Socket.emit (node:events:518:28)
          at emitErrorNT (node:internal/streams/destroy:170:8)
          at emitErrorCloseNT (node:internal/streams/destroy:129:3)
          at processTicksAndRejections (node:internal/process/task_queues:90:21) {
        type: 'XMLHttpRequest'
      }

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at Object.dispatchError (node_modules/jsdom/lib/jsdom/living/xhr/xhr-utils.js:66:53)
      at Request.<anonymous> (node_modules/jsdom/lib/jsdom/living/xhr/XMLHttpRequest-impl.js:655:18)
      at ClientRequest.<anonymous> (node_modules/jsdom/lib/jsdom/living/helpers/http-request.js:121:14)

    console.warn
      [PublicHolidayService] Impossible de récupérer les jours fériés depuis l'API pour l'année 2025. Utilisation du calcul local.



      at PublicHolidayService.getPublicHolidaysForYear (src/modules/leaves/services/publicHolidayService.ts:7441:15)
          at async Promise.all (index 1)
      at PublicHolidayService.preloadData (src/modules/leaves/services/publicHolidayService.ts:7072:7)

    console.error
      Error: AggregateError
          at Object.dispatchError (/Users/vincentperreard/Mathildanesth/node_modules/jsdom/lib/jsdom/living/xhr/xhr-utils.js:63:19)
          at Request.<anonymous> (/Users/vincentperreard/Mathildanesth/node_modules/jsdom/lib/jsdom/living/xhr/XMLHttpRequest-impl.js:655:18)
          at Request.emit (node:events:530:35)
          at ClientRequest.<anonymous> (/Users/vincentperreard/Mathildanesth/node_modules/jsdom/lib/jsdom/living/helpers/http-request.js:121:14)
          at ClientRequest.emit (node:events:518:28)
          at emitErrorEvent (node:_http_client:103:11)
          at Socket.socketErrorListener (node:_http_client:506:5)
          at Socket.emit (node:events:518:28)
          at emitErrorNT (node:internal/streams/destroy:170:8)
          at emitErrorCloseNT (node:internal/streams/destroy:129:3)
          at processTicksAndRejections (node:internal/process/task_queues:90:21) {
        type: 'XMLHttpRequest'
      }

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at Object.dispatchError (node_modules/jsdom/lib/jsdom/living/xhr/xhr-utils.js:66:53)
      at Request.<anonymous> (node_modules/jsdom/lib/jsdom/living/xhr/XMLHttpRequest-impl.js:655:18)
      at ClientRequest.<anonymous> (node_modules/jsdom/lib/jsdom/living/helpers/http-request.js:121:14)

    console.warn
      [PublicHolidayService] Impossible de récupérer les jours fériés depuis l'API pour l'année 2026. Utilisation du calcul local.



      at PublicHolidayService.getPublicHolidaysForYear (src/modules/leaves/services/publicHolidayService.ts:7441:15)
          at async Promise.all (index 2)
      at PublicHolidayService.preloadData (src/modules/leaves/services/publicHolidayService.ts:7072:7)

    console.error
      Error: AggregateError
          at Object.dispatchError (/Users/vincentperreard/Mathildanesth/node_modules/jsdom/lib/jsdom/living/xhr/xhr-utils.js:63:19)
          at Request.<anonymous> (/Users/vincentperreard/Mathildanesth/node_modules/jsdom/lib/jsdom/living/xhr/XMLHttpRequest-impl.js:655:18)
          at Request.emit (node:events:530:35)
          at ClientRequest.<anonymous> (/Users/vincentperreard/Mathildanesth/node_modules/jsdom/lib/jsdom/living/helpers/http-request.js:121:14)
          at ClientRequest.emit (node:events:518:28)
          at emitErrorEvent (node:_http_client:103:11)
          at Socket.socketErrorListener (node:_http_client:506:5)
          at Socket.emit (node:events:518:28)
          at emitErrorNT (node:internal/streams/destroy:170:8)
          at emitErrorCloseNT (node:internal/streams/destroy:129:3)
          at processTicksAndRejections (node:internal/process/task_queues:90:21) {
        type: 'XMLHttpRequest'
      }

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at Object.dispatchError (node_modules/jsdom/lib/jsdom/living/xhr/xhr-utils.js:66:53)
      at Request.<anonymous> (node_modules/jsdom/lib/jsdom/living/xhr/XMLHttpRequest-impl.js:655:18)
      at ClientRequest.<anonymous> (node_modules/jsdom/lib/jsdom/living/helpers/http-request.js:121:14)

    console.warn
      [PublicHolidayService] Impossible de récupérer les jours fériés depuis l'API pour l'année 2027. Utilisation du calcul local.



      at PublicHolidayService.getPublicHolidaysForYear (src/modules/leaves/services/publicHolidayService.ts:7441:15)
          at async Promise.all (index 3)
      at PublicHolidayService.preloadData (src/modules/leaves/services/publicHolidayService.ts:7072:7)

PASS src/modules/leaves/components/LeaveCard.test.tsx
  ● Console

    console.log
      jest.polyfills.js loaded and applied.

      at Object.<anonymous> (jest.polyfills.js:247:9)

    console.log
      jest.setup.js loaded and mocks applied.

      at Object.log (jest.setup.js:126:9)

FAIL src/modules/leaves/hooks/__tests__/useConflictDetection.test.ts (5.56 s)
  ● Console

    console.log
      jest.polyfills.js loaded and applied.

      at Object.<anonymous> (jest.polyfills.js:247:9)

    console.log
      jest.setup.js loaded and mocks applied.

      at Object.log (jest.setup.js:126:9)

    console.error
      Erreur dans checkConflicts: Error: Erreur réseau
          at Object.<anonymous> (/Users/vincentperreard/Mathildanesth/src/modules/leaves/hooks/__tests__/useConflictDetection.test.ts:105:27)
          at Promise.then.completed (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/utils.js:231:10)
          at _callCircusTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:316:40)
          at _runTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:252:3)
          at _runTestsForDescribeBlock (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:126:9)
          at _runTestsForDescribeBlock (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:121:9)
          at run (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:71:3)
          at runAndTransformResultsToJestFormat (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
          at jestAdapter (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:74:19)
          at runTestInternal (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/runTest.js:367:16)
          at runTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/runTest.js:444:34)
          at Object.worker (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/testWorker.js:106:12)

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at error (src/modules/leaves/hooks/useConflictDetection.ts:205:25)
      at src/modules/leaves/hooks/useConflictDetection.ts:233:36

  ● useConflictDetection › devrait initialiser correctement l'état et vérifier les conflits

    expect(received).toBe(expected) // Object.is equality

    Expected: false
    Received: true

    Ignored nodes: comments, script, style
    [36m<html>[39m
      [36m<head />[39m
      [36m<body>[39m
        [36m<div />[39m
      [36m</body>[39m
    [36m</html>[39m

      86 |
      87 |         // Attendre la fin du chargement
    > 88 |         await waitFor(() => expect(result.current.loading).toBe(false));
         |                                                            ^
      89 |
      90 |         // Assert : vérifier que la méthode du *service* a été appelée (indirectement par le hook)
      91 |         // Il faut peut-être ajuster ce que le hook passe au service

      at src/modules/leaves/hooks/__tests__/useConflictDetection.test.ts:88:60
      at callback (node_modules/@testing-library/dom/dist/config.js:47:12)
      at checkCallback (node_modules/@testing-library/dom/dist/wait-for.js:124:76)
      at checkCallback (node_modules/@testing-library/dom/dist/wait-for.js:118:16)
      at Timeout.task [as _onTimeout] (node_modules/jsdom/lib/jsdom/browser/Window.js:520:19)

  ● useConflictDetection - resolveConflict › devrait appeler le service (indirectement) et mettre à jour l'état après résolution

    expect(received).toBe(expected) // Object.is equality

    Expected: false
    Received: true

    Ignored nodes: comments, script, style
    [36m<html>[39m
      [36m<head />[39m
      [36m<body>[39m
        [36m<div />[39m
      [36m</body>[39m
    [36m</html>[39m

      160 |         // Charger les conflits initiaux en appelant checkConflicts avec des objets Date
      161 |         act(() => { result.current.checkConflicts(mockStartDateObj, mockEndDateObj); });
    > 162 |         await waitFor(() => expect(result.current.loading).toBe(false));
          |                                                            ^
      163 |         expect(result.current.conflicts).toEqual(initialConflictsResult.conflicts);
      164 |         expect(result.current.hasBlockingConflicts).toBe(true);
      165 |

      at src/modules/leaves/hooks/__tests__/useConflictDetection.test.ts:162:60
      at callback (node_modules/@testing-library/dom/dist/config.js:47:12)
      at checkCallback (node_modules/@testing-library/dom/dist/wait-for.js:124:76)
      at checkCallback (node_modules/@testing-library/dom/dist/wait-for.js:118:16)
      at Timeout.task [as _onTimeout] (node_modules/jsdom/lib/jsdom/browser/Window.js:520:19)

  ● useConflictDetection - resolveConflict › devrait gérer les erreurs lors de la résolution

    expect(received).toBe(expected) // Object.is equality

    Expected: false
    Received: true

    Ignored nodes: comments, script, style
    [36m<html>[39m
      [36m<head />[39m
      [36m<body>[39m
        [36m<div />[39m
      [36m</body>[39m
    [36m</html>[39m

      202 |         // Charger les conflits initiaux en appelant checkConflicts avec des objets Date
      203 |         act(() => { result.current.checkConflicts(mockStartDateObj, mockEndDateObj); });
    > 204 |         await waitFor(() => expect(result.current.loading).toBe(false));
          |                                                            ^
      205 |
      206 |         // Act : Appeler resolveConflict du hook. On s'attend à ce qu'il échoue.
      207 |         // Pour simuler l'échec, on pourrait mocker une dépendance ou modifier le hook

      at src/modules/leaves/hooks/__tests__/useConflictDetection.test.ts:204:60
      at callback (node_modules/@testing-library/dom/dist/config.js:47:12)
      at checkCallback (node_modules/@testing-library/dom/dist/wait-for.js:124:76)
      at checkCallback (node_modules/@testing-library/dom/dist/wait-for.js:118:16)
      at Timeout.task [as _onTimeout] (node_modules/jsdom/lib/jsdom/browser/Window.js:520:19)

  ● useConflictDetection - getConflictsByType › devrait filtrer les conflits par type

    expect(received).toBe(expected) // Object.is equality

    Expected: false
    Received: true

    Ignored nodes: comments, script, style
    [36m<html>[39m
      [36m<head />[39m
      [36m<body>[39m
        [36m<div />[39m
      [36m</body>[39m
    [36m</html>[39m

      244 |         // Charger les conflits en appelant checkConflicts avec des objets Date
      245 |         act(() => { result.current.checkConflicts(mockStartDateObj, mockEndDateObj); });
    > 246 |         await waitFor(() => expect(result.current.loading).toBe(false));
          |                                                            ^
      247 |
      248 |         // Act & Assert : Appeler getConflictsByType du *hook*
      249 |         expect(result.current.getConflictsByType(ConflictType.USER_LEAVE_OVERLAP)).toEqual([mockConflicts[0]]);

      at src/modules/leaves/hooks/__tests__/useConflictDetection.test.ts:246:60
      at callback (node_modules/@testing-library/dom/dist/config.js:47:12)
      at checkCallback (node_modules/@testing-library/dom/dist/wait-for.js:124:76)
      at checkCallback (node_modules/@testing-library/dom/dist/wait-for.js:118:16)
      at Timeout.task [as _onTimeout] (node_modules/jsdom/lib/jsdom/browser/Window.js:520:19)

PASS src/modules/leaves/components/LeavesList.test.tsx
  ● Console

    console.log
      jest.polyfills.js loaded and applied.

      at Object.<anonymous> (jest.polyfills.js:247:9)

    console.log
      jest.setup.js loaded and mocks applied.

      at Object.log (jest.setup.js:126:9)

    console.log
      Temps de rendu pour 100 congés: 92.79433400000016ms

      at Object.<anonymous> (src/modules/leaves/components/LeavesList.test.tsx:1000:17)

    console.log
      Pagination non détectée, vérification de base uniquement

      at Object.<anonymous> (src/modules/leaves/components/LeavesList.test.tsx:1199:25)

FAIL src/modules/leaves/components/UserLeaveBalance.test.tsx (6.405 s)
  ● Console

    console.log
      jest.polyfills.js loaded and applied.

      at Object.<anonymous> (jest.polyfills.js:247:9)

    console.log
      jest.setup.js loaded and mocks applied.

      at Object.log (jest.setup.js:126:9)

    console.error
      Erreur lors du chargement des soldes de congés: Error: Network error
          at Object.<anonymous> (/Users/vincentperreard/Mathildanesth/src/modules/leaves/components/UserLeaveBalance.test.tsx:97:47)
          at Promise.then.completed (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/utils.js:231:10)
          at _callCircusTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:316:40)
          at _runTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:252:3)
          at _runTestsForDescribeBlock (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:126:9)
          at _runTestsForDescribeBlock (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:121:9)
          at run (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:71:3)
          at runAndTransformResultsToJestFormat (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
          at jestAdapter (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:74:19)
          at runTestInternal (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/runTest.js:367:16)
          at runTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/runTest.js:444:34)
          at Object.worker (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/testWorker.js:106:12)

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at error (src/modules/leaves/components/UserLeaveBalance.tsx:47:25)

  ● UserLeaveBalance Component › affiche correctement les soldes de congés

    Unable to find an element with the text: Congé Annuel. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<div[39m
          [33mclass[39m=[32m"rounded-lg border bg-card text-card-foreground shadow-sm dark:bg-slate-800 dark:border-slate-700 w-full"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"flex flex-col space-y-1.5 p-6"[39m
          [36m>[39m
            [36m<h3[39m
              [33mclass[39m=[32m"font-semibold tracking-tight bg-gradient-to-r from-primary-600 via-secondary-600 to-tertiary-600 bg-clip-text text-transparent text-lg"[39m
              [33mstyle[39m=[32m"background-clip: text;"[39m
            [36m>[39m
              [0mChargement des soldes...[0m
            [36m</h3>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"p-6 pt-0"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"space-y-3"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"animate-pulse rounded-md bg-muted h-4 w-full"[39m
              [36m/>[39m
              [36m<div[39m
                [33mclass[39m=[32m"animate-pulse rounded-md bg-muted h-4 w-full"[39m
              [36m/>[39m
              [36m<div[39m
                [33mclass[39m=[32m"animate-pulse rounded-md bg-muted h-4 w-full"[39m
              [36m/>[39m
            [36m</div>[39m
          [36m</div>[39m
        [36m</div>[39m
      [36m</div>[39m
    [36m</body>[39m

      74 |
      75 |         expectToBeInDocument(screen.getByText('Chargement des soldes...'));
    > 76 |         await waitFor(() => {
         |                      ^
      77 |             expectToBeInDocument(screen.getByText('Congé Annuel'));
      78 |         });
      79 |

      at waitForWrapper (node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at Object.<anonymous> (src/modules/leaves/components/UserLeaveBalance.test.tsx:76:22)

  ● UserLeaveBalance Component › affiche un message d'erreur si le chargement échoue

    Unable to find an element with the text: Erreur. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<div[39m
          [33mclass[39m=[32m"rounded-lg border bg-card text-card-foreground shadow-sm dark:bg-slate-800 dark:border-slate-700 w-full"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"flex flex-col space-y-1.5 p-6"[39m
          [36m>[39m
            [36m<h3[39m
              [33mclass[39m=[32m"font-semibold tracking-tight bg-gradient-to-r from-primary-600 via-secondary-600 to-tertiary-600 bg-clip-text text-transparent text-lg"[39m
              [33mstyle[39m=[32m"background-clip: text;"[39m
            [36m>[39m
              [0mChargement des soldes...[0m
            [36m</h3>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"p-6 pt-0"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"space-y-3"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"animate-pulse rounded-md bg-muted h-4 w-full"[39m
              [36m/>[39m
              [36m<div[39m
                [33mclass[39m=[32m"animate-pulse rounded-md bg-muted h-4 w-full"[39m
              [36m/>[39m
              [36m<div[39m
                [33mclass[39m=[32m"animate-pulse rounded-md bg-muted h-4 w-full"[39m
              [36m/>[39m
            [36m</div>[39m
          [36m</div>[39m
        [36m</div>[39m
      [36m</div>[39m
    [36m</body>[39m

       97 |         mockedAxios.get.mockRejectedValueOnce(new Error('Network error'));
       98 |         render(<UserLeaveBalance userId={123} />);
    >  99 |         await waitFor(() => {
          |                      ^
      100 |             expectToBeInDocument(screen.getByText('Erreur'));
      101 |         });
      102 |         expectToBeInDocument(screen.getByText('Impossible de charger les soldes de congés'));

      at waitForWrapper (node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at Object.<anonymous> (src/modules/leaves/components/UserLeaveBalance.test.tsx:99:22)

  ● UserLeaveBalance Component › affiche un message si aucun solde n'est disponible

    Unable to find an element with the text: Aucun solde disponible. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<div[39m
          [33mclass[39m=[32m"rounded-lg border bg-card text-card-foreground shadow-sm dark:bg-slate-800 dark:border-slate-700 w-full"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"flex flex-col space-y-1.5 p-6"[39m
          [36m>[39m
            [36m<h3[39m
              [33mclass[39m=[32m"font-semibold tracking-tight bg-gradient-to-r from-primary-600 via-secondary-600 to-tertiary-600 bg-clip-text text-transparent text-lg"[39m
              [33mstyle[39m=[32m"background-clip: text;"[39m
            [36m>[39m
              [0mChargement des soldes...[0m
            [36m</h3>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"p-6 pt-0"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"space-y-3"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"animate-pulse rounded-md bg-muted h-4 w-full"[39m
              [36m/>[39m
              [36m<div[39m
                [33mclass[39m=[32m"animate-pulse rounded-md bg-muted h-4 w-full"[39m
              [36m/>[39m
              [36m<div[39m
                [33mclass[39m=[32m"animate-pulse rounded-md bg-muted h-4 w-full"[39m
              [36m/>[39m
            [36m</div>[39m
          [36m</div>[39m
        [36m</div>[39m
      [36m</div>[39m
    [36m</body>[39m

      106 |         mockedAxios.get.mockResolvedValueOnce({ data: [] });
      107 |         render(<UserLeaveBalance userId={123} />);
    > 108 |         await waitFor(() => {
          |                      ^
      109 |             expectToBeInDocument(screen.getByText('Aucun solde disponible'));
      110 |         });
      111 |     });

      at waitForWrapper (node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at Object.<anonymous> (src/modules/leaves/components/UserLeaveBalance.test.tsx:108:22)

  ● UserLeaveBalance Component › respecte l'option compact=true en masquant les détails

    Unable to find an element with the text: Congé Annuel. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<div[39m
          [33mclass[39m=[32m"rounded-lg border bg-card text-card-foreground shadow-sm dark:bg-slate-800 dark:border-slate-700 w-full"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"flex flex-col space-y-1.5 p-6"[39m
          [36m>[39m
            [36m<h3[39m
              [33mclass[39m=[32m"font-semibold tracking-tight bg-gradient-to-r from-primary-600 via-secondary-600 to-tertiary-600 bg-clip-text text-transparent text-lg"[39m
              [33mstyle[39m=[32m"background-clip: text;"[39m
            [36m>[39m
              [0mChargement des soldes...[0m
            [36m</h3>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"p-6 pt-0"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"space-y-3"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"animate-pulse rounded-md bg-muted h-4 w-full"[39m
              [36m/>[39m
              [36m<div[39m
                [33mclass[39m=[32m"animate-pulse rounded-md bg-muted h-4 w-full"[39m
              [36m/>[39m
              [36m<div[39m
                [33mclass[39m=[32m"animate-pulse rounded-md bg-muted h-4 w-full"[39m
              [36m/>[39m
            [36m</div>[39m
          [36m</div>[39m
        [36m</div>[39m
      [36m</div>[39m
    [36m</body>[39m

      114 |         mockedAxios.get.mockResolvedValueOnce({ data: mockBalanceData });
      115 |         render(<UserLeaveBalance userId={123} compact={true} />);
    > 116 |         await waitFor(() => {
          |                      ^
      117 |             expectToBeInDocument(screen.getByText('Congé Annuel'));
      118 |         });
      119 |         expectToBeInDocument(screen.getByText('15.5 jours'));

      at waitForWrapper (node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at Object.<anonymous> (src/modules/leaves/components/UserLeaveBalance.test.tsx:116:22)

  ● UserLeaveBalance Component › respecte l'option hideHeader=true

    Unable to find an element with the text: Congé Annuel. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<div[39m
          [33mclass[39m=[32m"rounded-lg border bg-card text-card-foreground shadow-sm dark:bg-slate-800 dark:border-slate-700 w-full"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"p-6 pt-0"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"space-y-3"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"animate-pulse rounded-md bg-muted h-4 w-full"[39m
              [36m/>[39m
              [36m<div[39m
                [33mclass[39m=[32m"animate-pulse rounded-md bg-muted h-4 w-full"[39m
              [36m/>[39m
              [36m<div[39m
                [33mclass[39m=[32m"animate-pulse rounded-md bg-muted h-4 w-full"[39m
              [36m/>[39m
            [36m</div>[39m
          [36m</div>[39m
        [36m</div>[39m
      [36m</div>[39m
    [36m</body>[39m

      126 |         mockedAxios.get.mockResolvedValueOnce({ data: mockBalanceData });
      127 |         render(<UserLeaveBalance userId={123} hideHeader={true} />);
    > 128 |         await waitFor(() => {
          |                      ^
      129 |             expectToBeInDocument(screen.getByText('Congé Annuel'));
      130 |         });
      131 |         expectNotToBeInDocument(screen.queryByText('Soldes de congés'));

      at waitForWrapper (node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at Object.<anonymous> (src/modules/leaves/components/UserLeaveBalance.test.tsx:128:22)

FAIL src/modules/leaves/components/LeaveForm.test.tsx (12.829 s)
  ● Console

    console.log
      jest.polyfills.js loaded and applied.

      at Object.<anonymous> (jest.polyfills.js:247:9)

    console.log
      jest.setup.js loaded and mocks applied.

      at Object.log (jest.setup.js:126:9)

    console.warn
      [PublicHolidayService] Impossible de récupérer les jours fériés depuis l'API pour l'année 2024. Utilisation du calcul local.

      283 |             return holidays;
      284 |         } catch (error) {
    > 285 |             console.warn(`[PublicHolidayService] Impossible de récupérer les jours fériés depuis l'API pour l'année ${year}. Utilisation du calcul local.`);
          |                     ^
      286 |
      287 |             // Générer les jours fériés français en local
      288 |             const holidays = this.calculateFrenchPublicHolidays(year);

      at PublicHolidayService.warn [as getPublicHolidaysForYear] (src/modules/leaves/services/publicHolidayService.ts:285:21)
          at async Promise.all (index 0)
      at PublicHolidayService.preloadData (src/modules/leaves/services/publicHolidayService.ts:89:13)

    console.warn
      [PublicHolidayService] Impossible de récupérer les jours fériés depuis l'API pour l'année 2025. Utilisation du calcul local.

      283 |             return holidays;
      284 |         } catch (error) {
    > 285 |             console.warn(`[PublicHolidayService] Impossible de récupérer les jours fériés depuis l'API pour l'année ${year}. Utilisation du calcul local.`);
          |                     ^
      286 |
      287 |             // Générer les jours fériés français en local
      288 |             const holidays = this.calculateFrenchPublicHolidays(year);

      at PublicHolidayService.warn [as getPublicHolidaysForYear] (src/modules/leaves/services/publicHolidayService.ts:285:21)
          at async Promise.all (index 1)
      at PublicHolidayService.preloadData (src/modules/leaves/services/publicHolidayService.ts:89:13)

    console.warn
      [PublicHolidayService] Impossible de récupérer les jours fériés depuis l'API pour l'année 2026. Utilisation du calcul local.

      283 |             return holidays;
      284 |         } catch (error) {
    > 285 |             console.warn(`[PublicHolidayService] Impossible de récupérer les jours fériés depuis l'API pour l'année ${year}. Utilisation du calcul local.`);
          |                     ^
      286 |
      287 |             // Générer les jours fériés français en local
      288 |             const holidays = this.calculateFrenchPublicHolidays(year);

      at PublicHolidayService.warn [as getPublicHolidaysForYear] (src/modules/leaves/services/publicHolidayService.ts:285:21)
          at async Promise.all (index 2)
      at PublicHolidayService.preloadData (src/modules/leaves/services/publicHolidayService.ts:89:13)

    console.warn
      [PublicHolidayService] Impossible de récupérer les jours fériés depuis l'API pour l'année 2027. Utilisation du calcul local.

      283 |             return holidays;
      284 |         } catch (error) {
    > 285 |             console.warn(`[PublicHolidayService] Impossible de récupérer les jours fériés depuis l'API pour l'année ${year}. Utilisation du calcul local.`);
          |                     ^
      286 |
      287 |             // Générer les jours fériés français en local
      288 |             const holidays = this.calculateFrenchPublicHolidays(year);

      at PublicHolidayService.warn [as getPublicHolidaysForYear] (src/modules/leaves/services/publicHolidayService.ts:285:21)
          at async Promise.all (index 3)
      at PublicHolidayService.preloadData (src/modules/leaves/services/publicHolidayService.ts:89:13)

    console.error
      Erreur lors du chargement des types de congés: Error: Failed to fetch types
          at Object.<anonymous> (/Users/vincentperreard/Mathildanesth/src/modules/leaves/components/LeaveForm.test.tsx:258:55)
          at Promise.then.completed (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/utils.js:298:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/utils.js:231:10)
          at _callCircusTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:316:40)
          at _runTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:252:3)
          at _runTestsForDescribeBlock (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:126:9)
          at _runTestsForDescribeBlock (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:121:9)
          at run (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/run.js:71:3)
          at runAndTransformResultsToJestFormat (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
          at jestAdapter (/Users/vincentperreard/Mathildanesth/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:74:19)
          at runTestInternal (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/runTest.js:367:16)
          at runTest (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/runTest.js:444:34)
          at Object.worker (/Users/vincentperreard/Mathildanesth/node_modules/jest-runner/build/testWorker.js:106:12)

       99 |     return;
      100 |   }
    > 101 |   originalConsoleError(...args);
          |   ^
      102 | };
      103 |
      104 | // Mocks globaux supplémentaires

      at console.originalConsoleError [as error] (jest.setup.js:101:3)
      at error (src/modules/leaves/components/LeaveForm.tsx:196:25)

  ● LeaveForm › should handle error when loading leave types

    Unable to find an element with the display value: Erreur de chargement.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<form[39m
          [33mclass[39m=[32m"space-y-6 max-w-2xl mx-auto"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"bg-gradient-to-r from-indigo-50 to-blue-50 p-4 rounded-lg shadow-sm mb-6"[39m
          [36m>[39m
            [36m<h3[39m
              [33mclass[39m=[32m"text-lg font-medium text-gray-800 mb-2"[39m
            [36m>[39m
              [0mNouvelle demande de congé[0m
            [36m</h3>[39m
            [36m<p[39m
              [33mclass[39m=[32m"text-sm text-gray-600"[39m
            [36m>[39m
              [0mComplétez le formulaire ci-dessous pour soumettre votre demande.[0m
            [36m</p>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"bg-white p-6 rounded-lg shadow-md border border-gray-200"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"mb-6"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"flex items-center justify-between"[39m
              [36m>[39m
                [36m<label[39m
                  [33mclass[39m=[32m"block text-sm font-medium text-gray-700"[39m
                  [33mfor[39m=[32m"leaveType"[39m
                [36m>[39m
                  [0mType de congé[0m
                [36m</label>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"relative inline-block"[39m
                [36m>[39m
                  [36m<span[39m
                    [33mclass[39m=[32m"text-gray-400 hover:text-gray-600 cursor-help"[39m
                  [36m>[39m
                    [36m<svg[39m
                      [33maria-hidden[39m=[32m"true"[39m
                      [33mclass[39m=[32m"lucide lucide-circle-help h-4 w-4"[39m
                      [33mfill[39m=[32m"none"[39m
                      [33mheight[39m=[32m"24"[39m
                      [33mstroke[39m=[32m"currentColor"[39m
                      [33mstroke-linecap[39m=[32m"round"[39m
                      [33mstroke-linejoin[39m=[32m"round"[39m
                      [33mstroke-width[39m=[32m"2"[39m
                      [33mviewBox[39m=[32m"0 0 24 24"[39m
                      [33mwidth[39m=[32m"24"[39m
                      [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
                    [36m>[39m
                      [36m<circle[39m
                        [33mcx[39m=[32m"12"[39m
                        [33mcy[39m=[32m"12"[39m
                        [33mr[39m=[32m"10"[39m
                      [36m/>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"[39m
                      [36m/>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M12 17h.01"[39m
                      [36m/>[39m
                    [36m</svg>[39m
                  [36m</span>[39m
                [36m</div>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mclass[39m=[32m"mt-1 relative"[39m
              [36m>[39m
                [36m<select[39m
                  [33mclass[39m=[32m"block w-full rounded-md border-gray-300 shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm py-2 px-3"[39m
                  [33mdisabled[39m=[32m""[39m
                  [33mid[39m=[32m"leaveType"[39m
                  [33mname[39m=[32m"leaveType"[39m
                  [33mrequired[39m=[32m""[39m
                [36m>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m""[39m
                  [36m>[39m
                    [0mChargement...[0m
                  [36m</option>[39m
                [36m</select>[39m
              [36m</div>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mclass[39m=[32m"grid grid-cols-1 gap-6 md:grid-cols-2 mb-6"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"relative"[39m
              [36m>[39m
                [36m<label[39m
                  [33mclass[39m=[32m"block text-sm font-medium text-gray-700 mb-1"[39m
                  [33mfor[39m=[32m"startDate"[39m
                [36m>[39m
                  [0mDate de début[0m
                [36m</label>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"relative"[39m
                [36m>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"react-datepicker-wrapper"[39m
                  [36m>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"react-datepicker__input-container"[39m
                    [36m>[39m
                      [36m<input[39m
                        [33mautocomplete[39m=[32m"off"[39m
                        [33mclass[39m=[32m"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 pl-10 pr-4 py-2 disabled:bg-gray-100 disabled:cursor-not-allowed"[39m
                        [33mid[39m=[32m"startDate"[39m
                        [33mplaceholder[39m=[32m"Sélectionner une date"[39m
                        [33mtype[39m=[32m"text"[39m
                        [33mvalue[39m=[32m""[39m
                      [36m/>[39m
                    [36m</div>[39m
                  [36m</div>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"[39m
                  [36m>[39m
                    [36m<svg[39m
                      [33maria-hidden[39m=[32m"true"[39m
                      [33mclass[39m=[32m"lucide lucide-calendar h-5 w-5 text-gray-400"[39m
                      [33mfill[39m=[32m"none"[39m
                      [33mheight[39m=[32m"24"[39m
                      [33mstroke[39m=[32m"currentColor"[39m
                      [33mstroke-linecap[39m=[32m"round"[39m
                      [33mstroke-linejoin[39m=[32m"round"[39m
                      [33mstroke-width[39m=[32m"2"[39m
                      [33mviewBox[39m=[32m"0 0 24 24"[39m
                      [33mwidth[39m=[32m"24"[39m
                      [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
                    [36m>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M8 2v4"[39m
                      [36m/>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M16 2v4"[39m
                      [36m/>[39m
                      [36m<rect[39m
                        [33mheight[39m=[32m"18"[39m
                        [33mrx[39m=[32m"2"[39m
                        [33mwidth[39m=[32m"18"[39m
                        [33mx[39m=[32m"3"[39m
                        [33my[39m=[32m"4"[39m
                      [36m/>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M3 10h18"[39m
                      [36m/>[39m
                    [36m</svg>[39m
                  [36m</div>[39m
                [36m</div>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mclass[39m=[32m"relative"[39m
              [36m>[39m
                [36m<label[39m
                  [33mclass[39m=[32m"block text-sm font-medium text-gray-700 mb-1"[39m
                  [33mfor[39m=[32m"endDate"[39m
                [36m>[39m
                  [0mDate de fin[0m
                [36m</label>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"relative"[39m
                [36m>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"react-datepicker-wrapper"[39m
                  [36m>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"react-datepicker__input-container"[39m
                    [36m>[39m
                      [36m<input[39m
                        [33mautocomplete[39m=[32m"off"[39m
                        [33mclass[39m=[32m"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 pl-10 pr-4 py-2 disabled:bg-gray-100 disabled:cursor-not-allowed"[39m
                        [33mid[39m=[32m"endDate"[39m
                        [33mplaceholder[39m=[32m"Sélectionner une date"[39m
                        [33mtype[39m=[32m"text"[39m
                        [33mvalue[39m=[32m""[39m
                      [36m/>[39m
                    [36m</div>[39m
                  [36m</div>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"[39m
                  [36m>[39m
                    [36m<svg[39m
                      [33maria-hidden[39m=[32m"true"[39m
                      [33mclass[39m=[32m"lucide lucide-calendar h-5 w-5 text-gray-400"[39m
                      [33mfill[39m=[32m"none"[39m
                      [33mheight[39m=[32m"24"[39m
                      [33mstroke[39m=[32m"currentColor"[39m
                      [33mstroke-linecap[39m=[32m"round"[39m
                      [33mstroke-linejoin[39m=[32m"round"[39m
                      [33mstroke-width[39m=[32m"2"[39m
                      [33mviewBox[39m=[32m"0 0 24 24"[39m
                      [33mwidth[39m=[32m"24"[39m
                      [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
                    [36m>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M8 2v4"[39m
                      [36m/>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M16 2v4"[39m
                      [36m/>[39m
                      [36m<rect[39m
                        [33mheight[39m=[32m"18"[39m
                        [33mrx[39m=[32m"2"[39m
                        [33mwidth[39m=[32m"18"[39m
                        [33mx[39m=[32m"3"[39m
                        [33my[39m=[32m"4"[39m
                      [36m/>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M3 10h18"[39m
                      [36m/>[39m
                    [36m</svg>[39m
                  [36m</div>[39m
                [36m</div>[39m
              [36m</div>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mclass[39m=[32m"mb-6"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"flex flex-col space-y-4 p-4 bg-gray-50 rounded-md border border-gray-200"[39m
              [36m>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"flex items-center"[39m
                [36m>[39m
                  [36m<input[39m
                    [33mclass[39m=[32m"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"[39m
                    [33mdisabled[39m=[32m""[39m
                    [33mid[39m=[32m"isHalfDay"[39m
                    [33mname[39m=[32m"isHalfDay"[39m
                    [33mtype[39m=[32m"checkbox"[39m
                  [36m/>[39m
                  [36m<label[39m
                    [33mclass[39m=[32m"ml-2 block text-sm font-medium text-gray-700"[39m
                    [33mfor[39m=[32m"isHalfDay"[39m
                  [36m>[39m
                    [0mDemi-journée[0m
                  [36m</label>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"relative inline-block"[39m
                  [36m>[39m
                    [36m<span[39m
                      [33mclass[39m=[32m"text-gray-400 hover:text-gray-600 cursor-help ml-1"[39m
                    [36m>[39m
                      [36m<svg[39m
                        [33maria-hidden[39m=[32m"true"[39m
                        [33mclass[39m=[32m"lucide lucide-circle-help h-4 w-4"[39m
                        [33mfill[39m=[32m"none"[39m
                        [33mheight[39m=[32m"24"[39m
                        [33mstroke[39m=[32m"currentColor"[39m
                        [33mstroke-linecap[39m=[32m"round"[39m
                        [33mstroke-linejoin[39m=[32m"round"[39m
                        [33mstroke-width[39m=[32m"2"[39m
                        [33mviewBox[39m=[32m"0 0 24 24"[39m
                        [33mwidth[39m=[32m"24"[39m
                        [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
                      [36m>[39m
                        [36m<circle[39m
                          [33mcx[39m=[32m"12"[39m
                          [33mcy[39m=[32m"12"[39m
                          [33mr[39m=[32m"10"[39m
                        [36m/>[39m
                        [36m<path[39m
                          [33md[39m=[32m"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"[39m
                        [36m/>[39m
                        [36m<path[39m
                          [33md[39m=[32m"M12 17h.01"[39m
                        [36m/>[39m
                      [36m</svg>[39m
                    [36m</span>[39m
                  [36m</div>[39m
                [36m</div>[39m
              [36m</div>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mclass[39m=[32m"space-y-3 mb-6"[39m
            [36m/>[39m
            [36m<div[39m
              [33mclass[39m=[32m"mb-6"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"flex items-center justify-between"[39m
              [36m>[39m
                [36m<label[39m
                  [33mclass[39m=[32m"block text-sm font-medium text-gray-700"[39m
                  [33mfor[39m=[32m"reason"[39m
                [36m>[39m
                  [0mMotif (optionnel)[0m
                [36m</label>[39m
                [36m<span[39m
                  [33mclass[39m=[32m"text-xs text-gray-500"[39m
                [36m>[39m
                  [0mMax. 200 caractères[0m
                [36m</span>[39m
              [36m</div>[39m
              [36m<textarea[39m
                [33mclass[39m=[32m"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"[39m
                [33mid[39m=[32m"reason"[39m
                [33mmaxlength[39m=[32m"200"[39m
                [33mname[39m=[32m"reason"[39m
                [33mplaceholder[39m=[32m"Précisez le motif de votre demande si nécessaire..."[39m
                [33mrows[39m=[32m"3"[39m
              [36m/>[39m
            [36m</div>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"flex justify-end mt-8"[39m
          [36m>[39m
            [36m<button[39m
              [33mclass[39m=[32m"inline-flex items-center justify-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-60 disabled:cursor-not-allowed transition-opacity"[39m
              [33mdisabled[39m=[32m""[39m
              [33mtype[39m=[32m"submit"[39m
            [36m>[39m
              [0mSoumettre la demande[0m
            [36m</button>[39m
          [36m</div>[39m
        [36m</form>[39m
      [36m</div>[39m
    [36m</body>[39m

      258 |         (global.fetch as jest.Mock).mockRejectedValue(new Error('Failed to fetch types'));
      259 |         renderTheForm();
    > 260 |         await waitFor(() => {
          |                      ^
      261 |             expectToBeInDocument(screen.getByDisplayValue('Erreur de chargement'));
      262 |         });
      263 |     });

      at waitForWrapper (node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at Object.<anonymous> (src/modules/leaves/components/LeaveForm.test.tsx:260:22)

  ● LeaveForm › should call useLeaveCalculation with initial dates and options

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: {"endDate": null, "options": {"countHalfDays": false, "halfDayPeriod": undefined}, "startDate": null}
    Received
           1
              Object {
                "endDate": null,
                "options": Object {
            -     "countHalfDays": false,
                  "halfDayPeriod": undefined,
            +     "isHalfDay": false,
                },
                "startDate": null,
              },
           2
              Object {
                "endDate": null,
                "options": Object {
            -     "countHalfDays": false,
                  "halfDayPeriod": undefined,
            +     "isHalfDay": false,
                },
                "startDate": null,
              },

    Number of calls: 2

      45 |  */
      46 | export function expectToHaveBeenCalledWith(mockFn: MockFn, ...args: any[]): void {
    > 47 |     expect(mockFn).toHaveBeenCalledWith(...args);
         |                    ^
      48 | }
      49 |
      50 | /**

      at toHaveBeenCalledWith (src/tests/utils/assertions.ts:47:20)
      at Object.<anonymous> (src/modules/leaves/components/LeaveForm.test.tsx:267:35)

  ● LeaveForm › should update useLeaveCalculation when dates change

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: {"endDate": null, "options": {"countHalfDays": false, "halfDayPeriod": undefined}, "startDate": null}
    Received
           1
              Object {
                "endDate": null,
                "options": Object {
            -     "countHalfDays": false,
                  "halfDayPeriod": undefined,
            +     "isHalfDay": false,
                },
                "startDate": null,
              },
           2
              Object {
                "endDate": null,
                "options": Object {
            -     "countHalfDays": false,
                  "halfDayPeriod": undefined,
            +     "isHalfDay": false,
                },
                "startDate": null,
              },

    Number of calls: 2

      45 |  */
      46 | export function expectToHaveBeenCalledWith(mockFn: MockFn, ...args: any[]): void {
    > 47 |     expect(mockFn).toHaveBeenCalledWith(...args);
         |                    ^
      48 | }
      49 |
      50 | /**

      at toHaveBeenCalledWith (src/tests/utils/assertions.ts:47:20)
      at Object.<anonymous> (src/modules/leaves/components/LeaveForm.test.tsx:280:35)

  ● LeaveForm › should handle half-day selection

    expect(element).toBeChecked()

    Received element is not checked:
      <input class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded" disabled="" id="isHalfDay" name="isHalfDay" type="checkbox" />

      73 |  */
      74 | export function expectToBeChecked(element: HTMLElement | null | undefined): void {
    > 75 |     expect(element).toBeChecked();
         |                     ^
      76 | }
      77 |
      78 | /**

      at toBeChecked (src/tests/utils/assertions.ts:75:21)
      at Object.<anonymous> (src/modules/leaves/components/LeaveForm.test.tsx:346:26)

  ● LeaveForm › should validate form on submit and show errors if invalid

    Unable to find an element with the text: La date de début est requise.. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<form[39m
          [33mclass[39m=[32m"space-y-6 max-w-2xl mx-auto"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"bg-gradient-to-r from-indigo-50 to-blue-50 p-4 rounded-lg shadow-sm mb-6"[39m
          [36m>[39m
            [36m<h3[39m
              [33mclass[39m=[32m"text-lg font-medium text-gray-800 mb-2"[39m
            [36m>[39m
              [0mNouvelle demande de congé[0m
            [36m</h3>[39m
            [36m<p[39m
              [33mclass[39m=[32m"text-sm text-gray-600"[39m
            [36m>[39m
              [0mComplétez le formulaire ci-dessous pour soumettre votre demande.[0m
            [36m</p>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"bg-white p-6 rounded-lg shadow-md border border-gray-200"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"mb-6"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"flex items-center justify-between"[39m
              [36m>[39m
                [36m<label[39m
                  [33mclass[39m=[32m"block text-sm font-medium text-gray-700"[39m
                  [33mfor[39m=[32m"leaveType"[39m
                [36m>[39m
                  [0mType de congé[0m
                [36m</label>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"relative inline-block"[39m
                [36m>[39m
                  [36m<span[39m
                    [33mclass[39m=[32m"text-gray-400 hover:text-gray-600 cursor-help"[39m
                  [36m>[39m
                    [36m<svg[39m
                      [33maria-hidden[39m=[32m"true"[39m
                      [33mclass[39m=[32m"lucide lucide-circle-help h-4 w-4"[39m
                      [33mfill[39m=[32m"none"[39m
                      [33mheight[39m=[32m"24"[39m
                      [33mstroke[39m=[32m"currentColor"[39m
                      [33mstroke-linecap[39m=[32m"round"[39m
                      [33mstroke-linejoin[39m=[32m"round"[39m
                      [33mstroke-width[39m=[32m"2"[39m
                      [33mviewBox[39m=[32m"0 0 24 24"[39m
                      [33mwidth[39m=[32m"24"[39m
                      [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
                    [36m>[39m
                      [36m<circle[39m
                        [33mcx[39m=[32m"12"[39m
                        [33mcy[39m=[32m"12"[39m
                        [33mr[39m=[32m"10"[39m
                      [36m/>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"[39m
                      [36m/>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M12 17h.01"[39m
                      [36m/>[39m
                    [36m</svg>[39m
                  [36m</span>[39m
                [36m</div>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mclass[39m=[32m"mt-1 relative"[39m
              [36m>[39m
                [36m<select[39m
                  [33mclass[39m=[32m"block w-full rounded-md border-gray-300 shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm py-2 px-3"[39m
                  [33mdisabled[39m=[32m""[39m
                  [33mid[39m=[32m"leaveType"[39m
                  [33mname[39m=[32m"leaveType"[39m
                  [33mrequired[39m=[32m""[39m
                [36m>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m""[39m
                  [36m>[39m
                    [0mChargement...[0m
                  [36m</option>[39m
                [36m</select>[39m
              [36m</div>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mclass[39m=[32m"grid grid-cols-1 gap-6 md:grid-cols-2 mb-6"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"relative"[39m
              [36m>[39m
                [36m<label[39m
                  [33mclass[39m=[32m"block text-sm font-medium text-gray-700 mb-1"[39m
                  [33mfor[39m=[32m"startDate"[39m
                [36m>[39m
                  [0mDate de début[0m
                [36m</label>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"relative"[39m
                [36m>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"react-datepicker-wrapper"[39m
                  [36m>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"react-datepicker__input-container"[39m
                    [36m>[39m
                      [36m<input[39m
                        [33mautocomplete[39m=[32m"off"[39m
                        [33mclass[39m=[32m"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 pl-10 pr-4 py-2 disabled:bg-gray-100 disabled:cursor-not-allowed"[39m
                        [33mid[39m=[32m"startDate"[39m
                        [33mplaceholder[39m=[32m"Sélectionner une date"[39m
                        [33mtype[39m=[32m"text"[39m
                        [33mvalue[39m=[32m""[39m
                      [36m/>[39m
                    [36m</div>[39m
                  [36m</div>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"[39m
                  [36m>[39m
                    [36m<svg[39m
                      [33maria-hidden[39m=[32m"true"[39m
                      [33mclass[39m=[32m"lucide lucide-calendar h-5 w-5 text-gray-400"[39m
                      [33mfill[39m=[32m"none"[39m
                      [33mheight[39m=[32m"24"[39m
                      [33mstroke[39m=[32m"currentColor"[39m
                      [33mstroke-linecap[39m=[32m"round"[39m
                      [33mstroke-linejoin[39m=[32m"round"[39m
                      [33mstroke-width[39m=[32m"2"[39m
                      [33mviewBox[39m=[32m"0 0 24 24"[39m
                      [33mwidth[39m=[32m"24"[39m
                      [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
                    [36m>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M8 2v4"[39m
                      [36m/>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M16 2v4"[39m
                      [36m/>[39m
                      [36m<rect[39m
                        [33mheight[39m=[32m"18"[39m
                        [33mrx[39m=[32m"2"[39m
                        [33mwidth[39m=[32m"18"[39m
                        [33mx[39m=[32m"3"[39m
                        [33my[39m=[32m"4"[39m
                      [36m/>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M3 10h18"[39m
                      [36m/>[39m
                    [36m</svg>[39m
                  [36m</div>[39m
                [36m</div>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mclass[39m=[32m"relative"[39m
              [36m>[39m
                [36m<label[39m
                  [33mclass[39m=[32m"block text-sm font-medium text-gray-700 mb-1"[39m
                  [33mfor[39m=[32m"endDate"[39m
                [36m>[39m
                  [0mDate de fin[0m
                [36m</label>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"relative"[39m
                [36m>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"react-datepicker-wrapper"[39m
                  [36m>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"react-datepicker__input-container"[39m
                    [36m>[39m
                      [36m<input[39m
                        [33mautocomplete[39m=[32m"off"[39m
                        [33mclass[39m=[32m"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 pl-10 pr-4 py-2 disabled:bg-gray-100 disabled:cursor-not-allowed"[39m
                        [33mid[39m=[32m"endDate"[39m
                        [33mplaceholder[39m=[32m"Sélectionner une date"[39m
                        [33mtype[39m=[32m"text"[39m
                        [33mvalue[39m=[32m""[39m
                      [36m/>[39m
                    [36m</div>[39m
                  [36m</div>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"[39m
                  [36m>[39m
                    [36m<svg[39m
                      [33maria-hidden[39m=[32m"true"[39m
                      [33mclass[39m=[32m"lucide lucide-calendar h-5 w-5 text-gray-400"[39m
                      [33mfill[39m=[32m"none"[39m
                      [33mheight[39m=[32m"24"[39m
                      [33mstroke[39m=[32m"currentColor"[39m
                      [33mstroke-linecap[39m=[32m"round"[39m
                      [33mstroke-linejoin[39m=[32m"round"[39m
                      [33mstroke-width[39m=[32m"2"[39m
                      [33mviewBox[39m=[32m"0 0 24 24"[39m
                      [33mwidth[39m=[32m"24"[39m
                      [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
                    [36m>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M8 2v4"[39m
                      [36m/>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M16 2v4"[39m
                      [36m/>[39m
                      [36m<rect[39m
                        [33mheight[39m=[32m"18"[39m
                        [33mrx[39m=[32m"2"[39m
                        [33mwidth[39m=[32m"18"[39m
                        [33mx[39m=[32m"3"[39m
                        [33my[39m=[32m"4"[39m
                      [36m/>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M3 10h18"[39m
                      [36m/>[39m
                    [36m</svg>[39m
                  [36m</div>[39m
                [36m</div>[39m
              [36m</div>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mclass[39m=[32m"mb-6"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"flex flex-col space-y-4 p-4 bg-gray-50 rounded-md border border-gray-200"[39m
              [36m>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"flex items-center"[39m
                [36m>[39m
                  [36m<input[39m
                    [33mclass[39m=[32m"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"[39m
                    [33mdisabled[39m=[32m""[39m
                    [33mid[39m=[32m"isHalfDay"[39m
                    [33mname[39m=[32m"isHalfDay"[39m
                    [33mtype[39m=[32m"checkbox"[39m
                  [36m/>[39m
                  [36m<label[39m
                    [33mclass[39m=[32m"ml-2 block text-sm font-medium text-gray-700"[39m
                    [33mfor[39m=[32m"isHalfDay"[39m
                  [36m>[39m
                    [0mDemi-journée[0m
                  [36m</label>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"relative inline-block"[39m
                  [36m>[39m
                    [36m<span[39m
                      [33mclass[39m=[32m"text-gray-400 hover:text-gray-600 cursor-help ml-1"[39m
                    [36m>[39m
                      [36m<svg[39m
                        [33maria-hidden[39m=[32m"true"[39m
                        [33mclass[39m=[32m"lucide lucide-circle-help h-4 w-4"[39m
                        [33mfill[39m=[32m"none"[39m
                        [33mheight[39m=[32m"24"[39m
                        [33mstroke[39m=[32m"currentColor"[39m
                        [33mstroke-linecap[39m=[32m"round"[39m
                        [33mstroke-linejoin[39m=[32m"round"[39m
                        [33mstroke-width[39m=[32m"2"[39m
                        [33mviewBox[39m=[32m"0 0 24 24"[39m
                        [33mwidth[39m=[32m"24"[39m
                        [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
                      [36m>[39m
                        [36m<circle[39m
                          [33mcx[39m=[32m"12"[39m
                          [33mcy[39m=[32m"12"[39m
                          [33mr[39m=[32m"10"[39m
                        [36m/>[39m
                        [36m<path[39m
                          [33md[39m=[32m"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"[39m
                        [36m/>[39m
                        [36m<path[39m
                          [33md[39m=[32m"M12 17h.01"[39m
                        [36m/>[39m
                      [36m</svg>[39m
                    [36m</span>[39m
                  [36m</div>[39m
                [36m</div>[39m
              [36m</div>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mclass[39m=[32m"space-y-3 mb-6"[39m
            [36m/>[39m
            [36m<div[39m
              [33mclass[39m=[32m"mb-6"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"flex items-center justify-between"[39m
              [36m>[39m
                [36m<label[39m
                  [33mclass[39m=[32m"block text-sm font-medium text-gray-700"[39m
                  [33mfor[39m=[32m"reason"[39m
                [36m>[39m
                  [0mMotif (optionnel)[0m
                [36m</label>[39m
                [36m<span[39m
                  [33mclass[39m=[32m"text-xs text-gray-500"[39m
                [36m>[39m
                  [0mMax. 200 caractères[0m
                [36m</span>[39m
              [36m</div>[39m
              [36m<textarea[39m
                [33mclass[39m=[32m"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"[39m
                [33mid[39m=[32m"reason"[39m
                [33mmaxlength[39m=[32m"200"[39m
                [33mname[39m=[32m"reason"[39m
                [33mplaceholder[39m=[32m"Précisez le motif de votre demande si nécessaire..."[39m
                [33mrows[39m=[32m"3"[39m
              [36m/>[39m
            [36m</div>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"flex justify-end mt-8"[39m
          [36m>[39m
            [36m<button[39m
              [33mclass[39m=[32m"inline-flex items-center justify-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-60 disabled:cursor-not-allowed transition-opacity"[39m
              [33mdisabled[39m=[32m""[39m
              [33mtype[39m=[32m"submit"[39m
            [36m>[39m
              [0mSoumettre la demande[0m
            [36m</button>[39m
          [36m</div>[39m
        [36m</form>[39m
      [36m</div>[39m
    [36m</body>[39m

      406 |         await user.click(submitButton); // Soumission sans dates
      407 |
    > 408 |         expectToBeInDocument(await screen.findByText('La date de début est requise.'));
          |                                           ^
      409 |         expectToBeInDocument(screen.getByText('La date de fin est requise.'));
      410 |         expectNotToHaveBeenCalled(mockedAxios.post);
      411 |     });

      at waitForWrapper (node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at node_modules/@testing-library/dom/dist/query-helpers.js:86:32
      at Object.<anonymous> (src/modules/leaves/components/LeaveForm.test.tsx:408:43)

  ● LeaveForm › Form Submission › should submit valid data to /api/leaves/batch and handle success

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "/api/leaves/batch", [ObjectContaining {"endDate": "2024-09-03", "reason": "Vacances annuelles", "startDate": "2024-09-02", "typeCode": "ANNUAL", "userId": 1}]

    Number of calls: 0

    Ignored nodes: comments, script, style
    [36m<html>[39m
      [36m<head />[39m
      [36m<body>[39m
        [36m<div>[39m
          [36m<form[39m
            [33mclass[39m=[32m"space-y-6 max-w-2xl mx-auto"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"bg-gradient-to-r from-indigo-50 to-blue-50 p-4 rounded-lg shadow-sm mb-6"[39m
            [36m>[39m
              [36m<h3[39m
                [33mclass[39m=[32m"text-lg font-medium text-gray-800 mb-2"[39m
              [36m>[39m
                [0mNouvelle demande de congé[0m
              [36m</h3>[39m
              [36m<p[39m
                [33mclass[39m=[32m"text-sm text-gray-600"[39m
              [36m>[39m
                [0mComplétez le formulaire ci-dessous pour soumettre votre demande.[0m
              [36m</p>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mclass[39m=[32m"bg-white p-6 rounded-lg shadow-md border border-gray-200"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"mb-6"[39m
              [36m>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"flex items-center justify-between"[39m
                [36m>[39m
                  [36m<label[39m
                    [33mclass[39m=[32m"block text-sm font-medium text-gray-700"[39m
                    [33mfor[39m=[32m"leaveType"[39m
                  [36m>[39m
                    [0mType de congé[0m
                  [36m</label>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"relative inline-block"[39m
                  [36m>[39m
                    [36m<span[39m
                      [33mclass[39m=[32m"text-gray-400 hover:text-gray-600 cursor-help"[39m
                    [36m>[39m
                      [36m<svg[39m
                        [33maria-hidden[39m=[32m"true"[39m
                        [33mclass[39m=[32m"lucide lucide-circle-help h-4 w-4"[39m
                        [33mfill[39m=[32m"none"[39m
                        [33mheight[39m=[32m"24"[39m
                        [33mstroke[39m=[32m"currentColor"[39m
                        [33mstroke-linecap[39m=[32m"round"[39m
                        [33mstroke-linejoin[39m=[32m"round"[39m
                        [33mstroke-width[39m=[32m"2"[39m
                        [33mviewBox[39m=[32m"0 0 24 24"[39m
                        [33mwidth[39m=[32m"24"[39m
                        [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
                      [36m>[39m
                        [36m<circle[39m
                          [33mcx[39m=[32m"12"[39m
                          [33mcy[39m=[32m"12"[39m
                          [33mr[39m=[32m"10"[39m
                        [36m/>[39m
                        [36m<path[39m
                          [33md[39m=[32m"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"[39m
                        [36m/>[39m
                        [36m<path[39m
                          [33md[39m=[32m"M12 17h.01"[39m
                        [36m/>[39m
                      [36m</svg>[39m
                    [36m</span>[39m
                  [36m</div>[39m
                [36m</div>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"mt-1 relative"[39m
                [36m>[39m
                  [36m<select[39m
                    [33mclass[39m=[32m"block w-full rounded-md border-gray-300 shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm py-2 px-3"[39m
                    [33mid[39m=[32m"leaveType"[39m
                    [33mname[39m=[32m"leaveType"[39m
                    [33mrequired[39m=[32m""[39m
                  [36m>[39m
                    [36m<option[39m
                      [33mvalue[39m=[32m""[39m
                    [36m>[39m
                      [0m-- Sélectionner un type --[0m
                    [36m</option>[39m
                    [36m<option[39m
                      [33mtitle[39m=[32m"Congés annuels bruts"[39m
                      [33mvalue[39m=[32m"ANNUAL"[39m
                    [36m>[39m
                      [0mCongé annuel[0m
                    [36m</option>[39m
                    [36m<option[39m
                      [33mtitle[39m=[32m"RTT bruts"[39m
                      [33mvalue[39m=[32m"RTT"[39m
                    [36m>[39m
                      [0mRTT API (Raw)[0m
                    [36m</option>[39m
                    [36m<option[39m
                      [33mtitle[39m=[32m"Congé maladie brut"[39m
                      [33mvalue[39m=[32m"SICK"[39m
                    [36m>[39m
                      [0mMaladie[0m
                    [36m</option>[39m
                  [36m</select>[39m
                [36m</div>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mclass[39m=[32m"grid grid-cols-1 gap-6 md:grid-cols-2 mb-6"[39m
              [36m>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"relative"[39m
                [36m>[39m
                  [36m<label[39m
                    [33mclass[39m=[32m"block text-sm font-medium text-gray-700 mb-1"[39m
                    [33mfor[39m=[32m"startDate"[39m
                  [36m>[39m
                    [0mDate de début[0m
                  [36m</label>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"relative"[39m
                  [36m>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"react-datepicker-wrapper"[39m
                    [36m>[39m
                      [36m<div[39m
                        [33mclass[39m=[32m"react-datepicker__input-container"[39m
                      [36m>[39m
                        [36m<input[39m
                          [33mautocomplete[39m=[32m"off"[39m
                          [33mclass[39m=[32m"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 pl-10 pr-4 py-2 disabled:bg-gray-100 disabled:cursor-not-allowed"[39m
                          [33mid[39m=[32m"startDate"[39m
                          [33mplaceholder[39m=[32m"Sélectionner une date"[39m
                          [33mtype[39m=[32m"text"[39m
                          [33mvalue[39m=[32m""[39m
                        [36m/>[39m
                      [36m</div>[39m
                    [36m</div>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"[39m
                    [36m>[39m
                      [36m<svg[39m
                        [33maria-hidden[39m=[32m"true"[39m
                        [33mclass[39m=[32m"lucide lucide-calendar h-5 w-5 text-gray-400"[39m
                        [33mfill[39m=[32m"none"[39m
                        [33mheight[39m=[32m"24"[39m
                        [33mstroke[39m=[32m"currentColor"[39m
                        [33mstroke-linecap[39m=[32m"round"[39m
                        [33mstroke-linejoin[39m=[32m"round"[39m
                        [33mstroke-width[39m=[32m"2"[39m
                        [33mviewBox[39m=[32m"0 0 24 24"[39m
                        [33mwidth[39m=[32m"24"[39m
                        [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
            ...

      45 |  */
      46 | export function expectToHaveBeenCalledWith(mockFn: MockFn, ...args: any[]): void {
    > 47 |     expect(mockFn).toHaveBeenCalledWith(...args);
         |                    ^
      48 | }
      49 |
      50 | /**

      at toHaveBeenCalledWith (src/tests/utils/assertions.ts:47:20)
      at src/modules/leaves/components/LeaveForm.test.tsx:507:43
      at callback (node_modules/@testing-library/dom/dist/config.js:47:12)
      at checkCallback (node_modules/@testing-library/dom/dist/wait-for.js:124:76)
      at checkCallback (node_modules/@testing-library/dom/dist/wait-for.js:118:16)
      at Timeout.task [as _onTimeout] (node_modules/jsdom/lib/jsdom/browser/Window.js:520:19)

  ● LeaveForm › Form Submission › should handle API error from /api/leaves/batch on submit

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "/api/leaves/batch", Any<Array>

    Number of calls: 0

    Ignored nodes: comments, script, style
    [36m<html>[39m
      [36m<head />[39m
      [36m<body>[39m
        [36m<div>[39m
          [36m<form[39m
            [33mclass[39m=[32m"space-y-6 max-w-2xl mx-auto"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"bg-gradient-to-r from-indigo-50 to-blue-50 p-4 rounded-lg shadow-sm mb-6"[39m
            [36m>[39m
              [36m<h3[39m
                [33mclass[39m=[32m"text-lg font-medium text-gray-800 mb-2"[39m
              [36m>[39m
                [0mNouvelle demande de congé[0m
              [36m</h3>[39m
              [36m<p[39m
                [33mclass[39m=[32m"text-sm text-gray-600"[39m
              [36m>[39m
                [0mComplétez le formulaire ci-dessous pour soumettre votre demande.[0m
              [36m</p>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mclass[39m=[32m"bg-white p-6 rounded-lg shadow-md border border-gray-200"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"mb-6"[39m
              [36m>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"flex items-center justify-between"[39m
                [36m>[39m
                  [36m<label[39m
                    [33mclass[39m=[32m"block text-sm font-medium text-gray-700"[39m
                    [33mfor[39m=[32m"leaveType"[39m
                  [36m>[39m
                    [0mType de congé[0m
                  [36m</label>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"relative inline-block"[39m
                  [36m>[39m
                    [36m<span[39m
                      [33mclass[39m=[32m"text-gray-400 hover:text-gray-600 cursor-help"[39m
                    [36m>[39m
                      [36m<svg[39m
                        [33maria-hidden[39m=[32m"true"[39m
                        [33mclass[39m=[32m"lucide lucide-circle-help h-4 w-4"[39m
                        [33mfill[39m=[32m"none"[39m
                        [33mheight[39m=[32m"24"[39m
                        [33mstroke[39m=[32m"currentColor"[39m
                        [33mstroke-linecap[39m=[32m"round"[39m
                        [33mstroke-linejoin[39m=[32m"round"[39m
                        [33mstroke-width[39m=[32m"2"[39m
                        [33mviewBox[39m=[32m"0 0 24 24"[39m
                        [33mwidth[39m=[32m"24"[39m
                        [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
                      [36m>[39m
                        [36m<circle[39m
                          [33mcx[39m=[32m"12"[39m
                          [33mcy[39m=[32m"12"[39m
                          [33mr[39m=[32m"10"[39m
                        [36m/>[39m
                        [36m<path[39m
                          [33md[39m=[32m"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"[39m
                        [36m/>[39m
                        [36m<path[39m
                          [33md[39m=[32m"M12 17h.01"[39m
                        [36m/>[39m
                      [36m</svg>[39m
                    [36m</span>[39m
                  [36m</div>[39m
                [36m</div>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"mt-1 relative"[39m
                [36m>[39m
                  [36m<select[39m
                    [33mclass[39m=[32m"block w-full rounded-md border-gray-300 shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm py-2 px-3"[39m
                    [33mid[39m=[32m"leaveType"[39m
                    [33mname[39m=[32m"leaveType"[39m
                    [33mrequired[39m=[32m""[39m
                  [36m>[39m
                    [36m<option[39m
                      [33mvalue[39m=[32m""[39m
                    [36m>[39m
                      [0m-- Sélectionner un type --[0m
                    [36m</option>[39m
                    [36m<option[39m
                      [33mtitle[39m=[32m"Congés annuels bruts"[39m
                      [33mvalue[39m=[32m"ANNUAL"[39m
                    [36m>[39m
                      [0mCongé annuel[0m
                    [36m</option>[39m
                    [36m<option[39m
                      [33mtitle[39m=[32m"RTT bruts"[39m
                      [33mvalue[39m=[32m"RTT"[39m
                    [36m>[39m
                      [0mRTT API (Raw)[0m
                    [36m</option>[39m
                    [36m<option[39m
                      [33mtitle[39m=[32m"Congé maladie brut"[39m
                      [33mvalue[39m=[32m"SICK"[39m
                    [36m>[39m
                      [0mMaladie[0m
                    [36m</option>[39m
                  [36m</select>[39m
                [36m</div>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mclass[39m=[32m"grid grid-cols-1 gap-6 md:grid-cols-2 mb-6"[39m
              [36m>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"relative"[39m
                [36m>[39m
                  [36m<label[39m
                    [33mclass[39m=[32m"block text-sm font-medium text-gray-700 mb-1"[39m
                    [33mfor[39m=[32m"startDate"[39m
                  [36m>[39m
                    [0mDate de début[0m
                  [36m</label>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"relative"[39m
                  [36m>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"react-datepicker-wrapper"[39m
                    [36m>[39m
                      [36m<div[39m
                        [33mclass[39m=[32m"react-datepicker__input-container"[39m
                      [36m>[39m
                        [36m<input[39m
                          [33mautocomplete[39m=[32m"off"[39m
                          [33mclass[39m=[32m"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 pl-10 pr-4 py-2 disabled:bg-gray-100 disabled:cursor-not-allowed"[39m
                          [33mid[39m=[32m"startDate"[39m
                          [33mplaceholder[39m=[32m"Sélectionner une date"[39m
                          [33mtype[39m=[32m"text"[39m
                          [33mvalue[39m=[32m""[39m
                        [36m/>[39m
                      [36m</div>[39m
                    [36m</div>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"[39m
                    [36m>[39m
                      [36m<svg[39m
                        [33maria-hidden[39m=[32m"true"[39m
                        [33mclass[39m=[32m"lucide lucide-calendar h-5 w-5 text-gray-400"[39m
                        [33mfill[39m=[32m"none"[39m
                        [33mheight[39m=[32m"24"[39m
                        [33mstroke[39m=[32m"currentColor"[39m
                        [33mstroke-linecap[39m=[32m"round"[39m
                        [33mstroke-linejoin[39m=[32m"round"[39m
                        [33mstroke-width[39m=[32m"2"[39m
                        [33mviewBox[39m=[32m"0 0 24 24"[39m
                        [33mwidth[39m=[32m"24"[39m
                        [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
            ...

      45 |  */
      46 | export function expectToHaveBeenCalledWith(mockFn: MockFn, ...args: any[]): void {
    > 47 |     expect(mockFn).toHaveBeenCalledWith(...args);
         |                    ^
      48 | }
      49 |
      50 | /**

      at toHaveBeenCalledWith (src/tests/utils/assertions.ts:47:20)
      at src/modules/leaves/components/LeaveForm.test.tsx:572:43
      at callback (node_modules/@testing-library/dom/dist/config.js:47:12)
      at checkCallback (node_modules/@testing-library/dom/dist/wait-for.js:124:76)
      at checkCallback (node_modules/@testing-library/dom/dist/wait-for.js:118:16)
      at Timeout.task [as _onTimeout] (node_modules/jsdom/lib/jsdom/browser/Window.js:520:19)

  ● LeaveForm › Form Submission › should handle general network error on submit

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "/api/leaves/batch", Any<Array>

    Number of calls: 0

    Ignored nodes: comments, script, style
    [36m<html>[39m
      [36m<head />[39m
      [36m<body>[39m
        [36m<div>[39m
          [36m<form[39m
            [33mclass[39m=[32m"space-y-6 max-w-2xl mx-auto"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"bg-gradient-to-r from-indigo-50 to-blue-50 p-4 rounded-lg shadow-sm mb-6"[39m
            [36m>[39m
              [36m<h3[39m
                [33mclass[39m=[32m"text-lg font-medium text-gray-800 mb-2"[39m
              [36m>[39m
                [0mNouvelle demande de congé[0m
              [36m</h3>[39m
              [36m<p[39m
                [33mclass[39m=[32m"text-sm text-gray-600"[39m
              [36m>[39m
                [0mComplétez le formulaire ci-dessous pour soumettre votre demande.[0m
              [36m</p>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mclass[39m=[32m"bg-white p-6 rounded-lg shadow-md border border-gray-200"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"mb-6"[39m
              [36m>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"flex items-center justify-between"[39m
                [36m>[39m
                  [36m<label[39m
                    [33mclass[39m=[32m"block text-sm font-medium text-gray-700"[39m
                    [33mfor[39m=[32m"leaveType"[39m
                  [36m>[39m
                    [0mType de congé[0m
                  [36m</label>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"relative inline-block"[39m
                  [36m>[39m
                    [36m<span[39m
                      [33mclass[39m=[32m"text-gray-400 hover:text-gray-600 cursor-help"[39m
                    [36m>[39m
                      [36m<svg[39m
                        [33maria-hidden[39m=[32m"true"[39m
                        [33mclass[39m=[32m"lucide lucide-circle-help h-4 w-4"[39m
                        [33mfill[39m=[32m"none"[39m
                        [33mheight[39m=[32m"24"[39m
                        [33mstroke[39m=[32m"currentColor"[39m
                        [33mstroke-linecap[39m=[32m"round"[39m
                        [33mstroke-linejoin[39m=[32m"round"[39m
                        [33mstroke-width[39m=[32m"2"[39m
                        [33mviewBox[39m=[32m"0 0 24 24"[39m
                        [33mwidth[39m=[32m"24"[39m
                        [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
                      [36m>[39m
                        [36m<circle[39m
                          [33mcx[39m=[32m"12"[39m
                          [33mcy[39m=[32m"12"[39m
                          [33mr[39m=[32m"10"[39m
                        [36m/>[39m
                        [36m<path[39m
                          [33md[39m=[32m"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"[39m
                        [36m/>[39m
                        [36m<path[39m
                          [33md[39m=[32m"M12 17h.01"[39m
                        [36m/>[39m
                      [36m</svg>[39m
                    [36m</span>[39m
                  [36m</div>[39m
                [36m</div>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"mt-1 relative"[39m
                [36m>[39m
                  [36m<select[39m
                    [33mclass[39m=[32m"block w-full rounded-md border-gray-300 shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm py-2 px-3"[39m
                    [33mid[39m=[32m"leaveType"[39m
                    [33mname[39m=[32m"leaveType"[39m
                    [33mrequired[39m=[32m""[39m
                  [36m>[39m
                    [36m<option[39m
                      [33mvalue[39m=[32m""[39m
                    [36m>[39m
                      [0m-- Sélectionner un type --[0m
                    [36m</option>[39m
                    [36m<option[39m
                      [33mtitle[39m=[32m"Congés annuels bruts"[39m
                      [33mvalue[39m=[32m"ANNUAL"[39m
                    [36m>[39m
                      [0mCongé annuel[0m
                    [36m</option>[39m
                    [36m<option[39m
                      [33mtitle[39m=[32m"RTT bruts"[39m
                      [33mvalue[39m=[32m"RTT"[39m
                    [36m>[39m
                      [0mRTT API (Raw)[0m
                    [36m</option>[39m
                    [36m<option[39m
                      [33mtitle[39m=[32m"Congé maladie brut"[39m
                      [33mvalue[39m=[32m"SICK"[39m
                    [36m>[39m
                      [0mMaladie[0m
                    [36m</option>[39m
                  [36m</select>[39m
                [36m</div>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mclass[39m=[32m"grid grid-cols-1 gap-6 md:grid-cols-2 mb-6"[39m
              [36m>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"relative"[39m
                [36m>[39m
                  [36m<label[39m
                    [33mclass[39m=[32m"block text-sm font-medium text-gray-700 mb-1"[39m
                    [33mfor[39m=[32m"startDate"[39m
                  [36m>[39m
                    [0mDate de début[0m
                  [36m</label>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"relative"[39m
                  [36m>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"react-datepicker-wrapper"[39m
                    [36m>[39m
                      [36m<div[39m
                        [33mclass[39m=[32m"react-datepicker__input-container"[39m
                      [36m>[39m
                        [36m<input[39m
                          [33mautocomplete[39m=[32m"off"[39m
                          [33mclass[39m=[32m"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 pl-10 pr-4 py-2 disabled:bg-gray-100 disabled:cursor-not-allowed"[39m
                          [33mid[39m=[32m"startDate"[39m
                          [33mplaceholder[39m=[32m"Sélectionner une date"[39m
                          [33mtype[39m=[32m"text"[39m
                          [33mvalue[39m=[32m""[39m
                        [36m/>[39m
                      [36m</div>[39m
                    [36m</div>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"[39m
                    [36m>[39m
                      [36m<svg[39m
                        [33maria-hidden[39m=[32m"true"[39m
                        [33mclass[39m=[32m"lucide lucide-calendar h-5 w-5 text-gray-400"[39m
                        [33mfill[39m=[32m"none"[39m
                        [33mheight[39m=[32m"24"[39m
                        [33mstroke[39m=[32m"currentColor"[39m
                        [33mstroke-linecap[39m=[32m"round"[39m
                        [33mstroke-linejoin[39m=[32m"round"[39m
                        [33mstroke-width[39m=[32m"2"[39m
                        [33mviewBox[39m=[32m"0 0 24 24"[39m
                        [33mwidth[39m=[32m"24"[39m
                        [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
            ...

      45 |  */
      46 | export function expectToHaveBeenCalledWith(mockFn: MockFn, ...args: any[]): void {
    > 47 |     expect(mockFn).toHaveBeenCalledWith(...args);
         |                    ^
      48 | }
      49 |
      50 | /**

      at toHaveBeenCalledWith (src/tests/utils/assertions.ts:47:20)
      at src/modules/leaves/components/LeaveForm.test.tsx:611:43
      at callback (node_modules/@testing-library/dom/dist/config.js:47:12)
      at checkCallback (node_modules/@testing-library/dom/dist/wait-for.js:124:76)
      at checkCallback (node_modules/@testing-library/dom/dist/wait-for.js:118:16)
      at Timeout.task [as _onTimeout] (node_modules/jsdom/lib/jsdom/browser/Window.js:520:19)

  ● LeaveForm › Form Submission › should not submit if calculation is not successful

    Unable to find an element with the text: /Calcul des jours en cours.../i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<form[39m
          [33mclass[39m=[32m"space-y-6 max-w-2xl mx-auto"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"bg-gradient-to-r from-indigo-50 to-blue-50 p-4 rounded-lg shadow-sm mb-6"[39m
          [36m>[39m
            [36m<h3[39m
              [33mclass[39m=[32m"text-lg font-medium text-gray-800 mb-2"[39m
            [36m>[39m
              [0mNouvelle demande de congé[0m
            [36m</h3>[39m
            [36m<p[39m
              [33mclass[39m=[32m"text-sm text-gray-600"[39m
            [36m>[39m
              [0mComplétez le formulaire ci-dessous pour soumettre votre demande.[0m
            [36m</p>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"bg-white p-6 rounded-lg shadow-md border border-gray-200"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"mb-6"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"flex items-center justify-between"[39m
              [36m>[39m
                [36m<label[39m
                  [33mclass[39m=[32m"block text-sm font-medium text-gray-700"[39m
                  [33mfor[39m=[32m"leaveType"[39m
                [36m>[39m
                  [0mType de congé[0m
                [36m</label>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"relative inline-block"[39m
                [36m>[39m
                  [36m<span[39m
                    [33mclass[39m=[32m"text-gray-400 hover:text-gray-600 cursor-help"[39m
                  [36m>[39m
                    [36m<svg[39m
                      [33maria-hidden[39m=[32m"true"[39m
                      [33mclass[39m=[32m"lucide lucide-circle-help h-4 w-4"[39m
                      [33mfill[39m=[32m"none"[39m
                      [33mheight[39m=[32m"24"[39m
                      [33mstroke[39m=[32m"currentColor"[39m
                      [33mstroke-linecap[39m=[32m"round"[39m
                      [33mstroke-linejoin[39m=[32m"round"[39m
                      [33mstroke-width[39m=[32m"2"[39m
                      [33mviewBox[39m=[32m"0 0 24 24"[39m
                      [33mwidth[39m=[32m"24"[39m
                      [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
                    [36m>[39m
                      [36m<circle[39m
                        [33mcx[39m=[32m"12"[39m
                        [33mcy[39m=[32m"12"[39m
                        [33mr[39m=[32m"10"[39m
                      [36m/>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"[39m
                      [36m/>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M12 17h.01"[39m
                      [36m/>[39m
                    [36m</svg>[39m
                  [36m</span>[39m
                [36m</div>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mclass[39m=[32m"mt-1 relative"[39m
              [36m>[39m
                [36m<select[39m
                  [33mclass[39m=[32m"block w-full rounded-md border-gray-300 shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm py-2 px-3"[39m
                  [33mid[39m=[32m"leaveType"[39m
                  [33mname[39m=[32m"leaveType"[39m
                  [33mrequired[39m=[32m""[39m
                [36m>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m""[39m
                  [36m>[39m
                    [0m-- Sélectionner un type --[0m
                  [36m</option>[39m
                  [36m<option[39m
                    [33mtitle[39m=[32m"Congés annuels bruts"[39m
                    [33mvalue[39m=[32m"ANNUAL"[39m
                  [36m>[39m
                    [0mCongé annuel[0m
                  [36m</option>[39m
                  [36m<option[39m
                    [33mtitle[39m=[32m"RTT bruts"[39m
                    [33mvalue[39m=[32m"RTT"[39m
                  [36m>[39m
                    [0mRTT API (Raw)[0m
                  [36m</option>[39m
                  [36m<option[39m
                    [33mtitle[39m=[32m"Congé maladie brut"[39m
                    [33mvalue[39m=[32m"SICK"[39m
                  [36m>[39m
                    [0mMaladie[0m
                  [36m</option>[39m
                [36m</select>[39m
              [36m</div>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mclass[39m=[32m"grid grid-cols-1 gap-6 md:grid-cols-2 mb-6"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"relative"[39m
              [36m>[39m
                [36m<label[39m
                  [33mclass[39m=[32m"block text-sm font-medium text-gray-700 mb-1"[39m
                  [33mfor[39m=[32m"startDate"[39m
                [36m>[39m
                  [0mDate de début[0m
                [36m</label>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"relative"[39m
                [36m>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"react-datepicker-wrapper"[39m
                  [36m>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"react-datepicker__input-container"[39m
                    [36m>[39m
                      [36m<input[39m
                        [33mautocomplete[39m=[32m"off"[39m
                        [33mclass[39m=[32m"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 pl-10 pr-4 py-2 disabled:bg-gray-100 disabled:cursor-not-allowed react-datepicker-ignore-onclickoutside"[39m
                        [33mid[39m=[32m"startDate"[39m
                        [33mplaceholder[39m=[32m"Sélectionner une date"[39m
                        [33mtype[39m=[32m"text"[39m
                        [33mvalue[39m=[32m"02/09/2024"[39m
                      [36m/>[39m
                    [36m</div>[39m
                  [36m</div>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"react-datepicker__tab-loop"[39m
                  [36m>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"react-datepicker__tab-loop__start"[39m
                      [33mtabindex[39m=[32m"0"[39m
                    [36m/>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"react-datepicker-popper z-50"[39m
                      [33mdata-placement[39m=[32m"bottom"[39m
                      [33mstyle[39m=[32m"position: absolute; left: 0px; top: 0px; transform: translate(0px, 10px);"[39m
                    [36m>[39m
                      [36m<div[39m
                        [33mstyle[39m=[32m"display: contents;"[39m
                      [36m>[39m
                        [36m<div[39m
                          [33mstyle[39m=[32m"display: contents;"[39m
                        [36m>[39m
                          [36m<div[39m
                            [33maria-label[39m=[32m"Choose Date"[39m
                            [33maria-modal[39m=[32m"true"[39m
                            [33mclass[39m=[32m"react-datepicker shadow-lg rounded-md border bo...

      653 |             await fillDatesInForm(user, '02/09/2024', '03/09/2024');
      654 |             // Le hook est mocké pour retourner 'loading' avec ces dates.
    > 655 |             await screen.findByText(/Calcul des jours en cours.../i, {}, { timeout: 3000 });
          |                          ^
      656 |
      657 |             const submitButton = screen.getByText('Soumettre la demande');
      658 |             await user.click(submitButton);

      at waitForWrapper (node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at node_modules/@testing-library/dom/dist/query-helpers.js:86:32
      at Object.<anonymous> (src/modules/leaves/components/LeaveForm.test.tsx:655:26)

A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.
Summary of all failing tests
FAIL src/modules/leaves/services/__tests__/QuotaAdvancedService.test.ts
  ● QuotaAdvancedService › executeTransfer › devrait exécuter un transfert valide

    AxiosError: Network Error

      305 |
      306 |             // Envoyer l'entrée à l'API
    > 307 |             const response = await axios.post(`${this.apiBaseUrl}/entries`, enhancedEntry, {
          |                              ^
      308 |                 headers: this.defaultHeaders
      309 |             });
      310 |

      at XMLHttpRequest.handleError (node_modules/axios/lib/adapters/xhr.js:110:14)
      at XMLHttpRequest.invokeTheCallbackFunction (node_modules/jsdom/lib/jsdom/living/generated/EventHandlerNonNull.js:14:28)
      at XMLHttpRequest.<anonymous> (node_modules/jsdom/lib/jsdom/living/helpers/create-event-accessor.js:35:32)
      at innerInvokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)
      at invokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
      at XMLHttpRequestImpl._dispatch (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
      at fireAnEvent (node_modules/jsdom/lib/jsdom/living/helpers/events.js:18:36)
      at requestErrorSteps (node_modules/jsdom/lib/jsdom/living/xhr/xhr-utils.js:131:3)
      at Object.dispatchError (node_modules/jsdom/lib/jsdom/living/xhr/xhr-utils.js:60:3)
      at Request.<anonymous> (node_modules/jsdom/lib/jsdom/living/xhr/XMLHttpRequest-impl.js:655:18)
      at ClientRequest.<anonymous> (node_modules/jsdom/lib/jsdom/living/helpers/http-request.js:121:14)
      at MockHttpSocket.emitEvent [as emit] (node_modules/@mswjs/interceptors/src/interceptors/ClientRequest/MockHttpSocket.ts:152:12)
      at Socket.emit (node_modules/@mswjs/interceptors/src/interceptors/ClientRequest/MockHttpSocket.ts:271:14)
      at Axios.request (node_modules/axios/lib/core/Axios.js:45:41)
      at AuditService.createAuditEntry (src/modules/leaves/services/AuditService.ts:307:30)
      at QuotaAdvancedService.executeTransfer (src/modules/leaves/services/QuotaAdvancedService.ts:199:13)
      at Object.<anonymous> (src/modules/leaves/services/__tests__/QuotaAdvancedService.test.ts:294:28)

  ● QuotaAdvancedService › executeCarryOver › devrait exécuter un report valide

    AxiosError: Network Error

      305 |
      306 |             // Envoyer l'entrée à l'API
    > 307 |             const response = await axios.post(`${this.apiBaseUrl}/entries`, enhancedEntry, {
          |                              ^
      308 |                 headers: this.defaultHeaders
      309 |             });
      310 |

      at XMLHttpRequest.handleError (node_modules/axios/lib/adapters/xhr.js:110:14)
      at XMLHttpRequest.invokeTheCallbackFunction (node_modules/jsdom/lib/jsdom/living/generated/EventHandlerNonNull.js:14:28)
      at XMLHttpRequest.<anonymous> (node_modules/jsdom/lib/jsdom/living/helpers/create-event-accessor.js:35:32)
      at innerInvokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:350:25)
      at invokeEventListeners (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:286:3)
      at XMLHttpRequestImpl._dispatch (node_modules/jsdom/lib/jsdom/living/events/EventTarget-impl.js:233:9)
      at fireAnEvent (node_modules/jsdom/lib/jsdom/living/helpers/events.js:18:36)
      at requestErrorSteps (node_modules/jsdom/lib/jsdom/living/xhr/xhr-utils.js:131:3)
      at Object.dispatchError (node_modules/jsdom/lib/jsdom/living/xhr/xhr-utils.js:60:3)
      at Request.<anonymous> (node_modules/jsdom/lib/jsdom/living/xhr/XMLHttpRequest-impl.js:655:18)
      at ClientRequest.<anonymous> (node_modules/jsdom/lib/jsdom/living/helpers/http-request.js:121:14)
      at MockHttpSocket.emitEvent [as emit] (node_modules/@mswjs/interceptors/src/interceptors/ClientRequest/MockHttpSocket.ts:152:12)
      at Socket.emit (node_modules/@mswjs/interceptors/src/interceptors/ClientRequest/MockHttpSocket.ts:271:14)
      at Axios.request (node_modules/axios/lib/core/Axios.js:45:41)
      at AuditService.createAuditEntry (src/modules/leaves/services/AuditService.ts:307:30)
      at QuotaAdvancedService.executeCarryOver (src/modules/leaves/services/QuotaAdvancedService.ts:359:13)
      at Object.<anonymous> (src/modules/leaves/services/__tests__/QuotaAdvancedService.test.ts:371:28)

FAIL src/modules/leaves/hooks/useConflictDetection.test.ts
  ● useConflictDetection › devrait initialiser correctement le hook

    Cannot use spyOn on a primitive value; undefined given

      91 |         // Remplacer la vérification des dates dans le hook useConflictDetection avec une implémentation simplifiée
      92 |         // qui va toujours réussir pour les tests
    > 93 |         jest.spyOn(useConflictDetection.prototype as any, 'validateDates').mockImplementation(() => true);
         |              ^
      94 |     });
      95 |
      96 |     it('devrait initialiser correctement le hook', () => {

      at ModuleMocker.spyOn (node_modules/jest-mock/build/index.js:719:13)
      at Object.<anonymous> (src/modules/leaves/hooks/useConflictDetection.test.ts:93:14)

  ● useConflictDetection › validateDates › devrait valider correctement des dates valides

    Cannot use spyOn on a primitive value; undefined given

      91 |         // Remplacer la vérification des dates dans le hook useConflictDetection avec une implémentation simplifiée
      92 |         // qui va toujours réussir pour les tests
    > 93 |         jest.spyOn(useConflictDetection.prototype as any, 'validateDates').mockImplementation(() => true);
         |              ^
      94 |     });
      95 |
      96 |     it('devrait initialiser correctement le hook', () => {

      at ModuleMocker.spyOn (node_modules/jest-mock/build/index.js:719:13)
      at Object.<anonymous> (src/modules/leaves/hooks/useConflictDetection.test.ts:93:14)

  ● useConflictDetection › validateDates › devrait rejeter des dates invalides - startDate null

    Cannot use spyOn on a primitive value; undefined given

      91 |         // Remplacer la vérification des dates dans le hook useConflictDetection avec une implémentation simplifiée
      92 |         // qui va toujours réussir pour les tests
    > 93 |         jest.spyOn(useConflictDetection.prototype as any, 'validateDates').mockImplementation(() => true);
         |              ^
      94 |     });
      95 |
      96 |     it('devrait initialiser correctement le hook', () => {

      at ModuleMocker.spyOn (node_modules/jest-mock/build/index.js:719:13)
      at Object.<anonymous> (src/modules/leaves/hooks/useConflictDetection.test.ts:93:14)

  ● useConflictDetection › validateDates › devrait rejeter des dates invalides - endDate null

    Cannot use spyOn on a primitive value; undefined given

      91 |         // Remplacer la vérification des dates dans le hook useConflictDetection avec une implémentation simplifiée
      92 |         // qui va toujours réussir pour les tests
    > 93 |         jest.spyOn(useConflictDetection.prototype as any, 'validateDates').mockImplementation(() => true);
         |              ^
      94 |     });
      95 |
      96 |     it('devrait initialiser correctement le hook', () => {

      at ModuleMocker.spyOn (node_modules/jest-mock/build/index.js:719:13)
      at Object.<anonymous> (src/modules/leaves/hooks/useConflictDetection.test.ts:93:14)

  ● useConflictDetection › validateDates › devrait rejeter des dates invalides - date de début après date de fin

    Cannot use spyOn on a primitive value; undefined given

      91 |         // Remplacer la vérification des dates dans le hook useConflictDetection avec une implémentation simplifiée
      92 |         // qui va toujours réussir pour les tests
    > 93 |         jest.spyOn(useConflictDetection.prototype as any, 'validateDates').mockImplementation(() => true);
         |              ^
      94 |     });
      95 |
      96 |     it('devrait initialiser correctement le hook', () => {

      at ModuleMocker.spyOn (node_modules/jest-mock/build/index.js:719:13)
      at Object.<anonymous> (src/modules/leaves/hooks/useConflictDetection.test.ts:93:14)

  ● useConflictDetection › validateDates › devrait rejeter des dates lorsque la validation échoue

    Cannot use spyOn on a primitive value; undefined given

      91 |         // Remplacer la vérification des dates dans le hook useConflictDetection avec une implémentation simplifiée
      92 |         // qui va toujours réussir pour les tests
    > 93 |         jest.spyOn(useConflictDetection.prototype as any, 'validateDates').mockImplementation(() => true);
         |              ^
      94 |     });
      95 |
      96 |     it('devrait initialiser correctement le hook', () => {

      at ModuleMocker.spyOn (node_modules/jest-mock/build/index.js:719:13)
      at Object.<anonymous> (src/modules/leaves/hooks/useConflictDetection.test.ts:93:14)

  ● useConflictDetection › checkConflicts › devrait vérifier les conflits et mettre à jour l'état - sans conflits

    Cannot use spyOn on a primitive value; undefined given

      91 |         // Remplacer la vérification des dates dans le hook useConflictDetection avec une implémentation simplifiée
      92 |         // qui va toujours réussir pour les tests
    > 93 |         jest.spyOn(useConflictDetection.prototype as any, 'validateDates').mockImplementation(() => true);
         |              ^
      94 |     });
      95 |
      96 |     it('devrait initialiser correctement le hook', () => {

      at ModuleMocker.spyOn (node_modules/jest-mock/build/index.js:719:13)
      at Object.<anonymous> (src/modules/leaves/hooks/useConflictDetection.test.ts:93:14)

  ● useConflictDetection › checkConflicts › devrait vérifier les conflits et mettre à jour l'état - avec conflits

    Cannot use spyOn on a primitive value; undefined given

      91 |         // Remplacer la vérification des dates dans le hook useConflictDetection avec une implémentation simplifiée
      92 |         // qui va toujours réussir pour les tests
    > 93 |         jest.spyOn(useConflictDetection.prototype as any, 'validateDates').mockImplementation(() => true);
         |              ^
      94 |     });
      95 |
      96 |     it('devrait initialiser correctement le hook', () => {

      at ModuleMocker.spyOn (node_modules/jest-mock/build/index.js:719:13)
      at Object.<anonymous> (src/modules/leaves/hooks/useConflictDetection.test.ts:93:14)

  ● useConflictDetection › checkConflicts › devrait gérer les erreurs lors de la vérification des conflits

    Cannot use spyOn on a primitive value; undefined given

      91 |         // Remplacer la vérification des dates dans le hook useConflictDetection avec une implémentation simplifiée
      92 |         // qui va toujours réussir pour les tests
    > 93 |         jest.spyOn(useConflictDetection.prototype as any, 'validateDates').mockImplementation(() => true);
         |              ^
      94 |     });
      95 |
      96 |     it('devrait initialiser correctement le hook', () => {

      at ModuleMocker.spyOn (node_modules/jest-mock/build/index.js:719:13)
      at Object.<anonymous> (src/modules/leaves/hooks/useConflictDetection.test.ts:93:14)

  ● useConflictDetection › checkConflicts › devrait rejeter avec une erreur si les dates sont invalides

    Cannot use spyOn on a primitive value; undefined given

      91 |         // Remplacer la vérification des dates dans le hook useConflictDetection avec une implémentation simplifiée
      92 |         // qui va toujours réussir pour les tests
    > 93 |         jest.spyOn(useConflictDetection.prototype as any, 'validateDates').mockImplementation(() => true);
         |              ^
      94 |     });
      95 |
      96 |     it('devrait initialiser correctement le hook', () => {

      at ModuleMocker.spyOn (node_modules/jest-mock/build/index.js:719:13)
      at Object.<anonymous> (src/modules/leaves/hooks/useConflictDetection.test.ts:93:14)

  ● useConflictDetection › checkConflicts › ne devrait pas appeler checkLeaveConflicts si les dates sont invalides

    Cannot use spyOn on a primitive value; undefined given

      91 |         // Remplacer la vérification des dates dans le hook useConflictDetection avec une implémentation simplifiée
      92 |         // qui va toujours réussir pour les tests
    > 93 |         jest.spyOn(useConflictDetection.prototype as any, 'validateDates').mockImplementation(() => true);
         |              ^
      94 |     });
      95 |
      96 |     it('devrait initialiser correctement le hook', () => {

      at ModuleMocker.spyOn (node_modules/jest-mock/build/index.js:719:13)
      at Object.<anonymous> (src/modules/leaves/hooks/useConflictDetection.test.ts:93:14)

  ● useConflictDetection › checkConflicts › devrait mettre à jour les conflits lorsque le service renvoie des conflits

    Cannot use spyOn on a primitive value; undefined given

      91 |         // Remplacer la vérification des dates dans le hook useConflictDetection avec une implémentation simplifiée
      92 |         // qui va toujours réussir pour les tests
    > 93 |         jest.spyOn(useConflictDetection.prototype as any, 'validateDates').mockImplementation(() => true);
         |              ^
      94 |     });
      95 |
      96 |     it('devrait initialiser correctement le hook', () => {

      at ModuleMocker.spyOn (node_modules/jest-mock/build/index.js:719:13)
      at Object.<anonymous> (src/modules/leaves/hooks/useConflictDetection.test.ts:93:14)

  ● useConflictDetection › checkConflicts › devrait gérer les erreurs du service

    Cannot use spyOn on a primitive value; undefined given

      91 |         // Remplacer la vérification des dates dans le hook useConflictDetection avec une implémentation simplifiée
      92 |         // qui va toujours réussir pour les tests
    > 93 |         jest.spyOn(useConflictDetection.prototype as any, 'validateDates').mockImplementation(() => true);
         |              ^
      94 |     });
      95 |
      96 |     it('devrait initialiser correctement le hook', () => {

      at ModuleMocker.spyOn (node_modules/jest-mock/build/index.js:719:13)
      at Object.<anonymous> (src/modules/leaves/hooks/useConflictDetection.test.ts:93:14)

  ● useConflictDetection › checkConflicts › ne devrait pas appeler le service si les dates sont invalides

    Cannot use spyOn on a primitive value; undefined given

      91 |         // Remplacer la vérification des dates dans le hook useConflictDetection avec une implémentation simplifiée
      92 |         // qui va toujours réussir pour les tests
    > 93 |         jest.spyOn(useConflictDetection.prototype as any, 'validateDates').mockImplementation(() => true);
         |              ^
      94 |     });
      95 |
      96 |     it('devrait initialiser correctement le hook', () => {

      at ModuleMocker.spyOn (node_modules/jest-mock/build/index.js:719:13)
      at Object.<anonymous> (src/modules/leaves/hooks/useConflictDetection.test.ts:93:14)

  ● useConflictDetection › getConflictsByType › devrait filtrer les conflits par type

    Cannot use spyOn on a primitive value; undefined given

      91 |         // Remplacer la vérification des dates dans le hook useConflictDetection avec une implémentation simplifiée
      92 |         // qui va toujours réussir pour les tests
    > 93 |         jest.spyOn(useConflictDetection.prototype as any, 'validateDates').mockImplementation(() => true);
         |              ^
      94 |     });
      95 |
      96 |     it('devrait initialiser correctement le hook', () => {

      at ModuleMocker.spyOn (node_modules/jest-mock/build/index.js:719:13)
      at Object.<anonymous> (src/modules/leaves/hooks/useConflictDetection.test.ts:93:14)

  ● useConflictDetection › resolveConflict › devrait supprimer un conflit et mettre à jour l'état des conflits bloquants

    Cannot use spyOn on a primitive value; undefined given

      91 |         // Remplacer la vérification des dates dans le hook useConflictDetection avec une implémentation simplifiée
      92 |         // qui va toujours réussir pour les tests
    > 93 |         jest.spyOn(useConflictDetection.prototype as any, 'validateDates').mockImplementation(() => true);
         |              ^
      94 |     });
      95 |
      96 |     it('devrait initialiser correctement le hook', () => {

      at ModuleMocker.spyOn (node_modules/jest-mock/build/index.js:719:13)
      at Object.<anonymous> (src/modules/leaves/hooks/useConflictDetection.test.ts:93:14)

  ● useConflictDetection › resetConflicts › devrait réinitialiser l'état des conflits

    Cannot use spyOn on a primitive value; undefined given

      91 |         // Remplacer la vérification des dates dans le hook useConflictDetection avec une implémentation simplifiée
      92 |         // qui va toujours réussir pour les tests
    > 93 |         jest.spyOn(useConflictDetection.prototype as any, 'validateDates').mockImplementation(() => true);
         |              ^
      94 |     });
      95 |
      96 |     it('devrait initialiser correctement le hook', () => {

      at ModuleMocker.spyOn (node_modules/jest-mock/build/index.js:719:13)
      at Object.<anonymous> (src/modules/leaves/hooks/useConflictDetection.test.ts:93:14)

FAIL src/modules/leaves/services/__tests__/conflictRecommendationService.test.ts
  ● ConflictRecommendationService › analyzeConflicts › devrait identifier correctement les résolutions automatiques possibles

    expect(jest.fn()).toHaveBeenCalled()

    Expected number of calls: >= 1
    Received number of calls:    0

      134 |
      135 |             // Vérifier que l'événement a été émis pour les résolutions automatiques
    > 136 |             expect(mockEventBus.emit).toHaveBeenCalled();
          |                                       ^
      137 |         });
      138 |
      139 |         it('devrait calculer correctement la distribution des priorités', () => {

      at Object.<anonymous> (src/modules/leaves/services/__tests__/conflictRecommendationService.test.ts:136:39)

  ● ConflictRecommendationService › updateRules › devrait mettre à jour les règles et émettre un événement

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: {"data": {"updatedBy": "user", "updatedRules": ["priorityRules"]}, "type": "conflict.rules.updated"}

    Number of calls: 0

      186 |
      187 |             // Vérifier que l'événement a été émis
    > 188 |             expect(mockEventBus.emit).toHaveBeenCalledWith({
          |                                       ^
      189 |                 type: 'conflict.rules.updated',
      190 |                 data: {
      191 |                     updatedRules: Object.keys(newRules),

      at Object.<anonymous> (src/modules/leaves/services/__tests__/conflictRecommendationService.test.ts:188:39)

  ● ConflictRecommendationService › resetRulesToDefault › devrait réinitialiser les règles aux valeurs par défaut

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: {"data": {"resetToDefault": true, "updatedBy": "user", "updatedRules": ["all"]}, "type": "conflict.rules.updated"}

    Number of calls: 0

      215 |
      216 |             // Vérifier que l'événement a été émis
    > 217 |             expect(mockEventBus.emit).toHaveBeenCalledWith({
          |                                       ^
      218 |                 type: 'conflict.rules.updated',
      219 |                 data: {
      220 |                     updatedRules: ['all'],

      at Object.<anonymous> (src/modules/leaves/services/__tests__/conflictRecommendationService.test.ts:217:39)

FAIL src/modules/leaves/services/__tests__/leaveCalculator.comprehensive.test.ts
  ● LeaveCalculator - Tests Complets › Gestion des erreurs › should handle PublicHolidayService errors gracefully

    expect(received).not.toBeNull()

    Received: null

      298 |             const result = await calculateLeaveCountedDays(startDate, endDate, standardSchedule);
      299 |
    > 300 |             expect(result).not.toBeNull();
          |                                ^
      301 |             expect(result!.countedDays).toBe(5); // Fallback sans jours fériés
      302 |         });
      303 |

      at Object.<anonymous> (src/modules/leaves/services/__tests__/leaveCalculator.comprehensive.test.ts:300:32)

FAIL src/modules/leaves/services/leaveCalculator.test.ts
  ● leaveCalculator › calculateLeaveCountedDays › devrait calculer correctement les jours pour une période standard

    expect(received).toBe(expected) // Object.is equality

    Expected: 5
    Received: 0

      48 |
      49 |             expect(result).not.toBeNull();
    > 50 |             expect(result?.countedDays).toBe(5);
         |                                         ^
      51 |             expect(result?.naturalDays).toBe(5);
      52 |             expect(result?.halfDays).toBe(0);
      53 |         });

      at Object.<anonymous> (src/modules/leaves/services/leaveCalculator.test.ts:50:41)

  ● leaveCalculator › calculateLeaveCountedDays › devrait calculer correctement une demi-journée du matin

    expect(received).toBe(expected) // Object.is equality

    Expected: 0.5
    Received: 0

      63 |
      64 |             expect(result).not.toBeNull();
    > 65 |             expect(result?.countedDays).toBe(0.5);
         |                                         ^
      66 |             expect(result?.naturalDays).toBe(1);
      67 |             expect(result?.halfDays).toBe(1);
      68 |         });

      at Object.<anonymous> (src/modules/leaves/services/leaveCalculator.test.ts:65:41)

  ● leaveCalculator › calculateLeaveCountedDays › devrait calculer correctement une demi-journée de l'après-midi

    expect(received).toBe(expected) // Object.is equality

    Expected: 0.5
    Received: 0

      78 |
      79 |             expect(result).not.toBeNull();
    > 80 |             expect(result?.countedDays).toBe(0.5);
         |                                         ^
      81 |             expect(result?.naturalDays).toBe(1);
      82 |             expect(result?.halfDays).toBe(1);
      83 |         });

      at Object.<anonymous> (src/modules/leaves/services/leaveCalculator.test.ts:80:41)

  ● leaveCalculator › calculateLeaveCountedDays › devrait ignorer isHalfDay si startDate et endDate sont différents

    expect(received).toBe(expected) // Object.is equality

    Expected: 2
    Received: 0

      94 |
      95 |             expect(result).not.toBeNull();
    > 96 |             expect(result?.countedDays).toBe(2); // Devrait compter 2 jours complets
         |                                         ^
      97 |             expect(result?.naturalDays).toBe(2);
      98 |             expect(result?.halfDays).toBe(0);
      99 |         });

      at Object.<anonymous> (src/modules/leaves/services/leaveCalculator.test.ts:96:41)

  ● leaveCalculator › calculateLeaveCountedDays › devrait prendre en compte les jours fériés

    expect(received).toBe(expected) // Object.is equality

    Expected: 4
    Received: 0

      115 |
      116 |             expect(result).not.toBeNull();
    > 117 |             expect(result?.countedDays).toBe(4); // 5 jours - 1 jour férié
          |                                         ^
      118 |             expect(result?.naturalDays).toBe(5);
      119 |         });
      120 |

      at Object.<anonymous> (src/modules/leaves/services/leaveCalculator.test.ts:117:41)

FAIL src/modules/leaves/permissions/__tests__/LeavePermissionService.test.ts
  ● LeavePermissionService › grantPermission › devrait accorder une permission à un utilisateur

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      344 |
      345 |             // Assert
    > 346 |             expect(result).toBe(true);
          |                            ^
      347 |             expect(mockFetch).toHaveBeenCalledWith(
      348 |                 `/api/leaves/permissions/${userId}/grant`,
      349 |                 expect.objectContaining({

      at Object.<anonymous> (src/modules/leaves/permissions/__tests__/LeavePermissionService.test.ts:346:28)

  ● LeavePermissionService › grantPermission › devrait retourner false si l'API échoue

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: Anything, StringContaining "Échoué (API: 500)", Anything, ObjectContaining {"granterId": "manager-456", "permission": "leaves.reports.view", "userId": "test-user"}

    Number of calls: 0

      383 |             expect(result).toBe(false);
      384 |             expect(mockFetch).toHaveBeenCalledTimes(1);
    > 385 |             expect(mockAuditServiceInstance.logPermissionChange).toHaveBeenCalledWith(
          |                                                                  ^
      386 |                 expect.anything(), // AuditActionType.PERMISSION_GRANT_FAILED - utiliser expect.anything() pour l'instant
      387 |                 expect.stringContaining('Échoué (API: 500)'),
      388 |                 expect.anything(), // AuditSeverity.ERROR - utiliser expect.anything() pour l'instant

      at Object.<anonymous> (src/modules/leaves/permissions/__tests__/LeavePermissionService.test.ts:385:66)

  ● LeavePermissionService › revokePermission › devrait révoquer une permission d'un utilisateur

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      410 |
      411 |             // Assert
    > 412 |             expect(result).toBe(true);
          |                            ^
      413 |             expect(mockFetch).toHaveBeenCalledWith(
      414 |                 `/api/leaves/permissions/${userId}/revoke`,
      415 |                 expect.objectContaining({

      at Object.<anonymous> (src/modules/leaves/permissions/__tests__/LeavePermissionService.test.ts:412:28)

  ● LeavePermissionService › revokePermission › devrait retourner false si l'API échoue

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: Anything, StringContaining "Échoué (API: 500)", Anything, ObjectContaining {"granterId": "manager-456", "permission": "leaves.reports.view", "userId": "test-user"}

    Number of calls: 0

      445 |             expect(result).toBe(false);
      446 |             expect(mockFetch).toHaveBeenCalledTimes(1);
    > 447 |             expect(mockAuditServiceInstance.logPermissionChange).toHaveBeenCalledWith(
          |                                                                  ^
      448 |                 expect.anything(),
      449 |                 expect.stringContaining('Échoué (API: 500)'),
      450 |                 expect.anything(),

      at Object.<anonymous> (src/modules/leaves/permissions/__tests__/LeavePermissionService.test.ts:447:66)

  ● LeavePermissionService › getUserPermissions › devrait retourner toutes les permissions d'un utilisateur

    expect(received).toEqual(expected) // deep equality

    - Expected  - 4
    + Received  + 1

    - Array [
    -   "leaves.reports.view",
    -   "leaves.request",
    - ]
    + Array []

      471 |             // Assert
      472 |             expect(mockFetch).toHaveBeenCalledWith(`/api/users/${userId}`);
    > 473 |             expect(permissions).toEqual(mockPermissions);
          |                                 ^
      474 |         });
      475 |
      476 |         it('devrait retourner un tableau vide si l\'API échoue', async () => {

      at Object.<anonymous> (src/modules/leaves/permissions/__tests__/LeavePermissionService.test.ts:473:33)

  ● LeavePermissionService › resetUserPermissions › devrait réinitialiser les permissions personnalisées d'un utilisateur

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "/api/leaves/permissions/custom-user-123/reset", ObjectContaining {"method": "POST"}
    Received: "/api/leaves/permissions/custom-user-123", {"method": "DELETE"}

    Number of calls: 1

      533 |             // Assert
      534 |             expect(result).toBe(true);
    > 535 |             expect(mockFetch).toHaveBeenCalledWith(
          |                               ^
      536 |                 `/api/leaves/permissions/${userId}/reset`,
      537 |                 expect.objectContaining({ method: 'POST' })
      538 |             );

      at Object.<anonymous> (src/modules/leaves/permissions/__tests__/LeavePermissionService.test.ts:535:31)

  ● LeavePermissionService › resetUserPermissions › devrait retourner false si l'API échoue

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: Anything, StringContaining "Échoué (API: 500)", Anything, ObjectContaining {"granterId": "manager-456", "userId": "test-user"}

    Number of calls: 0

      553 |             // Assert
      554 |             expect(result).toBe(false);
    > 555 |             expect(mockAuditServiceInstance.logPermissionChange).toHaveBeenCalledWith(
          |                                                                  ^
      556 |                 expect.anything(), // AuditActionType.PERMISSION_RESET_FAILED
      557 |                 expect.stringContaining('Échoué (API: 500)'),
      558 |                 expect.anything(), // AuditSeverity.ERROR

      at Object.<anonymous> (src/modules/leaves/permissions/__tests__/LeavePermissionService.test.ts:555:66)

FAIL src/modules/leaves/services/quotaService.test.ts
  ● quotaService › simulateQuotaTransfer › calcule correctement un transfert avec ratio personnalisé

    expect(received).toBe(expected) // Object.is equality

    Expected: 2
    Received: 4

      112 |             expect(result.success).toBe(true);
      113 |             expect(result.sourceAmount).toBe(4);
    > 114 |             expect(result.targetAmount).toBe(2);
          |                                         ^
      115 |         });
      116 |
      117 |         it('refuse le transfert si le montant est insuffisant', async () => {

      at Object.<anonymous> (src/modules/leaves/services/quotaService.test.ts:114:41)

FAIL src/modules/leaves/hooks/useLeave.test.ts
  ● useLeave Hook › should initialize with null leave and empty leaves array when no initialLeave provided

    expect(received).toBe(expected) // Object.is equality

    Expected: false
    Received: true

      172 |         expect(result.current.leave).toBeNull();
      173 |         expect(result.current.leaves).toEqual([]);
    > 174 |         expect(result.current.loading).toBe(false);
          |                                        ^
      175 |         expect(result.current.error).toBeNull();
      176 |         expect(result.current.conflictCheckResult).toBeNull();
      177 |         expect(result.current.allowanceCheckResult).toBeNull();

      at Object.<anonymous> (src/modules/leaves/hooks/useLeave.test.ts:174:40)

  ● useLeave Hook › checkConflicts › should call checkLeaveConflicts service with Date objects and update state on success

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      461 |
      462 |             // Vérifier que loading était true pendant l'appel
    > 463 |             expect(loadingDuringCall).toBe(true);
          |                                       ^
      464 |
      465 |             // Vérifier les états après l'appel
      466 |             expect(result.current.loading).toBe(false);

      at Object.<anonymous> (src/modules/leaves/hooks/useLeave.test.ts:463:39)

  ● useLeave Hook › checkConflicts › should return null if userId is missing

    expect(jest.fn()).not.toHaveBeenCalled()

    Expected number of calls: 0
    Received number of calls: 1

    1: 2024-09-01T22:00:00.000Z, 2024-09-05T22:00:00.000Z, "user123", "leave-initial"

      589 |
      590 |             // Vérifier que le service n'a pas été appelé
    > 591 |             expect(mockedCheckLeaveConflicts).not.toHaveBeenCalled();
          |                                                   ^
      592 |
      593 |             // Vérifier que setError a été appelé avec les informations appropriées
      594 |             expect(mockedSetError).toHaveBeenCalledWith(

      at Object.<anonymous> (src/modules/leaves/hooks/useLeave.test.ts:591:51)

  ● useLeave Hook › fetchUserLeaves › should set error state if fetchLeaves service fails

    Fetch leaves failed

      1097 |
      1098 |         it('should set error state if fetchLeaves service fails', async () => {
    > 1099 |             const mockError = new Error('Fetch leaves failed');
           |                               ^
      1100 |             mockedFetchLeaves.mockRejectedValueOnce(mockError);
      1101 |
      1102 |             const { result } = renderHook(() => useLeave({ userId: mockUserId }));

      at Object.<anonymous> (src/modules/leaves/hooks/useLeave.test.ts:1099:31)

  ● useLeave Hook › fetchUserLeaves › should set error state if fetchLeaves service fails

    expect(received).toEqual(expected) // deep equality

    - Expected  -  1
    + Received  + 14

    - Array []
    + Array [
    +   Object {
    +     "countedDays": 5,
    +     "createdAt": 2024-07-31T22:00:00.000Z,
    +     "endDate": 2024-09-05T22:00:00.000Z,
    +     "id": "leave-initial",
    +     "requestDate": 2024-07-31T22:00:00.000Z,
    +     "startDate": 2024-09-01T22:00:00.000Z,
    +     "status": "DRAFT",
    +     "type": "ANNUAL",
    +     "updatedAt": 2024-07-31T22:00:00.000Z,
    +     "userId": "user123",
    +   },
    + ]

      1119 |                 severity: 'error'
      1120 |             });
    > 1121 |             expect(result.current.leaves).toEqual([]); // Liste reste vide
           |                                           ^
      1122 |         });
      1123 |     });
      1124 |

      at Object.<anonymous> (src/modules/leaves/hooks/useLeave.test.ts:1121:43)

  ● useLeave Hook › fetchLeaveDetails › should set error state if fetchLeaveById service fails

    Fetch details failed

      1146 |         it('should set error state if fetchLeaveById service fails', async () => {
      1147 |             const specificLeaveId = 'leave-fail';
    > 1148 |             const mockError = new Error('Fetch details failed');
           |                               ^
      1149 |             mockedFetchLeaveById.mockRejectedValueOnce(mockError);
      1150 |
      1151 |             const { result } = renderHook(() => useLeave({ userId: mockUserId }));

      at Object.<anonymous> (src/modules/leaves/hooks/useLeave.test.ts:1148:31)

FAIL src/modules/leaves/permissions/__tests__/LeavePermissionService.extended.test.ts
  ● LeavePermissionService (Tests avancés) › Cache de permissions › devrait invalider le cache d'un utilisateur

    Property `delete` does not exist in the provided object

      186 |             // Arrange
      187 |             const userId = mockEmployee.id;
    > 188 |             const cacheSpy = jest.spyOn(permissionService['permissionCache'], 'delete');
          |                                   ^
      189 |
      190 |             // Act
      191 |             permissionService.invalidateUserCache(mockEmployee.id);

      at ModuleMocker.spyOn (node_modules/jest-mock/build/index.js:731:13)
      at Object.<anonymous> (src/modules/leaves/permissions/__tests__/LeavePermissionService.extended.test.ts:188:35)

  ● LeavePermissionService (Tests avancés) › Cache de permissions › devrait configurer le cache avec les options fournies

    expect(jest.fn()).toHaveBeenCalled()

    Expected number of calls: >= 1
    Received number of calls:    0

      212 |
      213 |             // Assert
    > 214 |             expect(optionsSpy).toHaveBeenCalled();
          |                                ^
      215 |
      216 |             // Note: Ne pas tester les stats ici car elles peuvent varier en fonction de l'environnement
      217 |             // et de l'ordre d'exécution des tests

      at Object.<anonymous> (src/modules/leaves/permissions/__tests__/LeavePermissionService.extended.test.ts:214:32)

FAIL src/modules/leaves/hooks/useLeaveQuota.test.ts
  ● useLeaveQuota › devrait charger les quotas de congés

    expect(received).toBe(expected) // Object.is equality

    Expected: 12
    Received: 10

       99 |         expect(result.current.totalBalance.pending).toBe(5);
      100 |         expect(result.current.totalBalance.remaining).toBe(20);
    > 101 |         expect(result.current.quotasByType.length).toBe(12); // Mise à jour pour tous les types incluant PATERNITY et PARENTAL
          |                                                    ^
      102 |     });
      103 |
      104 |     it('devrait récupérer le quota pour un type spécifique', async () => {

      at Object.<anonymous> (src/modules/leaves/hooks/useLeaveQuota.test.ts:101:52)

FAIL src/modules/leaves/quotas/transfer/__tests__/useQuotaTransfer.test.tsx
  ● useQuotaTransfer › devrait charger les données initiales

    expect(received).not.toBeNull()

    Received: null

    Ignored nodes: comments, script, style
    [36m<html>[39m
      [36m<head />[39m
      [36m<body>[39m
        [36m<div />[39m
      [36m</body>[39m
    [36m</html>[39m

      130 |         expect(result.current.error).toBeNull();
      131 |
    > 132 |         await waitFor(() => expect(result.current.balance).not.toBeNull());
          |                                                                ^
      133 |
      134 |         // Vérifier l'état après chargement
      135 |         expect(result.current.loading).toBe(false);

      at src/modules/leaves/quotas/transfer/__tests__/useQuotaTransfer.test.tsx:132:64
      at callback (node_modules/@testing-library/dom/dist/config.js:47:12)
      at checkCallback (node_modules/@testing-library/dom/dist/wait-for.js:124:76)
      at checkCallback (node_modules/@testing-library/dom/dist/wait-for.js:118:16)
      at Timeout.task [as _onTimeout] (node_modules/jsdom/lib/jsdom/browser/Window.js:520:19)

  ● useQuotaTransfer › devrait calculer correctement les types disponibles

    expect(received).toContain(expected) // indexOf

    Expected value: "ANNUAL"
    Received array: []

      151 |
      152 |         // Vérifier les types sources disponibles
    > 153 |         expect(result.current.availableSourceTypes).toContain(LeaveType.ANNUAL);
          |                                                     ^
      154 |         expect(result.current.availableSourceTypes).toContain(LeaveType.RECOVERY);
      155 |
      156 |         // Vérifier les types cibles disponibles par source

      at Object.<anonymous> (src/modules/leaves/quotas/transfer/__tests__/useQuotaTransfer.test.tsx:153:53)

  ● useQuotaTransfer › devrait simuler un transfert correctement

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: {"sourceAmount": 5, "sourceType": "RECOVERY", "targetType": "ANNUAL", "userId": "mock-user-id"}, [{"createdAt": 2025-05-25T17:18:05.040Z, "id": "rule-1", "isActive": true, "name": "Récupération vers Congés Annuels", "ratio": 1, "ruleType": "STANDARD", "sourceType": "RECOVERY", "targetType": "ANNUAL", "updatedAt": 2025-05-25T17:18:05.040Z}]

    Number of calls: 0

      188 |
      189 |         // Vérifier les appels et le résultat
    > 190 |         expect(previewQuotaTransfer).toHaveBeenCalledWith(transferRequest, applicableRules);
          |                                      ^
      191 |         expect(simulationResult).toMatchObject({
      192 |             success: true,
      193 |             sourceAmount: 5,

      at Object.<anonymous> (src/modules/leaves/quotas/transfer/__tests__/useQuotaTransfer.test.tsx:190:38)

  ● useQuotaTransfer › devrait exécuter un transfert correctement

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: {"sourceAmount": 5, "sourceType": "RECOVERY", "targetType": "ANNUAL", "userId": "mock-user-id"}

    Number of calls: 0

      221 |
      222 |         // Vérifier les appels et le résultat
    > 223 |         expect(transferQuota).toHaveBeenCalledWith(transferRequest);
          |                               ^
      224 |         expect(fetchLeaveBalance).toHaveBeenCalledTimes(2);
      225 |         expect(transferResult).toEqual(mockTransferResult);
      226 |     });

      at Object.<anonymous> (src/modules/leaves/quotas/transfer/__tests__/useQuotaTransfer.test.tsx:223:31)

  ● useQuotaTransfer › devrait gérer les erreurs de transfert

    expect(received).toBe(expected) // Object.is equality

    Expected: "Erreur lors du transfert"
    Received: "Aucune règle de transfert n'est disponible pour Récupération vers Congés annuels"

      304 |         expect(transferResult.success).toBe(false);
      305 |         expect(result.current.transferError).toBeInstanceOf(Error);
    > 306 |         expect(result.current.transferError?.message).toBe(errorMessage);
          |                                                       ^
      307 |     });
      308 | }); 

      at Object.<anonymous> (src/modules/leaves/quotas/transfer/__tests__/useQuotaTransfer.test.tsx:306:55)

FAIL src/modules/leaves/services/conflictDetectionService.test.ts
  ● Test suite failed to run

    Cannot find module '../../../services/teamService' from 'src/modules/leaves/services/conflictDetectionService.test.ts'

       8 |
       9 | jest.mock('../../../services/userService');
    > 10 | jest.mock('../../../services/teamService');
         |      ^
      11 | jest.mock('../../../utils/performanceLogger');
      12 |
      13 | const MockUserService = UserService as jest.MockedClass<typeof UserService>;

      at Resolver._throwModNotFoundError (node_modules/jest-resolve/build/resolver.js:427:11)
      at Object.<anonymous> (src/modules/leaves/services/conflictDetectionService.test.ts:10:6)

FAIL src/modules/leaves/hooks/__tests__/useConflictDetection.test.ts (5.56 s)
  ● useConflictDetection › devrait initialiser correctement l'état et vérifier les conflits

    expect(received).toBe(expected) // Object.is equality

    Expected: false
    Received: true

    Ignored nodes: comments, script, style
    [36m<html>[39m
      [36m<head />[39m
      [36m<body>[39m
        [36m<div />[39m
      [36m</body>[39m
    [36m</html>[39m

      86 |
      87 |         // Attendre la fin du chargement
    > 88 |         await waitFor(() => expect(result.current.loading).toBe(false));
         |                                                            ^
      89 |
      90 |         // Assert : vérifier que la méthode du *service* a été appelée (indirectement par le hook)
      91 |         // Il faut peut-être ajuster ce que le hook passe au service

      at src/modules/leaves/hooks/__tests__/useConflictDetection.test.ts:88:60
      at callback (node_modules/@testing-library/dom/dist/config.js:47:12)
      at checkCallback (node_modules/@testing-library/dom/dist/wait-for.js:124:76)
      at checkCallback (node_modules/@testing-library/dom/dist/wait-for.js:118:16)
      at Timeout.task [as _onTimeout] (node_modules/jsdom/lib/jsdom/browser/Window.js:520:19)

  ● useConflictDetection - resolveConflict › devrait appeler le service (indirectement) et mettre à jour l'état après résolution

    expect(received).toBe(expected) // Object.is equality

    Expected: false
    Received: true

    Ignored nodes: comments, script, style
    [36m<html>[39m
      [36m<head />[39m
      [36m<body>[39m
        [36m<div />[39m
      [36m</body>[39m
    [36m</html>[39m

      160 |         // Charger les conflits initiaux en appelant checkConflicts avec des objets Date
      161 |         act(() => { result.current.checkConflicts(mockStartDateObj, mockEndDateObj); });
    > 162 |         await waitFor(() => expect(result.current.loading).toBe(false));
          |                                                            ^
      163 |         expect(result.current.conflicts).toEqual(initialConflictsResult.conflicts);
      164 |         expect(result.current.hasBlockingConflicts).toBe(true);
      165 |

      at src/modules/leaves/hooks/__tests__/useConflictDetection.test.ts:162:60
      at callback (node_modules/@testing-library/dom/dist/config.js:47:12)
      at checkCallback (node_modules/@testing-library/dom/dist/wait-for.js:124:76)
      at checkCallback (node_modules/@testing-library/dom/dist/wait-for.js:118:16)
      at Timeout.task [as _onTimeout] (node_modules/jsdom/lib/jsdom/browser/Window.js:520:19)

  ● useConflictDetection - resolveConflict › devrait gérer les erreurs lors de la résolution

    expect(received).toBe(expected) // Object.is equality

    Expected: false
    Received: true

    Ignored nodes: comments, script, style
    [36m<html>[39m
      [36m<head />[39m
      [36m<body>[39m
        [36m<div />[39m
      [36m</body>[39m
    [36m</html>[39m

      202 |         // Charger les conflits initiaux en appelant checkConflicts avec des objets Date
      203 |         act(() => { result.current.checkConflicts(mockStartDateObj, mockEndDateObj); });
    > 204 |         await waitFor(() => expect(result.current.loading).toBe(false));
          |                                                            ^
      205 |
      206 |         // Act : Appeler resolveConflict du hook. On s'attend à ce qu'il échoue.
      207 |         // Pour simuler l'échec, on pourrait mocker une dépendance ou modifier le hook

      at src/modules/leaves/hooks/__tests__/useConflictDetection.test.ts:204:60
      at callback (node_modules/@testing-library/dom/dist/config.js:47:12)
      at checkCallback (node_modules/@testing-library/dom/dist/wait-for.js:124:76)
      at checkCallback (node_modules/@testing-library/dom/dist/wait-for.js:118:16)
      at Timeout.task [as _onTimeout] (node_modules/jsdom/lib/jsdom/browser/Window.js:520:19)

  ● useConflictDetection - getConflictsByType › devrait filtrer les conflits par type

    expect(received).toBe(expected) // Object.is equality

    Expected: false
    Received: true

    Ignored nodes: comments, script, style
    [36m<html>[39m
      [36m<head />[39m
      [36m<body>[39m
        [36m<div />[39m
      [36m</body>[39m
    [36m</html>[39m

      244 |         // Charger les conflits en appelant checkConflicts avec des objets Date
      245 |         act(() => { result.current.checkConflicts(mockStartDateObj, mockEndDateObj); });
    > 246 |         await waitFor(() => expect(result.current.loading).toBe(false));
          |                                                            ^
      247 |
      248 |         // Act & Assert : Appeler getConflictsByType du *hook*
      249 |         expect(result.current.getConflictsByType(ConflictType.USER_LEAVE_OVERLAP)).toEqual([mockConflicts[0]]);

      at src/modules/leaves/hooks/__tests__/useConflictDetection.test.ts:246:60
      at callback (node_modules/@testing-library/dom/dist/config.js:47:12)
      at checkCallback (node_modules/@testing-library/dom/dist/wait-for.js:124:76)
      at checkCallback (node_modules/@testing-library/dom/dist/wait-for.js:118:16)
      at Timeout.task [as _onTimeout] (node_modules/jsdom/lib/jsdom/browser/Window.js:520:19)

FAIL src/modules/leaves/components/UserLeaveBalance.test.tsx (6.405 s)
  ● UserLeaveBalance Component › affiche correctement les soldes de congés

    Unable to find an element with the text: Congé Annuel. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<div[39m
          [33mclass[39m=[32m"rounded-lg border bg-card text-card-foreground shadow-sm dark:bg-slate-800 dark:border-slate-700 w-full"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"flex flex-col space-y-1.5 p-6"[39m
          [36m>[39m
            [36m<h3[39m
              [33mclass[39m=[32m"font-semibold tracking-tight bg-gradient-to-r from-primary-600 via-secondary-600 to-tertiary-600 bg-clip-text text-transparent text-lg"[39m
              [33mstyle[39m=[32m"background-clip: text;"[39m
            [36m>[39m
              [0mChargement des soldes...[0m
            [36m</h3>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"p-6 pt-0"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"space-y-3"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"animate-pulse rounded-md bg-muted h-4 w-full"[39m
              [36m/>[39m
              [36m<div[39m
                [33mclass[39m=[32m"animate-pulse rounded-md bg-muted h-4 w-full"[39m
              [36m/>[39m
              [36m<div[39m
                [33mclass[39m=[32m"animate-pulse rounded-md bg-muted h-4 w-full"[39m
              [36m/>[39m
            [36m</div>[39m
          [36m</div>[39m
        [36m</div>[39m
      [36m</div>[39m
    [36m</body>[39m

      74 |
      75 |         expectToBeInDocument(screen.getByText('Chargement des soldes...'));
    > 76 |         await waitFor(() => {
         |                      ^
      77 |             expectToBeInDocument(screen.getByText('Congé Annuel'));
      78 |         });
      79 |

      at waitForWrapper (node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at Object.<anonymous> (src/modules/leaves/components/UserLeaveBalance.test.tsx:76:22)

  ● UserLeaveBalance Component › affiche un message d'erreur si le chargement échoue

    Unable to find an element with the text: Erreur. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<div[39m
          [33mclass[39m=[32m"rounded-lg border bg-card text-card-foreground shadow-sm dark:bg-slate-800 dark:border-slate-700 w-full"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"flex flex-col space-y-1.5 p-6"[39m
          [36m>[39m
            [36m<h3[39m
              [33mclass[39m=[32m"font-semibold tracking-tight bg-gradient-to-r from-primary-600 via-secondary-600 to-tertiary-600 bg-clip-text text-transparent text-lg"[39m
              [33mstyle[39m=[32m"background-clip: text;"[39m
            [36m>[39m
              [0mChargement des soldes...[0m
            [36m</h3>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"p-6 pt-0"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"space-y-3"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"animate-pulse rounded-md bg-muted h-4 w-full"[39m
              [36m/>[39m
              [36m<div[39m
                [33mclass[39m=[32m"animate-pulse rounded-md bg-muted h-4 w-full"[39m
              [36m/>[39m
              [36m<div[39m
                [33mclass[39m=[32m"animate-pulse rounded-md bg-muted h-4 w-full"[39m
              [36m/>[39m
            [36m</div>[39m
          [36m</div>[39m
        [36m</div>[39m
      [36m</div>[39m
    [36m</body>[39m

       97 |         mockedAxios.get.mockRejectedValueOnce(new Error('Network error'));
       98 |         render(<UserLeaveBalance userId={123} />);
    >  99 |         await waitFor(() => {
          |                      ^
      100 |             expectToBeInDocument(screen.getByText('Erreur'));
      101 |         });
      102 |         expectToBeInDocument(screen.getByText('Impossible de charger les soldes de congés'));

      at waitForWrapper (node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at Object.<anonymous> (src/modules/leaves/components/UserLeaveBalance.test.tsx:99:22)

  ● UserLeaveBalance Component › affiche un message si aucun solde n'est disponible

    Unable to find an element with the text: Aucun solde disponible. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<div[39m
          [33mclass[39m=[32m"rounded-lg border bg-card text-card-foreground shadow-sm dark:bg-slate-800 dark:border-slate-700 w-full"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"flex flex-col space-y-1.5 p-6"[39m
          [36m>[39m
            [36m<h3[39m
              [33mclass[39m=[32m"font-semibold tracking-tight bg-gradient-to-r from-primary-600 via-secondary-600 to-tertiary-600 bg-clip-text text-transparent text-lg"[39m
              [33mstyle[39m=[32m"background-clip: text;"[39m
            [36m>[39m
              [0mChargement des soldes...[0m
            [36m</h3>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"p-6 pt-0"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"space-y-3"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"animate-pulse rounded-md bg-muted h-4 w-full"[39m
              [36m/>[39m
              [36m<div[39m
                [33mclass[39m=[32m"animate-pulse rounded-md bg-muted h-4 w-full"[39m
              [36m/>[39m
              [36m<div[39m
                [33mclass[39m=[32m"animate-pulse rounded-md bg-muted h-4 w-full"[39m
              [36m/>[39m
            [36m</div>[39m
          [36m</div>[39m
        [36m</div>[39m
      [36m</div>[39m
    [36m</body>[39m

      106 |         mockedAxios.get.mockResolvedValueOnce({ data: [] });
      107 |         render(<UserLeaveBalance userId={123} />);
    > 108 |         await waitFor(() => {
          |                      ^
      109 |             expectToBeInDocument(screen.getByText('Aucun solde disponible'));
      110 |         });
      111 |     });

      at waitForWrapper (node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at Object.<anonymous> (src/modules/leaves/components/UserLeaveBalance.test.tsx:108:22)

  ● UserLeaveBalance Component › respecte l'option compact=true en masquant les détails

    Unable to find an element with the text: Congé Annuel. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<div[39m
          [33mclass[39m=[32m"rounded-lg border bg-card text-card-foreground shadow-sm dark:bg-slate-800 dark:border-slate-700 w-full"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"flex flex-col space-y-1.5 p-6"[39m
          [36m>[39m
            [36m<h3[39m
              [33mclass[39m=[32m"font-semibold tracking-tight bg-gradient-to-r from-primary-600 via-secondary-600 to-tertiary-600 bg-clip-text text-transparent text-lg"[39m
              [33mstyle[39m=[32m"background-clip: text;"[39m
            [36m>[39m
              [0mChargement des soldes...[0m
            [36m</h3>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"p-6 pt-0"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"space-y-3"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"animate-pulse rounded-md bg-muted h-4 w-full"[39m
              [36m/>[39m
              [36m<div[39m
                [33mclass[39m=[32m"animate-pulse rounded-md bg-muted h-4 w-full"[39m
              [36m/>[39m
              [36m<div[39m
                [33mclass[39m=[32m"animate-pulse rounded-md bg-muted h-4 w-full"[39m
              [36m/>[39m
            [36m</div>[39m
          [36m</div>[39m
        [36m</div>[39m
      [36m</div>[39m
    [36m</body>[39m

      114 |         mockedAxios.get.mockResolvedValueOnce({ data: mockBalanceData });
      115 |         render(<UserLeaveBalance userId={123} compact={true} />);
    > 116 |         await waitFor(() => {
          |                      ^
      117 |             expectToBeInDocument(screen.getByText('Congé Annuel'));
      118 |         });
      119 |         expectToBeInDocument(screen.getByText('15.5 jours'));

      at waitForWrapper (node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at Object.<anonymous> (src/modules/leaves/components/UserLeaveBalance.test.tsx:116:22)

  ● UserLeaveBalance Component › respecte l'option hideHeader=true

    Unable to find an element with the text: Congé Annuel. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<div[39m
          [33mclass[39m=[32m"rounded-lg border bg-card text-card-foreground shadow-sm dark:bg-slate-800 dark:border-slate-700 w-full"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"p-6 pt-0"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"space-y-3"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"animate-pulse rounded-md bg-muted h-4 w-full"[39m
              [36m/>[39m
              [36m<div[39m
                [33mclass[39m=[32m"animate-pulse rounded-md bg-muted h-4 w-full"[39m
              [36m/>[39m
              [36m<div[39m
                [33mclass[39m=[32m"animate-pulse rounded-md bg-muted h-4 w-full"[39m
              [36m/>[39m
            [36m</div>[39m
          [36m</div>[39m
        [36m</div>[39m
      [36m</div>[39m
    [36m</body>[39m

      126 |         mockedAxios.get.mockResolvedValueOnce({ data: mockBalanceData });
      127 |         render(<UserLeaveBalance userId={123} hideHeader={true} />);
    > 128 |         await waitFor(() => {
          |                      ^
      129 |             expectToBeInDocument(screen.getByText('Congé Annuel'));
      130 |         });
      131 |         expectNotToBeInDocument(screen.queryByText('Soldes de congés'));

      at waitForWrapper (node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at Object.<anonymous> (src/modules/leaves/components/UserLeaveBalance.test.tsx:128:22)

FAIL src/modules/leaves/components/LeaveForm.test.tsx (12.829 s)
  ● LeaveForm › should handle error when loading leave types

    Unable to find an element with the display value: Erreur de chargement.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<form[39m
          [33mclass[39m=[32m"space-y-6 max-w-2xl mx-auto"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"bg-gradient-to-r from-indigo-50 to-blue-50 p-4 rounded-lg shadow-sm mb-6"[39m
          [36m>[39m
            [36m<h3[39m
              [33mclass[39m=[32m"text-lg font-medium text-gray-800 mb-2"[39m
            [36m>[39m
              [0mNouvelle demande de congé[0m
            [36m</h3>[39m
            [36m<p[39m
              [33mclass[39m=[32m"text-sm text-gray-600"[39m
            [36m>[39m
              [0mComplétez le formulaire ci-dessous pour soumettre votre demande.[0m
            [36m</p>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"bg-white p-6 rounded-lg shadow-md border border-gray-200"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"mb-6"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"flex items-center justify-between"[39m
              [36m>[39m
                [36m<label[39m
                  [33mclass[39m=[32m"block text-sm font-medium text-gray-700"[39m
                  [33mfor[39m=[32m"leaveType"[39m
                [36m>[39m
                  [0mType de congé[0m
                [36m</label>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"relative inline-block"[39m
                [36m>[39m
                  [36m<span[39m
                    [33mclass[39m=[32m"text-gray-400 hover:text-gray-600 cursor-help"[39m
                  [36m>[39m
                    [36m<svg[39m
                      [33maria-hidden[39m=[32m"true"[39m
                      [33mclass[39m=[32m"lucide lucide-circle-help h-4 w-4"[39m
                      [33mfill[39m=[32m"none"[39m
                      [33mheight[39m=[32m"24"[39m
                      [33mstroke[39m=[32m"currentColor"[39m
                      [33mstroke-linecap[39m=[32m"round"[39m
                      [33mstroke-linejoin[39m=[32m"round"[39m
                      [33mstroke-width[39m=[32m"2"[39m
                      [33mviewBox[39m=[32m"0 0 24 24"[39m
                      [33mwidth[39m=[32m"24"[39m
                      [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
                    [36m>[39m
                      [36m<circle[39m
                        [33mcx[39m=[32m"12"[39m
                        [33mcy[39m=[32m"12"[39m
                        [33mr[39m=[32m"10"[39m
                      [36m/>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"[39m
                      [36m/>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M12 17h.01"[39m
                      [36m/>[39m
                    [36m</svg>[39m
                  [36m</span>[39m
                [36m</div>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mclass[39m=[32m"mt-1 relative"[39m
              [36m>[39m
                [36m<select[39m
                  [33mclass[39m=[32m"block w-full rounded-md border-gray-300 shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm py-2 px-3"[39m
                  [33mdisabled[39m=[32m""[39m
                  [33mid[39m=[32m"leaveType"[39m
                  [33mname[39m=[32m"leaveType"[39m
                  [33mrequired[39m=[32m""[39m
                [36m>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m""[39m
                  [36m>[39m
                    [0mChargement...[0m
                  [36m</option>[39m
                [36m</select>[39m
              [36m</div>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mclass[39m=[32m"grid grid-cols-1 gap-6 md:grid-cols-2 mb-6"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"relative"[39m
              [36m>[39m
                [36m<label[39m
                  [33mclass[39m=[32m"block text-sm font-medium text-gray-700 mb-1"[39m
                  [33mfor[39m=[32m"startDate"[39m
                [36m>[39m
                  [0mDate de début[0m
                [36m</label>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"relative"[39m
                [36m>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"react-datepicker-wrapper"[39m
                  [36m>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"react-datepicker__input-container"[39m
                    [36m>[39m
                      [36m<input[39m
                        [33mautocomplete[39m=[32m"off"[39m
                        [33mclass[39m=[32m"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 pl-10 pr-4 py-2 disabled:bg-gray-100 disabled:cursor-not-allowed"[39m
                        [33mid[39m=[32m"startDate"[39m
                        [33mplaceholder[39m=[32m"Sélectionner une date"[39m
                        [33mtype[39m=[32m"text"[39m
                        [33mvalue[39m=[32m""[39m
                      [36m/>[39m
                    [36m</div>[39m
                  [36m</div>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"[39m
                  [36m>[39m
                    [36m<svg[39m
                      [33maria-hidden[39m=[32m"true"[39m
                      [33mclass[39m=[32m"lucide lucide-calendar h-5 w-5 text-gray-400"[39m
                      [33mfill[39m=[32m"none"[39m
                      [33mheight[39m=[32m"24"[39m
                      [33mstroke[39m=[32m"currentColor"[39m
                      [33mstroke-linecap[39m=[32m"round"[39m
                      [33mstroke-linejoin[39m=[32m"round"[39m
                      [33mstroke-width[39m=[32m"2"[39m
                      [33mviewBox[39m=[32m"0 0 24 24"[39m
                      [33mwidth[39m=[32m"24"[39m
                      [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
                    [36m>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M8 2v4"[39m
                      [36m/>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M16 2v4"[39m
                      [36m/>[39m
                      [36m<rect[39m
                        [33mheight[39m=[32m"18"[39m
                        [33mrx[39m=[32m"2"[39m
                        [33mwidth[39m=[32m"18"[39m
                        [33mx[39m=[32m"3"[39m
                        [33my[39m=[32m"4"[39m
                      [36m/>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M3 10h18"[39m
                      [36m/>[39m
                    [36m</svg>[39m
                  [36m</div>[39m
                [36m</div>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mclass[39m=[32m"relative"[39m
              [36m>[39m
                [36m<label[39m
                  [33mclass[39m=[32m"block text-sm font-medium text-gray-700 mb-1"[39m
                  [33mfor[39m=[32m"endDate"[39m
                [36m>[39m
                  [0mDate de fin[0m
                [36m</label>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"relative"[39m
                [36m>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"react-datepicker-wrapper"[39m
                  [36m>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"react-datepicker__input-container"[39m
                    [36m>[39m
                      [36m<input[39m
                        [33mautocomplete[39m=[32m"off"[39m
                        [33mclass[39m=[32m"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 pl-10 pr-4 py-2 disabled:bg-gray-100 disabled:cursor-not-allowed"[39m
                        [33mid[39m=[32m"endDate"[39m
                        [33mplaceholder[39m=[32m"Sélectionner une date"[39m
                        [33mtype[39m=[32m"text"[39m
                        [33mvalue[39m=[32m""[39m
                      [36m/>[39m
                    [36m</div>[39m
                  [36m</div>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"[39m
                  [36m>[39m
                    [36m<svg[39m
                      [33maria-hidden[39m=[32m"true"[39m
                      [33mclass[39m=[32m"lucide lucide-calendar h-5 w-5 text-gray-400"[39m
                      [33mfill[39m=[32m"none"[39m
                      [33mheight[39m=[32m"24"[39m
                      [33mstroke[39m=[32m"currentColor"[39m
                      [33mstroke-linecap[39m=[32m"round"[39m
                      [33mstroke-linejoin[39m=[32m"round"[39m
                      [33mstroke-width[39m=[32m"2"[39m
                      [33mviewBox[39m=[32m"0 0 24 24"[39m
                      [33mwidth[39m=[32m"24"[39m
                      [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
                    [36m>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M8 2v4"[39m
                      [36m/>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M16 2v4"[39m
                      [36m/>[39m
                      [36m<rect[39m
                        [33mheight[39m=[32m"18"[39m
                        [33mrx[39m=[32m"2"[39m
                        [33mwidth[39m=[32m"18"[39m
                        [33mx[39m=[32m"3"[39m
                        [33my[39m=[32m"4"[39m
                      [36m/>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M3 10h18"[39m
                      [36m/>[39m
                    [36m</svg>[39m
                  [36m</div>[39m
                [36m</div>[39m
              [36m</div>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mclass[39m=[32m"mb-6"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"flex flex-col space-y-4 p-4 bg-gray-50 rounded-md border border-gray-200"[39m
              [36m>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"flex items-center"[39m
                [36m>[39m
                  [36m<input[39m
                    [33mclass[39m=[32m"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"[39m
                    [33mdisabled[39m=[32m""[39m
                    [33mid[39m=[32m"isHalfDay"[39m
                    [33mname[39m=[32m"isHalfDay"[39m
                    [33mtype[39m=[32m"checkbox"[39m
                  [36m/>[39m
                  [36m<label[39m
                    [33mclass[39m=[32m"ml-2 block text-sm font-medium text-gray-700"[39m
                    [33mfor[39m=[32m"isHalfDay"[39m
                  [36m>[39m
                    [0mDemi-journée[0m
                  [36m</label>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"relative inline-block"[39m
                  [36m>[39m
                    [36m<span[39m
                      [33mclass[39m=[32m"text-gray-400 hover:text-gray-600 cursor-help ml-1"[39m
                    [36m>[39m
                      [36m<svg[39m
                        [33maria-hidden[39m=[32m"true"[39m
                        [33mclass[39m=[32m"lucide lucide-circle-help h-4 w-4"[39m
                        [33mfill[39m=[32m"none"[39m
                        [33mheight[39m=[32m"24"[39m
                        [33mstroke[39m=[32m"currentColor"[39m
                        [33mstroke-linecap[39m=[32m"round"[39m
                        [33mstroke-linejoin[39m=[32m"round"[39m
                        [33mstroke-width[39m=[32m"2"[39m
                        [33mviewBox[39m=[32m"0 0 24 24"[39m
                        [33mwidth[39m=[32m"24"[39m
                        [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
                      [36m>[39m
                        [36m<circle[39m
                          [33mcx[39m=[32m"12"[39m
                          [33mcy[39m=[32m"12"[39m
                          [33mr[39m=[32m"10"[39m
                        [36m/>[39m
                        [36m<path[39m
                          [33md[39m=[32m"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"[39m
                        [36m/>[39m
                        [36m<path[39m
                          [33md[39m=[32m"M12 17h.01"[39m
                        [36m/>[39m
                      [36m</svg>[39m
                    [36m</span>[39m
                  [36m</div>[39m
                [36m</div>[39m
              [36m</div>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mclass[39m=[32m"space-y-3 mb-6"[39m
            [36m/>[39m
            [36m<div[39m
              [33mclass[39m=[32m"mb-6"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"flex items-center justify-between"[39m
              [36m>[39m
                [36m<label[39m
                  [33mclass[39m=[32m"block text-sm font-medium text-gray-700"[39m
                  [33mfor[39m=[32m"reason"[39m
                [36m>[39m
                  [0mMotif (optionnel)[0m
                [36m</label>[39m
                [36m<span[39m
                  [33mclass[39m=[32m"text-xs text-gray-500"[39m
                [36m>[39m
                  [0mMax. 200 caractères[0m
                [36m</span>[39m
              [36m</div>[39m
              [36m<textarea[39m
                [33mclass[39m=[32m"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"[39m
                [33mid[39m=[32m"reason"[39m
                [33mmaxlength[39m=[32m"200"[39m
                [33mname[39m=[32m"reason"[39m
                [33mplaceholder[39m=[32m"Précisez le motif de votre demande si nécessaire..."[39m
                [33mrows[39m=[32m"3"[39m
              [36m/>[39m
            [36m</div>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"flex justify-end mt-8"[39m
          [36m>[39m
            [36m<button[39m
              [33mclass[39m=[32m"inline-flex items-center justify-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-60 disabled:cursor-not-allowed transition-opacity"[39m
              [33mdisabled[39m=[32m""[39m
              [33mtype[39m=[32m"submit"[39m
            [36m>[39m
              [0mSoumettre la demande[0m
            [36m</button>[39m
          [36m</div>[39m
        [36m</form>[39m
      [36m</div>[39m
    [36m</body>[39m

      258 |         (global.fetch as jest.Mock).mockRejectedValue(new Error('Failed to fetch types'));
      259 |         renderTheForm();
    > 260 |         await waitFor(() => {
          |                      ^
      261 |             expectToBeInDocument(screen.getByDisplayValue('Erreur de chargement'));
      262 |         });
      263 |     });

      at waitForWrapper (node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at Object.<anonymous> (src/modules/leaves/components/LeaveForm.test.tsx:260:22)

  ● LeaveForm › should call useLeaveCalculation with initial dates and options

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: {"endDate": null, "options": {"countHalfDays": false, "halfDayPeriod": undefined}, "startDate": null}
    Received
           1
              Object {
                "endDate": null,
                "options": Object {
            -     "countHalfDays": false,
                  "halfDayPeriod": undefined,
            +     "isHalfDay": false,
                },
                "startDate": null,
              },
           2
              Object {
                "endDate": null,
                "options": Object {
            -     "countHalfDays": false,
                  "halfDayPeriod": undefined,
            +     "isHalfDay": false,
                },
                "startDate": null,
              },

    Number of calls: 2

      45 |  */
      46 | export function expectToHaveBeenCalledWith(mockFn: MockFn, ...args: any[]): void {
    > 47 |     expect(mockFn).toHaveBeenCalledWith(...args);
         |                    ^
      48 | }
      49 |
      50 | /**

      at toHaveBeenCalledWith (src/tests/utils/assertions.ts:47:20)
      at Object.<anonymous> (src/modules/leaves/components/LeaveForm.test.tsx:267:35)

  ● LeaveForm › should update useLeaveCalculation when dates change

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: {"endDate": null, "options": {"countHalfDays": false, "halfDayPeriod": undefined}, "startDate": null}
    Received
           1
              Object {
                "endDate": null,
                "options": Object {
            -     "countHalfDays": false,
                  "halfDayPeriod": undefined,
            +     "isHalfDay": false,
                },
                "startDate": null,
              },
           2
              Object {
                "endDate": null,
                "options": Object {
            -     "countHalfDays": false,
                  "halfDayPeriod": undefined,
            +     "isHalfDay": false,
                },
                "startDate": null,
              },

    Number of calls: 2

      45 |  */
      46 | export function expectToHaveBeenCalledWith(mockFn: MockFn, ...args: any[]): void {
    > 47 |     expect(mockFn).toHaveBeenCalledWith(...args);
         |                    ^
      48 | }
      49 |
      50 | /**

      at toHaveBeenCalledWith (src/tests/utils/assertions.ts:47:20)
      at Object.<anonymous> (src/modules/leaves/components/LeaveForm.test.tsx:280:35)

  ● LeaveForm › should handle half-day selection

    expect(element).toBeChecked()

    Received element is not checked:
      <input class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded" disabled="" id="isHalfDay" name="isHalfDay" type="checkbox" />

      73 |  */
      74 | export function expectToBeChecked(element: HTMLElement | null | undefined): void {
    > 75 |     expect(element).toBeChecked();
         |                     ^
      76 | }
      77 |
      78 | /**

      at toBeChecked (src/tests/utils/assertions.ts:75:21)
      at Object.<anonymous> (src/modules/leaves/components/LeaveForm.test.tsx:346:26)

  ● LeaveForm › should validate form on submit and show errors if invalid

    Unable to find an element with the text: La date de début est requise.. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<form[39m
          [33mclass[39m=[32m"space-y-6 max-w-2xl mx-auto"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"bg-gradient-to-r from-indigo-50 to-blue-50 p-4 rounded-lg shadow-sm mb-6"[39m
          [36m>[39m
            [36m<h3[39m
              [33mclass[39m=[32m"text-lg font-medium text-gray-800 mb-2"[39m
            [36m>[39m
              [0mNouvelle demande de congé[0m
            [36m</h3>[39m
            [36m<p[39m
              [33mclass[39m=[32m"text-sm text-gray-600"[39m
            [36m>[39m
              [0mComplétez le formulaire ci-dessous pour soumettre votre demande.[0m
            [36m</p>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"bg-white p-6 rounded-lg shadow-md border border-gray-200"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"mb-6"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"flex items-center justify-between"[39m
              [36m>[39m
                [36m<label[39m
                  [33mclass[39m=[32m"block text-sm font-medium text-gray-700"[39m
                  [33mfor[39m=[32m"leaveType"[39m
                [36m>[39m
                  [0mType de congé[0m
                [36m</label>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"relative inline-block"[39m
                [36m>[39m
                  [36m<span[39m
                    [33mclass[39m=[32m"text-gray-400 hover:text-gray-600 cursor-help"[39m
                  [36m>[39m
                    [36m<svg[39m
                      [33maria-hidden[39m=[32m"true"[39m
                      [33mclass[39m=[32m"lucide lucide-circle-help h-4 w-4"[39m
                      [33mfill[39m=[32m"none"[39m
                      [33mheight[39m=[32m"24"[39m
                      [33mstroke[39m=[32m"currentColor"[39m
                      [33mstroke-linecap[39m=[32m"round"[39m
                      [33mstroke-linejoin[39m=[32m"round"[39m
                      [33mstroke-width[39m=[32m"2"[39m
                      [33mviewBox[39m=[32m"0 0 24 24"[39m
                      [33mwidth[39m=[32m"24"[39m
                      [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
                    [36m>[39m
                      [36m<circle[39m
                        [33mcx[39m=[32m"12"[39m
                        [33mcy[39m=[32m"12"[39m
                        [33mr[39m=[32m"10"[39m
                      [36m/>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"[39m
                      [36m/>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M12 17h.01"[39m
                      [36m/>[39m
                    [36m</svg>[39m
                  [36m</span>[39m
                [36m</div>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mclass[39m=[32m"mt-1 relative"[39m
              [36m>[39m
                [36m<select[39m
                  [33mclass[39m=[32m"block w-full rounded-md border-gray-300 shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm py-2 px-3"[39m
                  [33mdisabled[39m=[32m""[39m
                  [33mid[39m=[32m"leaveType"[39m
                  [33mname[39m=[32m"leaveType"[39m
                  [33mrequired[39m=[32m""[39m
                [36m>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m""[39m
                  [36m>[39m
                    [0mChargement...[0m
                  [36m</option>[39m
                [36m</select>[39m
              [36m</div>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mclass[39m=[32m"grid grid-cols-1 gap-6 md:grid-cols-2 mb-6"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"relative"[39m
              [36m>[39m
                [36m<label[39m
                  [33mclass[39m=[32m"block text-sm font-medium text-gray-700 mb-1"[39m
                  [33mfor[39m=[32m"startDate"[39m
                [36m>[39m
                  [0mDate de début[0m
                [36m</label>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"relative"[39m
                [36m>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"react-datepicker-wrapper"[39m
                  [36m>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"react-datepicker__input-container"[39m
                    [36m>[39m
                      [36m<input[39m
                        [33mautocomplete[39m=[32m"off"[39m
                        [33mclass[39m=[32m"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 pl-10 pr-4 py-2 disabled:bg-gray-100 disabled:cursor-not-allowed"[39m
                        [33mid[39m=[32m"startDate"[39m
                        [33mplaceholder[39m=[32m"Sélectionner une date"[39m
                        [33mtype[39m=[32m"text"[39m
                        [33mvalue[39m=[32m""[39m
                      [36m/>[39m
                    [36m</div>[39m
                  [36m</div>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"[39m
                  [36m>[39m
                    [36m<svg[39m
                      [33maria-hidden[39m=[32m"true"[39m
                      [33mclass[39m=[32m"lucide lucide-calendar h-5 w-5 text-gray-400"[39m
                      [33mfill[39m=[32m"none"[39m
                      [33mheight[39m=[32m"24"[39m
                      [33mstroke[39m=[32m"currentColor"[39m
                      [33mstroke-linecap[39m=[32m"round"[39m
                      [33mstroke-linejoin[39m=[32m"round"[39m
                      [33mstroke-width[39m=[32m"2"[39m
                      [33mviewBox[39m=[32m"0 0 24 24"[39m
                      [33mwidth[39m=[32m"24"[39m
                      [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
                    [36m>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M8 2v4"[39m
                      [36m/>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M16 2v4"[39m
                      [36m/>[39m
                      [36m<rect[39m
                        [33mheight[39m=[32m"18"[39m
                        [33mrx[39m=[32m"2"[39m
                        [33mwidth[39m=[32m"18"[39m
                        [33mx[39m=[32m"3"[39m
                        [33my[39m=[32m"4"[39m
                      [36m/>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M3 10h18"[39m
                      [36m/>[39m
                    [36m</svg>[39m
                  [36m</div>[39m
                [36m</div>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mclass[39m=[32m"relative"[39m
              [36m>[39m
                [36m<label[39m
                  [33mclass[39m=[32m"block text-sm font-medium text-gray-700 mb-1"[39m
                  [33mfor[39m=[32m"endDate"[39m
                [36m>[39m
                  [0mDate de fin[0m
                [36m</label>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"relative"[39m
                [36m>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"react-datepicker-wrapper"[39m
                  [36m>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"react-datepicker__input-container"[39m
                    [36m>[39m
                      [36m<input[39m
                        [33mautocomplete[39m=[32m"off"[39m
                        [33mclass[39m=[32m"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 pl-10 pr-4 py-2 disabled:bg-gray-100 disabled:cursor-not-allowed"[39m
                        [33mid[39m=[32m"endDate"[39m
                        [33mplaceholder[39m=[32m"Sélectionner une date"[39m
                        [33mtype[39m=[32m"text"[39m
                        [33mvalue[39m=[32m""[39m
                      [36m/>[39m
                    [36m</div>[39m
                  [36m</div>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"[39m
                  [36m>[39m
                    [36m<svg[39m
                      [33maria-hidden[39m=[32m"true"[39m
                      [33mclass[39m=[32m"lucide lucide-calendar h-5 w-5 text-gray-400"[39m
                      [33mfill[39m=[32m"none"[39m
                      [33mheight[39m=[32m"24"[39m
                      [33mstroke[39m=[32m"currentColor"[39m
                      [33mstroke-linecap[39m=[32m"round"[39m
                      [33mstroke-linejoin[39m=[32m"round"[39m
                      [33mstroke-width[39m=[32m"2"[39m
                      [33mviewBox[39m=[32m"0 0 24 24"[39m
                      [33mwidth[39m=[32m"24"[39m
                      [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
                    [36m>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M8 2v4"[39m
                      [36m/>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M16 2v4"[39m
                      [36m/>[39m
                      [36m<rect[39m
                        [33mheight[39m=[32m"18"[39m
                        [33mrx[39m=[32m"2"[39m
                        [33mwidth[39m=[32m"18"[39m
                        [33mx[39m=[32m"3"[39m
                        [33my[39m=[32m"4"[39m
                      [36m/>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M3 10h18"[39m
                      [36m/>[39m
                    [36m</svg>[39m
                  [36m</div>[39m
                [36m</div>[39m
              [36m</div>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mclass[39m=[32m"mb-6"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"flex flex-col space-y-4 p-4 bg-gray-50 rounded-md border border-gray-200"[39m
              [36m>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"flex items-center"[39m
                [36m>[39m
                  [36m<input[39m
                    [33mclass[39m=[32m"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"[39m
                    [33mdisabled[39m=[32m""[39m
                    [33mid[39m=[32m"isHalfDay"[39m
                    [33mname[39m=[32m"isHalfDay"[39m
                    [33mtype[39m=[32m"checkbox"[39m
                  [36m/>[39m
                  [36m<label[39m
                    [33mclass[39m=[32m"ml-2 block text-sm font-medium text-gray-700"[39m
                    [33mfor[39m=[32m"isHalfDay"[39m
                  [36m>[39m
                    [0mDemi-journée[0m
                  [36m</label>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"relative inline-block"[39m
                  [36m>[39m
                    [36m<span[39m
                      [33mclass[39m=[32m"text-gray-400 hover:text-gray-600 cursor-help ml-1"[39m
                    [36m>[39m
                      [36m<svg[39m
                        [33maria-hidden[39m=[32m"true"[39m
                        [33mclass[39m=[32m"lucide lucide-circle-help h-4 w-4"[39m
                        [33mfill[39m=[32m"none"[39m
                        [33mheight[39m=[32m"24"[39m
                        [33mstroke[39m=[32m"currentColor"[39m
                        [33mstroke-linecap[39m=[32m"round"[39m
                        [33mstroke-linejoin[39m=[32m"round"[39m
                        [33mstroke-width[39m=[32m"2"[39m
                        [33mviewBox[39m=[32m"0 0 24 24"[39m
                        [33mwidth[39m=[32m"24"[39m
                        [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
                      [36m>[39m
                        [36m<circle[39m
                          [33mcx[39m=[32m"12"[39m
                          [33mcy[39m=[32m"12"[39m
                          [33mr[39m=[32m"10"[39m
                        [36m/>[39m
                        [36m<path[39m
                          [33md[39m=[32m"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"[39m
                        [36m/>[39m
                        [36m<path[39m
                          [33md[39m=[32m"M12 17h.01"[39m
                        [36m/>[39m
                      [36m</svg>[39m
                    [36m</span>[39m
                  [36m</div>[39m
                [36m</div>[39m
              [36m</div>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mclass[39m=[32m"space-y-3 mb-6"[39m
            [36m/>[39m
            [36m<div[39m
              [33mclass[39m=[32m"mb-6"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"flex items-center justify-between"[39m
              [36m>[39m
                [36m<label[39m
                  [33mclass[39m=[32m"block text-sm font-medium text-gray-700"[39m
                  [33mfor[39m=[32m"reason"[39m
                [36m>[39m
                  [0mMotif (optionnel)[0m
                [36m</label>[39m
                [36m<span[39m
                  [33mclass[39m=[32m"text-xs text-gray-500"[39m
                [36m>[39m
                  [0mMax. 200 caractères[0m
                [36m</span>[39m
              [36m</div>[39m
              [36m<textarea[39m
                [33mclass[39m=[32m"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"[39m
                [33mid[39m=[32m"reason"[39m
                [33mmaxlength[39m=[32m"200"[39m
                [33mname[39m=[32m"reason"[39m
                [33mplaceholder[39m=[32m"Précisez le motif de votre demande si nécessaire..."[39m
                [33mrows[39m=[32m"3"[39m
              [36m/>[39m
            [36m</div>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"flex justify-end mt-8"[39m
          [36m>[39m
            [36m<button[39m
              [33mclass[39m=[32m"inline-flex items-center justify-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-60 disabled:cursor-not-allowed transition-opacity"[39m
              [33mdisabled[39m=[32m""[39m
              [33mtype[39m=[32m"submit"[39m
            [36m>[39m
              [0mSoumettre la demande[0m
            [36m</button>[39m
          [36m</div>[39m
        [36m</form>[39m
      [36m</div>[39m
    [36m</body>[39m

      406 |         await user.click(submitButton); // Soumission sans dates
      407 |
    > 408 |         expectToBeInDocument(await screen.findByText('La date de début est requise.'));
          |                                           ^
      409 |         expectToBeInDocument(screen.getByText('La date de fin est requise.'));
      410 |         expectNotToHaveBeenCalled(mockedAxios.post);
      411 |     });

      at waitForWrapper (node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at node_modules/@testing-library/dom/dist/query-helpers.js:86:32
      at Object.<anonymous> (src/modules/leaves/components/LeaveForm.test.tsx:408:43)

  ● LeaveForm › Form Submission › should submit valid data to /api/leaves/batch and handle success

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "/api/leaves/batch", [ObjectContaining {"endDate": "2024-09-03", "reason": "Vacances annuelles", "startDate": "2024-09-02", "typeCode": "ANNUAL", "userId": 1}]

    Number of calls: 0

    Ignored nodes: comments, script, style
    [36m<html>[39m
      [36m<head />[39m
      [36m<body>[39m
        [36m<div>[39m
          [36m<form[39m
            [33mclass[39m=[32m"space-y-6 max-w-2xl mx-auto"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"bg-gradient-to-r from-indigo-50 to-blue-50 p-4 rounded-lg shadow-sm mb-6"[39m
            [36m>[39m
              [36m<h3[39m
                [33mclass[39m=[32m"text-lg font-medium text-gray-800 mb-2"[39m
              [36m>[39m
                [0mNouvelle demande de congé[0m
              [36m</h3>[39m
              [36m<p[39m
                [33mclass[39m=[32m"text-sm text-gray-600"[39m
              [36m>[39m
                [0mComplétez le formulaire ci-dessous pour soumettre votre demande.[0m
              [36m</p>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mclass[39m=[32m"bg-white p-6 rounded-lg shadow-md border border-gray-200"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"mb-6"[39m
              [36m>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"flex items-center justify-between"[39m
                [36m>[39m
                  [36m<label[39m
                    [33mclass[39m=[32m"block text-sm font-medium text-gray-700"[39m
                    [33mfor[39m=[32m"leaveType"[39m
                  [36m>[39m
                    [0mType de congé[0m
                  [36m</label>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"relative inline-block"[39m
                  [36m>[39m
                    [36m<span[39m
                      [33mclass[39m=[32m"text-gray-400 hover:text-gray-600 cursor-help"[39m
                    [36m>[39m
                      [36m<svg[39m
                        [33maria-hidden[39m=[32m"true"[39m
                        [33mclass[39m=[32m"lucide lucide-circle-help h-4 w-4"[39m
                        [33mfill[39m=[32m"none"[39m
                        [33mheight[39m=[32m"24"[39m
                        [33mstroke[39m=[32m"currentColor"[39m
                        [33mstroke-linecap[39m=[32m"round"[39m
                        [33mstroke-linejoin[39m=[32m"round"[39m
                        [33mstroke-width[39m=[32m"2"[39m
                        [33mviewBox[39m=[32m"0 0 24 24"[39m
                        [33mwidth[39m=[32m"24"[39m
                        [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
                      [36m>[39m
                        [36m<circle[39m
                          [33mcx[39m=[32m"12"[39m
                          [33mcy[39m=[32m"12"[39m
                          [33mr[39m=[32m"10"[39m
                        [36m/>[39m
                        [36m<path[39m
                          [33md[39m=[32m"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"[39m
                        [36m/>[39m
                        [36m<path[39m
                          [33md[39m=[32m"M12 17h.01"[39m
                        [36m/>[39m
                      [36m</svg>[39m
                    [36m</span>[39m
                  [36m</div>[39m
                [36m</div>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"mt-1 relative"[39m
                [36m>[39m
                  [36m<select[39m
                    [33mclass[39m=[32m"block w-full rounded-md border-gray-300 shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm py-2 px-3"[39m
                    [33mid[39m=[32m"leaveType"[39m
                    [33mname[39m=[32m"leaveType"[39m
                    [33mrequired[39m=[32m""[39m
                  [36m>[39m
                    [36m<option[39m
                      [33mvalue[39m=[32m""[39m
                    [36m>[39m
                      [0m-- Sélectionner un type --[0m
                    [36m</option>[39m
                    [36m<option[39m
                      [33mtitle[39m=[32m"Congés annuels bruts"[39m
                      [33mvalue[39m=[32m"ANNUAL"[39m
                    [36m>[39m
                      [0mCongé annuel[0m
                    [36m</option>[39m
                    [36m<option[39m
                      [33mtitle[39m=[32m"RTT bruts"[39m
                      [33mvalue[39m=[32m"RTT"[39m
                    [36m>[39m
                      [0mRTT API (Raw)[0m
                    [36m</option>[39m
                    [36m<option[39m
                      [33mtitle[39m=[32m"Congé maladie brut"[39m
                      [33mvalue[39m=[32m"SICK"[39m
                    [36m>[39m
                      [0mMaladie[0m
                    [36m</option>[39m
                  [36m</select>[39m
                [36m</div>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mclass[39m=[32m"grid grid-cols-1 gap-6 md:grid-cols-2 mb-6"[39m
              [36m>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"relative"[39m
                [36m>[39m
                  [36m<label[39m
                    [33mclass[39m=[32m"block text-sm font-medium text-gray-700 mb-1"[39m
                    [33mfor[39m=[32m"startDate"[39m
                  [36m>[39m
                    [0mDate de début[0m
                  [36m</label>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"relative"[39m
                  [36m>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"react-datepicker-wrapper"[39m
                    [36m>[39m
                      [36m<div[39m
                        [33mclass[39m=[32m"react-datepicker__input-container"[39m
                      [36m>[39m
                        [36m<input[39m
                          [33mautocomplete[39m=[32m"off"[39m
                          [33mclass[39m=[32m"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 pl-10 pr-4 py-2 disabled:bg-gray-100 disabled:cursor-not-allowed"[39m
                          [33mid[39m=[32m"startDate"[39m
                          [33mplaceholder[39m=[32m"Sélectionner une date"[39m
                          [33mtype[39m=[32m"text"[39m
                          [33mvalue[39m=[32m""[39m
                        [36m/>[39m
                      [36m</div>[39m
                    [36m</div>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"[39m
                    [36m>[39m
                      [36m<svg[39m
                        [33maria-hidden[39m=[32m"true"[39m
                        [33mclass[39m=[32m"lucide lucide-calendar h-5 w-5 text-gray-400"[39m
                        [33mfill[39m=[32m"none"[39m
                        [33mheight[39m=[32m"24"[39m
                        [33mstroke[39m=[32m"currentColor"[39m
                        [33mstroke-linecap[39m=[32m"round"[39m
                        [33mstroke-linejoin[39m=[32m"round"[39m
                        [33mstroke-width[39m=[32m"2"[39m
                        [33mviewBox[39m=[32m"0 0 24 24"[39m
                        [33mwidth[39m=[32m"24"[39m
                        [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
            ...

      45 |  */
      46 | export function expectToHaveBeenCalledWith(mockFn: MockFn, ...args: any[]): void {
    > 47 |     expect(mockFn).toHaveBeenCalledWith(...args);
         |                    ^
      48 | }
      49 |
      50 | /**

      at toHaveBeenCalledWith (src/tests/utils/assertions.ts:47:20)
      at src/modules/leaves/components/LeaveForm.test.tsx:507:43
      at callback (node_modules/@testing-library/dom/dist/config.js:47:12)
      at checkCallback (node_modules/@testing-library/dom/dist/wait-for.js:124:76)
      at checkCallback (node_modules/@testing-library/dom/dist/wait-for.js:118:16)
      at Timeout.task [as _onTimeout] (node_modules/jsdom/lib/jsdom/browser/Window.js:520:19)

  ● LeaveForm › Form Submission › should handle API error from /api/leaves/batch on submit

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "/api/leaves/batch", Any<Array>

    Number of calls: 0

    Ignored nodes: comments, script, style
    [36m<html>[39m
      [36m<head />[39m
      [36m<body>[39m
        [36m<div>[39m
          [36m<form[39m
            [33mclass[39m=[32m"space-y-6 max-w-2xl mx-auto"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"bg-gradient-to-r from-indigo-50 to-blue-50 p-4 rounded-lg shadow-sm mb-6"[39m
            [36m>[39m
              [36m<h3[39m
                [33mclass[39m=[32m"text-lg font-medium text-gray-800 mb-2"[39m
              [36m>[39m
                [0mNouvelle demande de congé[0m
              [36m</h3>[39m
              [36m<p[39m
                [33mclass[39m=[32m"text-sm text-gray-600"[39m
              [36m>[39m
                [0mComplétez le formulaire ci-dessous pour soumettre votre demande.[0m
              [36m</p>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mclass[39m=[32m"bg-white p-6 rounded-lg shadow-md border border-gray-200"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"mb-6"[39m
              [36m>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"flex items-center justify-between"[39m
                [36m>[39m
                  [36m<label[39m
                    [33mclass[39m=[32m"block text-sm font-medium text-gray-700"[39m
                    [33mfor[39m=[32m"leaveType"[39m
                  [36m>[39m
                    [0mType de congé[0m
                  [36m</label>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"relative inline-block"[39m
                  [36m>[39m
                    [36m<span[39m
                      [33mclass[39m=[32m"text-gray-400 hover:text-gray-600 cursor-help"[39m
                    [36m>[39m
                      [36m<svg[39m
                        [33maria-hidden[39m=[32m"true"[39m
                        [33mclass[39m=[32m"lucide lucide-circle-help h-4 w-4"[39m
                        [33mfill[39m=[32m"none"[39m
                        [33mheight[39m=[32m"24"[39m
                        [33mstroke[39m=[32m"currentColor"[39m
                        [33mstroke-linecap[39m=[32m"round"[39m
                        [33mstroke-linejoin[39m=[32m"round"[39m
                        [33mstroke-width[39m=[32m"2"[39m
                        [33mviewBox[39m=[32m"0 0 24 24"[39m
                        [33mwidth[39m=[32m"24"[39m
                        [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
                      [36m>[39m
                        [36m<circle[39m
                          [33mcx[39m=[32m"12"[39m
                          [33mcy[39m=[32m"12"[39m
                          [33mr[39m=[32m"10"[39m
                        [36m/>[39m
                        [36m<path[39m
                          [33md[39m=[32m"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"[39m
                        [36m/>[39m
                        [36m<path[39m
                          [33md[39m=[32m"M12 17h.01"[39m
                        [36m/>[39m
                      [36m</svg>[39m
                    [36m</span>[39m
                  [36m</div>[39m
                [36m</div>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"mt-1 relative"[39m
                [36m>[39m
                  [36m<select[39m
                    [33mclass[39m=[32m"block w-full rounded-md border-gray-300 shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm py-2 px-3"[39m
                    [33mid[39m=[32m"leaveType"[39m
                    [33mname[39m=[32m"leaveType"[39m
                    [33mrequired[39m=[32m""[39m
                  [36m>[39m
                    [36m<option[39m
                      [33mvalue[39m=[32m""[39m
                    [36m>[39m
                      [0m-- Sélectionner un type --[0m
                    [36m</option>[39m
                    [36m<option[39m
                      [33mtitle[39m=[32m"Congés annuels bruts"[39m
                      [33mvalue[39m=[32m"ANNUAL"[39m
                    [36m>[39m
                      [0mCongé annuel[0m
                    [36m</option>[39m
                    [36m<option[39m
                      [33mtitle[39m=[32m"RTT bruts"[39m
                      [33mvalue[39m=[32m"RTT"[39m
                    [36m>[39m
                      [0mRTT API (Raw)[0m
                    [36m</option>[39m
                    [36m<option[39m
                      [33mtitle[39m=[32m"Congé maladie brut"[39m
                      [33mvalue[39m=[32m"SICK"[39m
                    [36m>[39m
                      [0mMaladie[0m
                    [36m</option>[39m
                  [36m</select>[39m
                [36m</div>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mclass[39m=[32m"grid grid-cols-1 gap-6 md:grid-cols-2 mb-6"[39m
              [36m>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"relative"[39m
                [36m>[39m
                  [36m<label[39m
                    [33mclass[39m=[32m"block text-sm font-medium text-gray-700 mb-1"[39m
                    [33mfor[39m=[32m"startDate"[39m
                  [36m>[39m
                    [0mDate de début[0m
                  [36m</label>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"relative"[39m
                  [36m>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"react-datepicker-wrapper"[39m
                    [36m>[39m
                      [36m<div[39m
                        [33mclass[39m=[32m"react-datepicker__input-container"[39m
                      [36m>[39m
                        [36m<input[39m
                          [33mautocomplete[39m=[32m"off"[39m
                          [33mclass[39m=[32m"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 pl-10 pr-4 py-2 disabled:bg-gray-100 disabled:cursor-not-allowed"[39m
                          [33mid[39m=[32m"startDate"[39m
                          [33mplaceholder[39m=[32m"Sélectionner une date"[39m
                          [33mtype[39m=[32m"text"[39m
                          [33mvalue[39m=[32m""[39m
                        [36m/>[39m
                      [36m</div>[39m
                    [36m</div>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"[39m
                    [36m>[39m
                      [36m<svg[39m
                        [33maria-hidden[39m=[32m"true"[39m
                        [33mclass[39m=[32m"lucide lucide-calendar h-5 w-5 text-gray-400"[39m
                        [33mfill[39m=[32m"none"[39m
                        [33mheight[39m=[32m"24"[39m
                        [33mstroke[39m=[32m"currentColor"[39m
                        [33mstroke-linecap[39m=[32m"round"[39m
                        [33mstroke-linejoin[39m=[32m"round"[39m
                        [33mstroke-width[39m=[32m"2"[39m
                        [33mviewBox[39m=[32m"0 0 24 24"[39m
                        [33mwidth[39m=[32m"24"[39m
                        [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
            ...

      45 |  */
      46 | export function expectToHaveBeenCalledWith(mockFn: MockFn, ...args: any[]): void {
    > 47 |     expect(mockFn).toHaveBeenCalledWith(...args);
         |                    ^
      48 | }
      49 |
      50 | /**

      at toHaveBeenCalledWith (src/tests/utils/assertions.ts:47:20)
      at src/modules/leaves/components/LeaveForm.test.tsx:572:43
      at callback (node_modules/@testing-library/dom/dist/config.js:47:12)
      at checkCallback (node_modules/@testing-library/dom/dist/wait-for.js:124:76)
      at checkCallback (node_modules/@testing-library/dom/dist/wait-for.js:118:16)
      at Timeout.task [as _onTimeout] (node_modules/jsdom/lib/jsdom/browser/Window.js:520:19)

  ● LeaveForm › Form Submission › should handle general network error on submit

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: "/api/leaves/batch", Any<Array>

    Number of calls: 0

    Ignored nodes: comments, script, style
    [36m<html>[39m
      [36m<head />[39m
      [36m<body>[39m
        [36m<div>[39m
          [36m<form[39m
            [33mclass[39m=[32m"space-y-6 max-w-2xl mx-auto"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"bg-gradient-to-r from-indigo-50 to-blue-50 p-4 rounded-lg shadow-sm mb-6"[39m
            [36m>[39m
              [36m<h3[39m
                [33mclass[39m=[32m"text-lg font-medium text-gray-800 mb-2"[39m
              [36m>[39m
                [0mNouvelle demande de congé[0m
              [36m</h3>[39m
              [36m<p[39m
                [33mclass[39m=[32m"text-sm text-gray-600"[39m
              [36m>[39m
                [0mComplétez le formulaire ci-dessous pour soumettre votre demande.[0m
              [36m</p>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mclass[39m=[32m"bg-white p-6 rounded-lg shadow-md border border-gray-200"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"mb-6"[39m
              [36m>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"flex items-center justify-between"[39m
                [36m>[39m
                  [36m<label[39m
                    [33mclass[39m=[32m"block text-sm font-medium text-gray-700"[39m
                    [33mfor[39m=[32m"leaveType"[39m
                  [36m>[39m
                    [0mType de congé[0m
                  [36m</label>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"relative inline-block"[39m
                  [36m>[39m
                    [36m<span[39m
                      [33mclass[39m=[32m"text-gray-400 hover:text-gray-600 cursor-help"[39m
                    [36m>[39m
                      [36m<svg[39m
                        [33maria-hidden[39m=[32m"true"[39m
                        [33mclass[39m=[32m"lucide lucide-circle-help h-4 w-4"[39m
                        [33mfill[39m=[32m"none"[39m
                        [33mheight[39m=[32m"24"[39m
                        [33mstroke[39m=[32m"currentColor"[39m
                        [33mstroke-linecap[39m=[32m"round"[39m
                        [33mstroke-linejoin[39m=[32m"round"[39m
                        [33mstroke-width[39m=[32m"2"[39m
                        [33mviewBox[39m=[32m"0 0 24 24"[39m
                        [33mwidth[39m=[32m"24"[39m
                        [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
                      [36m>[39m
                        [36m<circle[39m
                          [33mcx[39m=[32m"12"[39m
                          [33mcy[39m=[32m"12"[39m
                          [33mr[39m=[32m"10"[39m
                        [36m/>[39m
                        [36m<path[39m
                          [33md[39m=[32m"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"[39m
                        [36m/>[39m
                        [36m<path[39m
                          [33md[39m=[32m"M12 17h.01"[39m
                        [36m/>[39m
                      [36m</svg>[39m
                    [36m</span>[39m
                  [36m</div>[39m
                [36m</div>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"mt-1 relative"[39m
                [36m>[39m
                  [36m<select[39m
                    [33mclass[39m=[32m"block w-full rounded-md border-gray-300 shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm py-2 px-3"[39m
                    [33mid[39m=[32m"leaveType"[39m
                    [33mname[39m=[32m"leaveType"[39m
                    [33mrequired[39m=[32m""[39m
                  [36m>[39m
                    [36m<option[39m
                      [33mvalue[39m=[32m""[39m
                    [36m>[39m
                      [0m-- Sélectionner un type --[0m
                    [36m</option>[39m
                    [36m<option[39m
                      [33mtitle[39m=[32m"Congés annuels bruts"[39m
                      [33mvalue[39m=[32m"ANNUAL"[39m
                    [36m>[39m
                      [0mCongé annuel[0m
                    [36m</option>[39m
                    [36m<option[39m
                      [33mtitle[39m=[32m"RTT bruts"[39m
                      [33mvalue[39m=[32m"RTT"[39m
                    [36m>[39m
                      [0mRTT API (Raw)[0m
                    [36m</option>[39m
                    [36m<option[39m
                      [33mtitle[39m=[32m"Congé maladie brut"[39m
                      [33mvalue[39m=[32m"SICK"[39m
                    [36m>[39m
                      [0mMaladie[0m
                    [36m</option>[39m
                  [36m</select>[39m
                [36m</div>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mclass[39m=[32m"grid grid-cols-1 gap-6 md:grid-cols-2 mb-6"[39m
              [36m>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"relative"[39m
                [36m>[39m
                  [36m<label[39m
                    [33mclass[39m=[32m"block text-sm font-medium text-gray-700 mb-1"[39m
                    [33mfor[39m=[32m"startDate"[39m
                  [36m>[39m
                    [0mDate de début[0m
                  [36m</label>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"relative"[39m
                  [36m>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"react-datepicker-wrapper"[39m
                    [36m>[39m
                      [36m<div[39m
                        [33mclass[39m=[32m"react-datepicker__input-container"[39m
                      [36m>[39m
                        [36m<input[39m
                          [33mautocomplete[39m=[32m"off"[39m
                          [33mclass[39m=[32m"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 pl-10 pr-4 py-2 disabled:bg-gray-100 disabled:cursor-not-allowed"[39m
                          [33mid[39m=[32m"startDate"[39m
                          [33mplaceholder[39m=[32m"Sélectionner une date"[39m
                          [33mtype[39m=[32m"text"[39m
                          [33mvalue[39m=[32m""[39m
                        [36m/>[39m
                      [36m</div>[39m
                    [36m</div>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"[39m
                    [36m>[39m
                      [36m<svg[39m
                        [33maria-hidden[39m=[32m"true"[39m
                        [33mclass[39m=[32m"lucide lucide-calendar h-5 w-5 text-gray-400"[39m
                        [33mfill[39m=[32m"none"[39m
                        [33mheight[39m=[32m"24"[39m
                        [33mstroke[39m=[32m"currentColor"[39m
                        [33mstroke-linecap[39m=[32m"round"[39m
                        [33mstroke-linejoin[39m=[32m"round"[39m
                        [33mstroke-width[39m=[32m"2"[39m
                        [33mviewBox[39m=[32m"0 0 24 24"[39m
                        [33mwidth[39m=[32m"24"[39m
                        [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
            ...

      45 |  */
      46 | export function expectToHaveBeenCalledWith(mockFn: MockFn, ...args: any[]): void {
    > 47 |     expect(mockFn).toHaveBeenCalledWith(...args);
         |                    ^
      48 | }
      49 |
      50 | /**

      at toHaveBeenCalledWith (src/tests/utils/assertions.ts:47:20)
      at src/modules/leaves/components/LeaveForm.test.tsx:611:43
      at callback (node_modules/@testing-library/dom/dist/config.js:47:12)
      at checkCallback (node_modules/@testing-library/dom/dist/wait-for.js:124:76)
      at checkCallback (node_modules/@testing-library/dom/dist/wait-for.js:118:16)
      at Timeout.task [as _onTimeout] (node_modules/jsdom/lib/jsdom/browser/Window.js:520:19)

  ● LeaveForm › Form Submission › should not submit if calculation is not successful

    Unable to find an element with the text: /Calcul des jours en cours.../i. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<form[39m
          [33mclass[39m=[32m"space-y-6 max-w-2xl mx-auto"[39m
        [36m>[39m
          [36m<div[39m
            [33mclass[39m=[32m"bg-gradient-to-r from-indigo-50 to-blue-50 p-4 rounded-lg shadow-sm mb-6"[39m
          [36m>[39m
            [36m<h3[39m
              [33mclass[39m=[32m"text-lg font-medium text-gray-800 mb-2"[39m
            [36m>[39m
              [0mNouvelle demande de congé[0m
            [36m</h3>[39m
            [36m<p[39m
              [33mclass[39m=[32m"text-sm text-gray-600"[39m
            [36m>[39m
              [0mComplétez le formulaire ci-dessous pour soumettre votre demande.[0m
            [36m</p>[39m
          [36m</div>[39m
          [36m<div[39m
            [33mclass[39m=[32m"bg-white p-6 rounded-lg shadow-md border border-gray-200"[39m
          [36m>[39m
            [36m<div[39m
              [33mclass[39m=[32m"mb-6"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"flex items-center justify-between"[39m
              [36m>[39m
                [36m<label[39m
                  [33mclass[39m=[32m"block text-sm font-medium text-gray-700"[39m
                  [33mfor[39m=[32m"leaveType"[39m
                [36m>[39m
                  [0mType de congé[0m
                [36m</label>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"relative inline-block"[39m
                [36m>[39m
                  [36m<span[39m
                    [33mclass[39m=[32m"text-gray-400 hover:text-gray-600 cursor-help"[39m
                  [36m>[39m
                    [36m<svg[39m
                      [33maria-hidden[39m=[32m"true"[39m
                      [33mclass[39m=[32m"lucide lucide-circle-help h-4 w-4"[39m
                      [33mfill[39m=[32m"none"[39m
                      [33mheight[39m=[32m"24"[39m
                      [33mstroke[39m=[32m"currentColor"[39m
                      [33mstroke-linecap[39m=[32m"round"[39m
                      [33mstroke-linejoin[39m=[32m"round"[39m
                      [33mstroke-width[39m=[32m"2"[39m
                      [33mviewBox[39m=[32m"0 0 24 24"[39m
                      [33mwidth[39m=[32m"24"[39m
                      [33mxmlns[39m=[32m"http://www.w3.org/2000/svg"[39m
                    [36m>[39m
                      [36m<circle[39m
                        [33mcx[39m=[32m"12"[39m
                        [33mcy[39m=[32m"12"[39m
                        [33mr[39m=[32m"10"[39m
                      [36m/>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"[39m
                      [36m/>[39m
                      [36m<path[39m
                        [33md[39m=[32m"M12 17h.01"[39m
                      [36m/>[39m
                    [36m</svg>[39m
                  [36m</span>[39m
                [36m</div>[39m
              [36m</div>[39m
              [36m<div[39m
                [33mclass[39m=[32m"mt-1 relative"[39m
              [36m>[39m
                [36m<select[39m
                  [33mclass[39m=[32m"block w-full rounded-md border-gray-300 shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm py-2 px-3"[39m
                  [33mid[39m=[32m"leaveType"[39m
                  [33mname[39m=[32m"leaveType"[39m
                  [33mrequired[39m=[32m""[39m
                [36m>[39m
                  [36m<option[39m
                    [33mvalue[39m=[32m""[39m
                  [36m>[39m
                    [0m-- Sélectionner un type --[0m
                  [36m</option>[39m
                  [36m<option[39m
                    [33mtitle[39m=[32m"Congés annuels bruts"[39m
                    [33mvalue[39m=[32m"ANNUAL"[39m
                  [36m>[39m
                    [0mCongé annuel[0m
                  [36m</option>[39m
                  [36m<option[39m
                    [33mtitle[39m=[32m"RTT bruts"[39m
                    [33mvalue[39m=[32m"RTT"[39m
                  [36m>[39m
                    [0mRTT API (Raw)[0m
                  [36m</option>[39m
                  [36m<option[39m
                    [33mtitle[39m=[32m"Congé maladie brut"[39m
                    [33mvalue[39m=[32m"SICK"[39m
                  [36m>[39m
                    [0mMaladie[0m
                  [36m</option>[39m
                [36m</select>[39m
              [36m</div>[39m
            [36m</div>[39m
            [36m<div[39m
              [33mclass[39m=[32m"grid grid-cols-1 gap-6 md:grid-cols-2 mb-6"[39m
            [36m>[39m
              [36m<div[39m
                [33mclass[39m=[32m"relative"[39m
              [36m>[39m
                [36m<label[39m
                  [33mclass[39m=[32m"block text-sm font-medium text-gray-700 mb-1"[39m
                  [33mfor[39m=[32m"startDate"[39m
                [36m>[39m
                  [0mDate de début[0m
                [36m</label>[39m
                [36m<div[39m
                  [33mclass[39m=[32m"relative"[39m
                [36m>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"react-datepicker-wrapper"[39m
                  [36m>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"react-datepicker__input-container"[39m
                    [36m>[39m
                      [36m<input[39m
                        [33mautocomplete[39m=[32m"off"[39m
                        [33mclass[39m=[32m"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 pl-10 pr-4 py-2 disabled:bg-gray-100 disabled:cursor-not-allowed react-datepicker-ignore-onclickoutside"[39m
                        [33mid[39m=[32m"startDate"[39m
                        [33mplaceholder[39m=[32m"Sélectionner une date"[39m
                        [33mtype[39m=[32m"text"[39m
                        [33mvalue[39m=[32m"02/09/2024"[39m
                      [36m/>[39m
                    [36m</div>[39m
                  [36m</div>[39m
                  [36m<div[39m
                    [33mclass[39m=[32m"react-datepicker__tab-loop"[39m
                  [36m>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"react-datepicker__tab-loop__start"[39m
                      [33mtabindex[39m=[32m"0"[39m
                    [36m/>[39m
                    [36m<div[39m
                      [33mclass[39m=[32m"react-datepicker-popper z-50"[39m
                      [33mdata-placement[39m=[32m"bottom"[39m
                      [33mstyle[39m=[32m"position: absolute; left: 0px; top: 0px; transform: translate(0px, 10px);"[39m
                    [36m>[39m
                      [36m<div[39m
                        [33mstyle[39m=[32m"display: contents;"[39m
                      [36m>[39m
                        [36m<div[39m
                          [33mstyle[39m=[32m"display: contents;"[39m
                        [36m>[39m
                          [36m<div[39m
                            [33maria-label[39m=[32m"Choose Date"[39m
                            [33maria-modal[39m=[32m"true"[39m
                            [33mclass[39m=[32m"react-datepicker shadow-lg rounded-md border bo...

      653 |             await fillDatesInForm(user, '02/09/2024', '03/09/2024');
      654 |             // Le hook est mocké pour retourner 'loading' avec ces dates.
    > 655 |             await screen.findByText(/Calcul des jours en cours.../i, {}, { timeout: 3000 });
          |                          ^
      656 |
      657 |             const submitButton = screen.getByText('Soumettre la demande');
      658 |             await user.click(submitButton);

      at waitForWrapper (node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at node_modules/@testing-library/dom/dist/query-helpers.js:86:32
      at Object.<anonymous> (src/modules/leaves/components/LeaveForm.test.tsx:655:26)


Test Suites: 15 failed, 3 skipped, 15 passed, 30 of 33 total
Tests:       67 failed, 14 skipped, 357 passed, 438 total
Snapshots:   0 total
Time:        14.804 s
Ran all test suites matching /src\/modules\/leaves|src\/lib\/auth/i.
</small>
            </div>
        

        
        <div class="recommendations">
            <h2>💡 Recommandations</h2>
            <ul>
                <li>Bundle total trop volumineux. Considérer le code splitting.</li><li>9 fichiers volumineux détectés. Optimiser ou diviser.</li>
            </ul>
        </div>
        
    </div>
</body>
</html>